"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-livestreaming-blocks-LiveComment-Comment-CommentContainer"],{30354(e,t,n){n.r(t),n.d(t,{default:()=>b});var a=n(91557),i=n(40515),l=n(3556),o=n(8051),r=n(97763),m=n(96540),s=n(92287);function c({text:e,extra_data:t,identity:n,handleAction:i,isReply:l,parent_user:r,actions:s}){let{jsxBackend:c}=(0,a.PCX)(),d=c.get("CommentComposer"),p=()=>{i("comment/editComment/CANCEL")},u=()=>{i("comment/editComment/SUCCESS")};return m.createElement(o.A,{mt:-1},m.createElement(d,{open:!0,text:e,editing:!0,onCancel:p,identity:n,onSuccess:u,extra_data:t,isReply:l,parentUser:r,focus:!0,actions:s}))}var d=n(90243);let p=(0,l.Ay)(o.A,{name:"Reply-LiveVideo",slot:"root"})(({theme:e})=>({marginBottom:e.spacing(1),color:e.palette.text.hint,a:{color:e.palette.text.hint,pointerEvents:"none"}}));function u({item:e}){let{i18n:t}=(0,a.PCX)();return m.createElement(p,null,m.createElement(i.mE,{variant:"body2",lines:2},m.createElement(o.A,{mr:1,component:"span",sx:{display:"inline-flex",transform:"scaleX(-1)"}},m.createElement(i.s4,{icon:"ico-reply"})),t.formatMessage({id:"replying_to_user"},{user_name:null==e?void 0:e.user_full_name}),e.text?m.createElement(m.Fragment,null,": ",m.createElement(d.Ay,{html:e.text})):null))}let v="Comment",g=(0,l.Ay)("div",{name:v,slot:"itemOuter",shouldForwardProp:e=>"isLoading"!==e})(({theme:e,isLoading:t})=>({display:"flex",...t&&{opacity:.6,pointerEvents:"none"},"&:hover .itemActionMenu":{visibility:"visible",marginLeft:e.spacing(.5)}})),h=(0,l.Ay)("div",{name:v,slot:"itemInner"})(({theme:e})=>({display:"flex",flexDirection:"column",minWidth:0,wordBreak:"break-word"})),x=(0,l.Ay)("div",{name:v,slot:"AvatarWrapper"})(({theme:e})=>({marginRight:e.spacing(1)})),y=(0,l.Ay)("div",{name:v,slot:"ItemName"})(({theme:e})=>({display:"flex",fontSize:e.mixins.pxToRem(13),marginBottom:e.spacing(.5)})),E=(0,l.Ay)(i.xE,{name:v,slot:"userName"})(({theme:e})=>({fontSize:e.mixins.pxToRem(13),maxWidth:"100%",fontWeight:"bold"})),f=(0,l.Ay)(i.h1,{name:v,slot:"FromNowStyled"})(({theme:e})=>({display:"flex",color:e.palette.text.secondary,whiteSpace:"nowrap",alignItems:"flex-end",marginLeft:e.spacing(1)})),_=(0,l.Ay)("div",{name:v,slot:"ReactionsWrapper"})(({theme:e})=>({display:"inline-flex",alignItems:"center",height:e.spacing(4)})),A=(0,l.Ay)(o.A,{name:v,slot:"BoxMessageWrapper"})(({theme:e,highlight:t})=>({position:"relative","&:before":{content:'""',position:"absolute",left:"-4px",top:"-4px",right:"-4px",bottom:"-4px",borderRadius:e.shape.borderRadius,transition:"background 300ms ease",background:"none",pointerEvents:"none",...t&&{background:"dark"===e.palette.mode?e.palette.grey[600]:e.palette.grey[100]}}})),b=(0,a.FB$)(function({item:e,user:t,itemLive:n,identity:l,extra_data:d,parent_user:p,setParentReply:v,identityResource:b,handleAction:C,state:k,actions:w}){var R,S,z;let{i18n:P,useTheme:L,ItemActionMenu:M,ReactionResult:W,ReactionActButton:I,ReplyActButton:B,RemovePreviewActButton:D,getSetting:F,usePageParams:T,HistoryEditedCommentButton:N,useLoggedIn:X}=(0,a.PCX)(),O=L(),V=t||(null==n?void 0:n.user),{comment_id:j}=T(),H=X(),[$,U]=m.useState(!1),[Z,q]=m.useState(!1);m.useEffect(()=>{j&&(U(parseInt(j)===(null==e?void 0:e.id)),setTimeout(()=>{U(!1)},2e3))},[j]);let G=()=>{q(e=>!e)};if(!e||!V)return null;let J=F("comment.enable_thread"),{text:K,editText:Q,creation_date:Y,most_reactions_information:ee,statistic:et,is_edited:en,is_hidden:ea,parent:ei}=e,el=e=>{let{replyUser:t,replyComment:n}=e||{};t&&v({user_full_name:null==t?void 0:t.full_name,parent_comment_identity:null==n?void 0:n._identity})},eo=(null==d?void 0:d.extra_type)==="link"&&(null==e?void 0:null===(R=e.extra)||void 0===R?void 0:R.can_remove_link_preview);return m.createElement("div",{"data-testid":"comment",id:`comment-${e.id}`,"data-author":V.full_name},m.createElement(o.A,{pt:2},ei?m.createElement(u,{item:null==n?void 0:n.parent}):null,e.isEditing?m.createElement(c,{text:Q,extra_data:d,handleAction:C,identity:l,actions:w}):m.createElement(g,{isLoading:e.isLoading},m.createElement(x,null,m.createElement(i.H8,{user:V,size:32})),m.createElement(h,null,m.createElement(A,{p:0,borderRadius:2,highlight:!!$},m.createElement(o.A,{sx:{position:"relative",zIndex:2}},m.createElement(y,null,m.createElement(E,{to:`/user/${V.id}`,user:V}),m.createElement(f,{value:Y,shorten:!0}),N&&en?m.createElement(N,{"data-testid":"historyCommentButton",minimize:!0,sx:{marginLeft:"8px",textTransform:"capitalize"},identity:l,handleAction:C}):null),m.createElement(s.A,{isHidden:ea&&!Z,text:K,extra_data:(null==e?void 0:e.hideExtraData)?null:d}))),H&&m.createElement(_,{className:"dotSeparators"},ea?m.createElement(r.A,{componentsProps:{tooltip:{sx:{maxWidth:"210px !important"}}},title:P.formatMessage({id:"preview_hidden_comment_tooltip"})},m.createElement("span",null,m.createElement(i.vw,{"data-testid":"previewHiddenButton",onClick:G,label:P.formatMessage({id:"preview"}),color:Z?O.palette.primary.main:"",minimize:!0}))):m.createElement(m.Fragment,null,I&&(null==e?void 0:null===(S=e.extra)||void 0===S?void 0:S.can_like)?m.createElement(I,{minimize:!0,reacted:e.user_reacted,identity:l,handleAction:C}):null,B&&J&&(null==e?void 0:null===(z=e.extra)||void 0===z?void 0:z.can_comment)?m.createElement(B,{minimize:!0,identity:l,openReplyComposer:el,handleAction:C}):null,eo?m.createElement(D,{actions:w,identity:l,minimize:!0}):null,W?m.createElement(W,{size:"sm",identity:l,handleAction:C,data:ee,total:null==et?void 0:et.total_like}):null),m.createElement(M,{identity:l,state:k,handleAction:C,size:"smaller",sx:{visibility:"hidden"},className:"itemActionMenu"}))))))},function(e){return{openReplyComposer:t=>e("comment/openReplyComposer",t),viewMoreReplies:(t,n)=>e("comment/viewMoreReplies",t,n),viewMoreComments:(t,n)=>e("comment/viewMoreComments",t,n),removePreviewLink:()=>e("comment/removePreviewLink"),deleteComment:()=>e("deleteComment")}},{extra_data:!0})},92287(e,t,n){n.d(t,{A:()=>x});var a=n(90243),i=n(40515),l=n(3556),o=n(87773),r=n(96540),m=n(91557),s=n(67725);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}let d="CommentExtraData",p=(0,l.Ay)("div",{name:d,slot:"extraDataPhoto"})(({theme:e})=>({maxWidth:e.spacing(26),cursor:"pointer"})),u=(0,l.Ay)("div",{name:d,slot:"extraDataSticker"})(({theme:e})=>({width:e.spacing(10),height:e.spacing(10)})),v=(0,l.Ay)("div",{name:d,slot:"bubbleExtraData"})(({theme:e})=>({marginTop:e.spacing(1)}));function g(e){let{extra_data:t}=e,{extra_type:n,image:a,params:l}=Object.assign({},t),{dispatch:o,jsxBackend:d}=(0,m.PCX)(),g=d.get("feedArticle.comment.embedItem");if(!t)return null;let h=(0,s.AE)(a,"500"),x=e=>{o({type:"photo/presentSimplePhoto",payload:{src:e,alt:"photo",identity:null==t?void 0:t._identity}})},y=null;switch(n){case"photo":case"storage_file":y=r.createElement(p,{onClick:()=>x(h)},r.createElement(i._V,{src:h,alt:"photo",shape:"radius"}));break;case"sticker":y=r.createElement(u,null,r.createElement(i._V,{src:h,alt:"sticker",aspectRatio:"fixed",imageFit:"contain"}));break;case"link":y=(null==l?void 0:l.is_image)?r.createElement(p,{onClick:()=>x(null==l?void 0:l.image)},r.createElement(i._V,{src:null==l?void 0:l.image,alt:"photo",shape:"radius"})):(null==l?void 0:l.is_hidden)?null:r.createElement(g,c({},l,{widthImage:"90px"}))}return y?r.createElement(v,null,y):null}let h=(0,l.Ay)("div",{name:"CommentContent",slot:"bubbleText"})(({theme:e})=>({display:"block",fontSize:e.mixins.pxToRem(15),transition:"background 300ms ease","& a":{color:e.palette.primary.main,fontWeight:e.typography.fontWeightRegular,"&:hover":{textDecoration:"underline"}}}));function x({text:e,extra_data:t,isHidden:n}){let{i18n:l}=(0,m.PCX)();return r.createElement("div",null,n?r.createElement(h,null,r.createElement(o.A,{component:"h1",variant:"body1",color:"text.hint"},l.formatMessage({id:"comment_hidden"}))):r.createElement(r.Fragment,null,r.createElement(h,null,r.createElement(i.Zn,{truncateProps:{variant:"body1",lines:3}},r.createElement(a.Ay,{html:e}))),r.createElement(g,{extra_data:t})))}}}]);