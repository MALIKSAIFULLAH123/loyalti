"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-music-blocks-PlaylistDetail-Mobile-Block"],{50917(e,t,n){n.r(t),n.d(t,{default:()=>U});var o,i,l=n(91557),a=n(58494),r=n(84680),s=n(40515),c=n(3556),d=n(8051),m=n(87773),p=n(52705),u=n(96540),g=n(33248);n(70024);var f=n(97763);let h=(0,c.Ay)(d.A,{name:"nameSong",shouldForwardProp:e=>"isSelect"!==e})(({theme:e,isSelect:t})=>({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:t?e.palette.primary.main:"light"===e.palette.mode?"#121212":"#fff"})),y=(0,c.Ay)(d.A,{name:"itemSongStyled"})(({theme:e})=>({display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:`1px solid ${e.palette.border.secondary}`,padding:e.spacing(1.5,0)})),v=(0,c.Ay)(d.A,{name:"listStyled"})(({theme:e})=>({"& div:last-child":{borderBottom:0}})),x=(0,c.Ay)(d.A,{name:"PendingSong"})(({theme:e})=>({marginLeft:"auto",color:e.palette.text.hint,display:"flex",alignItems:"center"})),A=(0,l.FB$)(function({song:e,identity:t,handleAction:n,selectedSong:o,setSelectedSong:i,state:a,item:r,isAlbum:c}){let{ItemActionMenu:d,i18n:m}=(0,l.PCX)();if(!r)return;let p=()=>{o.id!==e.id&&i(e)};return u.createElement(y,null,u.createElement(h,{isSelect:(null==o?void 0:o.id)===(null==e?void 0:e.id),onClick:p},e.name),(null==e?void 0:e.is_pending)&&u.createElement(x,null,u.createElement(f.A,{title:m.formatMessage({id:"pending"}),placement:"top"},u.createElement(s.s4,{icon:"ico-clock-o"}))),u.createElement(d,{menuName:c?"itemActionMenu":"itemActionMenuOnPlaylist",sx:{ml:2},identity:t,icon:"ico-dottedmore-vertical-o",state:a,handleAction:n}))},()=>{}),b=({songs:e,selectedSong:t,setSelectedSong:n,identity:o,handleAction:i,state:a,isPlaying:r,isAlbum:s,item:c})=>{let{dispatch:d}=(0,l.PCX)(),[m,p]=u.useState(!1);return(0,u.useEffect)(()=>{n(e[0])},[]),(0,u.useEffect)(()=>{var t;!m&&(null==c?void 0:null===(t=c.statistic)||void 0===t?void 0:t.total_song)>e.length&&d({type:"music/loadMoreListSong",meta:{onSuccess(){p(!0)}},payload:{identity:o}})},[m]),(0,l.ksV)(()=>{p(!1)}),u.createElement(v,null,e&&e.map((e,o)=>u.createElement(A,{isAlbum:s,song:e,selectedSong:t,setSelectedSong:n,key:o,index:o,identity:`music.entities.music_song.${e.id}`})))};var E=n(67725),w=n(90243),_=n(60655),S=n(56449),k=n.n(S),C=n(23181),R=n.n(C);function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}(o=i||(i={}))[o.NoRepeat=0]="NoRepeat",o[o.RepeatOne=1]="RepeatOne",o[o.Repeat=2]="Repeat";let P="PlaylistDetailMobile",B=(0,c.Ay)(d.A,{name:P})(({theme:e})=>({fontSize:e.mixins.pxToRem(15),lineHeight:1.33})),I=(0,c.Ay)(d.A,{name:P})(({theme:e})=>({display:"flex"})),W=(0,c.Ay)(d.A,{name:P})(({theme:e})=>({minHeight:"388px",overflow:"hidden",position:"relative"})),z=(0,c.Ay)(d.A,{name:P})(({theme:e})=>({height:"100%",backgroundImage:"linear-gradient(to top, #aeacac, #121212)",position:"absolute",left:0,right:0,top:0,bottom:0,zIndex:-2})),M=(0,c.Ay)(d.A,{name:P})(({theme:e})=>({width:"100%",marginLeft:"auto",marginRight:"auto",color:"#fff",paddingTop:e.spacing(3),"& .rhap_container":{backgroundColor:"unset",boxShadow:"none"}})),N=(0,c.Ay)(m.A,{name:P})(({theme:e})=>({display:"flex",flexDirection:"column",alignItems:"center"})),L=(0,c.Ay)(d.A,{name:P})(({theme:e})=>({fontWeight:e.typography.fontWeightBold,flex:1,minWidth:0,fontSize:18,lineHeight:1.2,maxHeight:72,overflow:"hidden",textOverflow:"ellipsis",wordBreak:"break-word",wordWrap:"break-word",whiteSpace:"normal",WebkitLineClamp:1,display:"-webkit-box",WebkitBoxOrient:"vertical",textAlign:"center",padding:e.spacing(0,2)})),T=(0,c.Ay)("span",{name:P})(({theme:e})=>({color:e.palette.grey[500]})),H=(0,c.Ay)("span",{name:P})(({theme:e})=>({color:"#fff",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginLeft:e.spacing(.5)})),$=(0,c.Ay)(s._V,{name:P})(({theme:e})=>({width:160,height:160,margin:e.spacing(3,"auto")})),j=(0,c.Ay)(d.A,{name:P})(({theme:e})=>({width:"100%",maxWidth:720,marginLeft:"auto",marginRight:"auto",backgroundColor:e.mixins.backgroundColor("paper"),border:e.mixins.border("secondary"),padding:e.spacing(2),position:"relative","&>button":{width:32,height:32,position:"absolute!important",top:e.spacing(1),right:e.spacing(1),"& .ico":{color:e.palette.text.secondary,fontSize:13}}})),D=(0,c.Ay)(d.A,{name:P})(({theme:e})=>({fontSize:15,lineHeight:1.33,marginTop:e.spacing(3),"& p + p":{marginBottom:e.spacing(2.5)}})),F=(0,c.Ay)(g.A,{name:P,slot:"AudioPlayerStyled",shouldForwardProp:e=>"disabledIcon"!==e})(({theme:e,disabledIcon:t})=>({margin:e.spacing(0,"auto",3),display:"block",backgroundColor:"transparent",boxShadow:"none",outline:"none","& .rhap_progress-section":{flexWrap:"wrap"},"& .rhap_progress-container":{width:"100%",flex:"none",margin:e.spacing(0,0,2),outline:"none",order:1,"& .rhap_progress-bar-show-download":{backgroundColor:e.mixins.backgroundColor("paper"),height:2,"& .rhap_progress-filled":{backgroundColor:e.palette.primary.main},"& .rhap_progress-indicator":{display:"none"}}},"& .rhap_current-time":{order:2,color:"#fff"},"& .rhap_total-time":{marginLeft:"auto",color:"#fff",order:3},"& .rhap_controls-section":{padding:e.spacing(0,2),alignItems:"baseline",flex:"none","& .rhap_main-controls":{flex:"none","& button":{fontSize:32,width:32,height:32,color:"#fff",outline:"none",overflow:"inherit","&.rhap_play-pause-button":{margin:e.spacing(1,5,0)}}},"& .rhap_additional-controls":{flex:"none","& button":{margin:e.spacing(0,0,0,"auto"),fontSize:18,width:18,height:18,color:"#fff",outline:"none"}}},...t&&{"& .ico":{color:`${e.palette.grey[500]}!important`}}})),V=(0,c.Ay)(s.s4,{name:P,slot:"BtnControlAudio",shouldForwardProp:e=>"btnRepeatOn"!==e})(({theme:e,btnRepeatOn:t})=>({fontSize:18,"&.ico-shuffle":{display:"flex",alignItems:"center",cursor:"pointer"},...0!==t&&{color:e.palette.primary.main}})),X=(0,l.$MH)((0,a.Ay)(function({item:e,user:t,blockProps:n,identity:o,handleAction:a,state:c,isAlbum:m}){var f,h,y;let{ItemActionMenu:v,ItemDetailInteraction:x,i18n:A,assetUrl:S,jsxBackend:C,usePageParams:P,dispatch:X}=(0,l.PCX)(),[U,G]=u.useState(),J=P(),Y=u.useRef(),q=null==Y?void 0:null===(f=Y.current)||void 0===f?void 0:null===(h=f.audio)||void 0===h?void 0:h.current,[K,Q]=u.useState([]),[Z,ee]=u.useState(!1),[et,en]=u.useState(-1),[eo,ei]=u.useState(i.NoRepeat),[el,ea]=u.useState(!1),er=(0,l.UfA)(null==e?void 0:e.songs);if(u.useEffect(()=>{ea(!0),(null==e?void 0:e.songs)?ea(!1):X({type:"music/getListSong",meta:{onSuccess({data:e}){ea(!e)}},payload:{identity:o}})},[J]),u.useEffect(()=>{if(k()(null==e?void 0:e.songs)){var t;Q(Array.from(Array(null==e?void 0:null===(t=e.songs)||void 0===t?void 0:t.length).keys()))}},[null==e?void 0:e.songs]),u.useEffect(()=>{Z&&2!==eo?en(er.length-1):en(-1)},[Z,eo]),!e)return null;let es=(0,E.AE)(null==e?void 0:e.image,"500",S(`music.${m?"album":"playlist"}_no_image`)),ec=(e,t)=>{let n=er.findIndex(e=>(null==e?void 0:e.id)===(null==U?void 0:U.id)),o=K.findIndex(e=>n===e);if(2!==eo&&n===er.length-1&&t||2!==eo&&0===et&&t){Z&&en(er.length-1);return}Z?(2!==eo&&en(et-1),o+e===K.length?G(er[K[0]]):G(er[K[o+e]])):n+e===K.length?G(er[0]):G(er[n+e])},ed=e=>{1!==eo&&ec(1,!0)},em=()=>{switch(q.loop=!1,eo){case 0:ei(i.RepeatOne);break;case 1:ei(i.Repeat);break;default:ei(i.NoRepeat)}},ep=()=>{(null==U?void 0:U.destination)&&(ee(!Z),Q(e=>e.sort((e,t)=>.5-Math.random())))},eu=C.get("core.block.no_content_with_icon");return u.createElement(r.eB,{blockProps:n,testid:`detailview ${e.resource_name}`},u.createElement(r.tD,null,u.createElement(d.A,null,u.createElement(W,null,u.createElement(z,null),u.createElement(M,null,u.createElement(d.A,null,u.createElement(N,null,(null==e?void 0:e.is_featured)||(null==e?void 0:e.is_sponsor)?u.createElement(d.A,{sx:{mb:2}},u.createElement(s.rL,{variant:"itemView",value:null==e?void 0:e.is_featured}),u.createElement(s.FN,{variant:"itemView",value:null==e?void 0:e.is_sponsor,item:e})):null,u.createElement(L,{component:"h2"},null==U?void 0:U.name)),u.createElement(d.A,{sx:{display:"flex",justifyContent:"center",mx:2},component:"div",mt:1,fontWeight:600},u.createElement(T,null,`${A.formatMessage({id:m?"album":"playlist"})}: `),u.createElement(H,null,e.name))),u.createElement($,{src:es,aspectRatio:"11"}),u.createElement(F,{ref:Y,disabledIcon:!(null==U?void 0:U.destination),src:null==U?void 0:U.destination,showJumpControls:!1,onEnded:ed,showSkipControls:!0,customVolumeControls:[],customControlsSection:[u.createElement(V,{onClick:ep,sx:Z&&{color:"primary.main"},key:"icon",icon:"ico-shuffle",btnRepeatOn:0}),g.n.MAIN_CONTROLS,u.createElement(V,{onClick:em,sx:0!==eo&&{color:"primary.main"},key:"icon",icon:1===eo?"ico-play-repeat-one-o":"ico-play-repeat",btnRepeatOn:eo})],onClickNext:e=>ec(1,!1),onClickPrevious:e=>ec(-1,!1),customIcons:{play:u.createElement(s.s4,{icon:"ico-play"}),pause:u.createElement(s.s4,{icon:"ico-pause"}),previous:u.createElement(V,{icon:"ico-play-prev",btnRepeatOn:0}),next:u.createElement(V,{icon:"ico-play-next",btnRepeatOn:0})}}))),u.createElement(j,null,u.createElement(v,{identity:o,icon:"ico-dottedmore-vertical-o",state:c,handleAction:a}),u.createElement(I,null,u.createElement(s.at,{item:e,sx:{mt:0}})),(null==e?void 0:e.description)&&u.createElement(B,null,u.createElement(s.np,null,u.createElement(w.Ay,{html:(null==e?void 0:e.text)||(null==e?void 0:e.description)}))),el?u.createElement(D,null,R()(1,4).map(e=>u.createElement(d.A,{key:e.toString(),sx:{display:"flex",mt:1,justifyContent:"space-between"}},u.createElement(p.A,{sx:{flex:1}}),u.createElement(p.A,{width:"30px",sx:{ml:2}})))):u.createElement(D,null,(null==e?void 0:null===(y=e.songs)||void 0===y?void 0:y.length)?u.createElement(b,{identity:o,item:e,isAlbum:m,songs:er,selectedSong:U,setSelectedSong:G}):u.createElement(eu,O({image:"ico-music-note-o",title:"no_songs_found"},e.extra.can_edit&&{labelButton:m?"add_new_song":"find_your_favorite"},{action:m?"music/redirectToEditAlbum":"music/redirectToAllSongs",isIconButton:!1,description:"find_your_favorite_music_and_add_to_your_list"}))),u.createElement(_.A,{attachments:null==e?void 0:e.attachments,size:"mini"}),u.createElement(x,{identity:o,handleAction:a})))))})),U=(0,l.WvA)({extendBlock:X,defaults:{placeholder:"Search",blockProps:{variant:"plained",titleComponent:"h2",titleVariant:"subtitle1",titleColor:"textPrimary",noFooter:!0,noHeader:!0,blockStyle:{},contentStyle:{borderRadius:"base"},headerStyle:{},footerStyle:{}}}})},60655(e,t,n){n.d(t,{A:()=>p});var o=n(91557),i=n(40515),l=n(3556),a=n(8051),r=n(96540);let s=(0,l.Ay)("div",{name:"attachmentTitle"})(({theme:e})=>({fontSize:e.mixins.pxToRem(18),color:e.palette.text.secondary,fontWeight:e.typography.fontWeightBold})),c=(0,l.Ay)("div",{name:"attachment"})(({theme:e})=>({width:"100%",display:"flex",flexWrap:"wrap",justifyContent:"space-between",[e.breakpoints.down("sm")]:{flexDirection:"column"}})),d=(0,l.Ay)("div",{name:"attachmentItemWrapper"})(({theme:e})=>({marginTop:e.spacing(2),flexGrow:0,flexShrink:0,flexBasis:"calc(50% - 8px)",minWidth:300,maxWidth:"100%"})),m=({attachments:e,size:t,sx:n})=>{let{i18n:l}=(0,o.PCX)(),m=(0,o.UfA)(e);return m.length?r.createElement(a.A,{mt:2,sx:n},r.createElement(s,null,l.formatMessage({id:"attachments"})),r.createElement(c,null,m.map((e,n)=>r.createElement(d,{key:e.id.toString()},r.createElement(i.Hg,{fileName:e.file_name,downloadUrl:e.download_url,isImage:e.is_image,fileSizeText:e.file_size_text,size:t,image:null==e?void 0:e.image,identity:null==e?void 0:e._identity,index:n}))))):null},p=m},58494(e,t,n){n.d(t,{Ay:()=>s});var o=n(91557),i=n(58156),l=n.n(i);let a=(0,o.vYD)({},()=>({})),r=(0,o.NgA)(function(e,t){let n=l()(e,t.identity);if(!n)return{};let o=n.songs?n.songs.map(t=>l()(e,t)).filter(Boolean):[];return{item:n,songs:o,user:l()(e,n.user)}});function s(e){return r(a(e))}}}]);