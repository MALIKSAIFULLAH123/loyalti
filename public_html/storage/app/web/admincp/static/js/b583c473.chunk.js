"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["packages_metafox_chatplus_src_components_ChatComposer_FilePreview_tsx-packages_metafox_chatpl-616093"],{13586(e,t,n){n.r(t),n.d(t,{default:()=>E});var i=n(91557),l=n(67725),a=n(3556),r=n(12789),o=n(72761),s=n(8051),d=n(30719),c=n(96540),u=n(97837),p=n(65121),m=n(86663),g=n(84058),h=n.n(g);let v=(0,a.Ay)(r.A,{name:"AvatarWrapper"})(({theme:e})=>({borderWidth:"thin",borderStyle:"solid",borderColor:e.palette.border.secondary})),f=(0,a.Ay)(i.N_E,{name:"Link"})(({theme:e})=>({"&:hover":{textDecoration:"none"}})),y=(0,a.Ay)(o.A,{shouldForwardProp:e=>"status"!==e})(({theme:e,status:t})=>({"& .MuiBadge-badge":{...t===u.O2.Offline&&{display:"none"},...t===u.O2.Online&&{color:e.palette.success.main,backgroundColor:e.palette.success.main},...t===u.O2.Away&&{color:e.palette.warning.main,backgroundColor:e.palette.warning.main},...t===u.O2.Busy&&{color:e.palette.error.main,backgroundColor:e.palette.error.main},boxShadow:"dark"===e.palette.mode?"none":`0 0 0 2px ${e.palette.background.paper}`,"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}}})),b=(0,a.Ay)("div",{shouldForwardProp:e=>"sizeProps"!==e})(({theme:e,sizeProps:t})=>({position:"relative",width:"32px",height:"32px",...t&&{width:t,height:t}})),x=(0,a.Ay)(r.A,{shouldForwardProp:e=>"sizeProps"!==e})(({theme:e,sizeProps:t})=>({position:"absolute",bottom:0,left:0,width:"26px",height:"26px",backgroundColor:"dark"===e.palette.mode?e.palette.grey["600"]:e.palette.grey["300"],borderWidth:1,borderStyle:"solid",borderColor:"light"===e.palette.mode?e.palette.grey["50"]:e.palette.grey["800"],zIndex:2,...t&&{width:.7*t,height:.7*t}})),w=(0,a.Ay)(s.A,{shouldForwardProp:e=>"sizeProps"!==e})(({theme:e,sizeProps:t})=>({position:"relative",width:"100%",height:"100%"})),A=(0,a.Ay)(r.A,{shouldForwardProp:e=>"sizeProps"!==e})(({theme:e,sizeProps:t})=>({position:"absolute",top:"50%",right:0,transform:"translate(0%, -50%)",width:"26px",height:"26px",...t&&{width:`${.7*t}px !important`,height:`${.7*t}px !important`}})),E=(0,c.memo)(function({username:e="Name",name:t="Name",src:n,size:a,to:o,onClick:s,status:g=0,room:E,uploadLocal:k=!1,roomType:C=null,avatarETag:M,component:_="span",target:R="_self",noLink:P}){var I,S;let{getSetting:O}=(0,i.PCX)(),T=(0,d.A)(),F=P,z=o,B=C||(null==E?void 0:E.t),D=(0,l.cb)(t),j={width:a,height:a,color:T.palette.grey["50"],fontSize:a/3},W=O("chatplus"),H=null==W?void 0:null===(I=W.server)||void 0===I?void 0:I.replace(/\/$/,""),$=n;if($||($=M?`${H}/avatar/${e}?${m.stringify({etag:M})}`:""),D&&(j.backgroundColor=l.m6.hex(D)),(null==E?void 0:E.isBotRoom)&&(z=null,F=!0),z)return c.createElement(f,{target:R,to:z||`/${e}`},c.createElement(v,{"data-testid":h()("chatplus avatar"),src:$,alt:t,style:j,component:_,children:D}));if([u.CJ.Private,u.CJ.Public].includes(B)){if(k)return c.createElement(v,{"data-testid":h()("chatplus avatar"),src:$,alt:t,style:j,component:_,children:D});if(null==E?void 0:E.avatarETag)return $=`${H}/avatar/room/${null==E?void 0:E.id}?${m.stringify({etag:null==E?void 0:E.avatarETag})}`,c.createElement(v,{"data-testid":h()("chatplus avatar"),src:$,alt:t,style:j,component:_,children:D});{let L=`${H}/avatar/${null==E?void 0:null===(S=E.u)||void 0===S?void 0:S.username}`;return c.createElement(b,{"data-testid":h()("chatplus avatar"),sizeProps:a},c.createElement(x,{sizeProps:a,src:L,alt:t,component:_,children:D}),c.createElement(w,null,c.createElement(A,{sizeProps:a,src:$,alt:t,style:j,component:_,children:D})))}}if(B===u.CJ.Direct&&g){let U=(0,p.cR)(g);return c.createElement(y,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot",status:U},c.createElement(r.A,{"data-testid":h()("chatplus avatar"),src:$,alt:t,style:j,component:_,children:D}))}return c.createElement(v,{"data-testid":h()("chatplus avatar"),src:$,alt:t,style:j,component:_,children:D,onClick:s,to:F?null:e})})},86898(e,t,n){n.d(t,{A:()=>y});var i=n(84680),l=n(40515),a=n(3556),r=n(96540),o=n(8051);let s="PreviewUploadFile",d=(0,a.Ay)("img",{name:s,slot:"previewImage"})(({theme:e})=>({borderRadius:e.spacing(1),maxWidth:"52px",width:"52px",height:"52px",marginRight:e.spacing(2),objectFit:"cover"})),c=(0,a.Ay)("div",{name:s,slot:"PreviewFile",shouldForwardProp:e=>"isAllPage"!==e})(({theme:e,isAllPage:t})=>({borderRadius:e.spacing(1),maxWidth:"150px",width:"150px",height:"52px",marginRight:e.spacing(2),fontSize:e.spacing(1.5),display:"flex",alignItems:"center",background:"light"===e.palette.mode?e.palette.background.default:e.palette.grey["500"],...t&&{maxWidth:"180px",width:"180px",overflowX:"hidden"}})),u=(0,a.Ay)("div",{name:s,slot:"IconFile"})(({theme:e})=>({borderRadius:"100%",maxWidth:"28px",width:"28px",height:"28px",margin:e.spacing(0,1),padding:e.spacing(0,1),color:e.palette.default.contrastText,background:"light"===e.palette.mode?e.palette.grey["500"]:e.palette.grey["700"],display:"inline-flex",justifyContent:"center",alignItems:"center"})),p=(0,a.Ay)("div",{name:s,slot:"closeButton"})(({theme:e})=>({position:"absolute",top:"-8px",right:"8px",cursor:"pointer",width:e.spacing(2.5),height:e.spacing(2.5),backgroundColor:e.palette.grey["500"],borderRadius:"50%",fontSize:e.mixins.pxToRem(8),justifyContent:"center",alignItems:"center",display:"inline-flex",opacity:.8,color:(e.palette.mode,e.palette.text.primary),"&:hover":{backgroundColor:e.palette.background.default,color:e.palette.text.primary,border:e.mixins.border("secondary")}})),m=(0,a.Ay)(l.mE)(({theme:e})=>({paddingRight:e.spacing(1),wordBreak:"break-word",p:{fontSize:e.mixins.pxToRem(12)}})),g=function({onRemove:e,file:t,isAllPage:n}){let i=t.type,a=["image/gif","image/jpeg","image/png"].includes(i),s=a?URL.createObjectURL(t):"";return r.createElement(o.A,{display:"inline-flex",position:"relative"},a?r.createElement(d,{src:s,alt:"Preview"}):r.createElement(c,{isAllPage:n},r.createElement(u,null,r.createElement(l.s4,{icon:"ico-paperclip-alt"})),r.createElement(m,{lines:2},t.name)),r.createElement(o.A,{position:"absolute",top:1,right:1},r.createElement(p,{"data-testid":"buttonRemove",onClick:e,"aria-label":"Close"},r.createElement(l.s4,{icon:"ico-close"}))))},h=(0,a.Ay)("div",{shouldForwardProp:e=>"isAllPage"!==e})(({theme:e,isAllPage:t})=>({background:e.palette.background.paper,padding:e.spacing(2,1,0,1),display:"flex",overflow:"hidden",borderTop:e.mixins.border("secondary"),userSelect:"none",height:"90px",minHeight:"90px"})),v=(0,a.Ay)("div")(({theme:e})=>({display:"flex",paddingTop:e.spacing(1),marginBottom:e.spacing(.5),paddingBottom:e.spacing(.5)})),f=(0,a.Ay)("div",{slot:"ButtonAdd"})(({theme:e})=>({marginRight:e.spacing(1),cursor:"pointer",span:{background:"light"===e.palette.mode?e.palette.background.default:e.palette.grey["500"],"&:hover":{background:e.palette.action.hover},borderRadius:e.spacing(1),maxWidth:"52px",width:"52px",height:"52px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:e.spacing(2.5)}})),y=r.forwardRef(function({filesUploadRef:e,isAllPage:t},n){let a=r.useRef(),[o,s]=r.useState([]),[d,c]=r.useState("image"),u=r.useRef(),p=r.useRef(),m=t=>{let n=[...o];if(t>-1&&(n.splice(t,1),s([...n]),e)){var i;null===(i=e.current)||void 0===i||i.removeFile(t)}};if(r.useImperativeHandle(n,()=>({attachFiles(e){(null==e?void 0:e.length)&&s(e)},typeUpload(e){e&&c(e)},clear(){s([])},checkIsLoading(){},listFiles:()=>o})),!o||!(null==o?void 0:o.length))return null;let y=()=>{u.current.click()},b=()=>{p.current.click()},x=()=>{if("image"===d){y();return}b()},w=()=>{if(!u.current.files.length)return;let t=[...o,...u.current.files];if(s(t),e){var n;null===(n=e.current)||void 0===n||n.attachFiles(t)}},A=()=>{if(!p.current.files.length)return;let t=[...o,...p.current.files];if(s(t),e){var n;null===(n=e.current)||void 0===n||n.attachFiles(t)}};return r.createElement(h,{isAllPage:t},r.createElement(i.P,{autoHide:!1,autoHeight:!1,ref:a,style:{height:"auto"}},r.createElement(v,null,r.createElement(f,{onClick:x},r.createElement("span",null,r.createElement(l.s4,{icon:"ico-text-file-plus"}))),Object.values(o).map((e,n)=>r.createElement(g,{key:n,file:e,onRemove:()=>m(n),isAllPage:t})))),r.createElement("input",{"data-testid":"inputAttachPhoto",onChange:w,multiple:!0,ref:u,style:{display:"none"},type:"file",accept:"image/*"}),r.createElement("input",{style:{display:"none"},type:"file",multiple:!0,ref:p,onChange:A}))})},54075(e,t,n){n.d(t,{A:()=>h});var i=n(88485),l=n(91557),a=n(3556),r=n(8051),o=n(62193),s=n.n(o),d=n(96540),c=n(76799),u=n(61341);let p="ChatRoomPanel",m=(0,a.Ay)("div",{name:p})(({theme:e})=>({textAlign:"center",padding:e.spacing(2),color:"dark"===e.palette.mode?e.palette.text.primary:e.palette.grey["700"],fontSize:e.spacing(1.75)})),g=(0,a.Ay)("div",{name:p,slot:"noItemFound"})(({theme:e})=>({...e.typography.body1,padding:e.spacing(1,2),color:e.palette.grey["600"],marginTop:e.spacing(2)})),h=d.forwardRef(function(e,t){let{searchMessages:n,setLoadingMsgs:a,loadingMsgs:o,oldScrollOffset:p,chatRoom:h,handleAction:v,rid:f,isPageFull:y=!0}=e,{i18n:b,dispatch:x}=(0,l.PCX)(),w=d.useRef(),A=(0,i.iW)(f),E=(0,i.GV)(f),{msgSearch:k}=h||{},C=(0,i.hB)(),M=(0,i.sz)(),_=d.useRef(),R=!!(null==E?void 0:E.archived),P=(0,d.useCallback)(({type:e="lt"})=>{a(!0),x({type:"chatplus/room/search/loadHistory",payload:{roomId:f,mid:"lt"===e?null==n?void 0:n.oldest:null==n?void 0:n.newest,operate:e,limit:u.xm},meta:{onSuccess(){a(!1)}}})},[f,null==n?void 0:n.oldest,null==n?void 0:n.newest]),I=e=>{if(s()(n)||(null==k?void 0:k.loading))return;let{endLoadmoreMessage:t,endTopLoadmoreMessage:i=!1,oldest:l,newest:a}=n||{};if(e.target.scrollTop<100&&!o){if(!l||i)return;p.current=e.target.scrollHeight-e.target.clientHeight,P({type:"lt"});return}if(e.target.scrollHeight-e.target.scrollTop-50<=e.target.clientHeight&&!o){if(!a||t)return;p.current=e.target.scrollHeight-e.target.clientHeight,P({type:"gt"})}};if(d.useImperativeHandle(t,()=>({handleScroll(e){I(e)}})),null==h?void 0:h.searching)return s()(n)?d.createElement(g,null,b.formatMessage({id:"no_results_found"})):d.createElement(r.A,{sx:{mt:y?2:0}},o?d.createElement(m,null,b.formatMessage({id:"loading_dots"})):null,d.createElement(c.Ay,{rid:f,typing:null,groupIds:null==n?void 0:n.groupIds,groups:null==n?void 0:n.groups,newest:0,archived:R,room:A,subscription:E,isMobile:!1,settings:M,user:C,containerRef:w,disableReact:!0,showToolbar:!1,handleAction:v,isAllPage:!0,ref:_,chatRoom:h,isSearch:!0}),o?d.createElement(m,null,b.formatMessage({id:"loading_dots"})):null);if(s()(n))return null;let S=(null==k?void 0:k.mode)!=="quote",O=(null==k?void 0:k.mode)==="quote";return d.createElement(d.Fragment,null,o?d.createElement(m,null,b.formatMessage({id:"loading_dots"})):null,d.createElement(c.Ay,{rid:f,typing:null,groupIds:null==n?void 0:n.groupIds,groups:null==n?void 0:n.groups,newest:0,archived:R,room:A,subscription:E,isMobile:!1,settings:M,user:C,containerRef:w,disableReact:S,showToolbar:O,handleAction:v,isAllPage:!0,ref:_,chatRoom:h,isSearch:!0}),o?d.createElement(m,null,b.formatMessage({id:"loading_dots"})):null)})},93624(e,t,n){n.d(t,{qJ:()=>p,Zk:()=>I,WH:()=>x,aO:()=>k,xw:()=>eo,qC:()=>ep,$6:()=>J});var i=n(40515),l=n(3556),a=n(8051),r=n(60780),o=n(96540);let s=(0,l.Ay)("div",{name:"ChatDockFilter"})(({theme:e})=>({position:"relative"})),d=(0,l.Ay)(a.A,{name:"ChatDockFilter"})(({theme:e})=>({padding:e.spacing(1,2,1,2),display:"flex",flexDirection:"row",alignItems:"center"})),c=(0,l.Ay)(r.A,{name:"ChatDockFilter"})(({theme:e})=>({marginLeft:e.spacing(.5)})),u=(0,l.Ay)(i.Gd,{name:"SearchWrapper"})(({theme:e})=>({"& input::placeholder, .ico":{color:e.palette.text.hint}}));function p({placeholder:e,size:t,hide:n=!1,label:i,disabled:l,valueSearch:a,onChangeSearch:r,onKeyUp:p,onSubmit:m,variant:g="direct",isShowButtonSubmit:h=!0,sx:v}){return n?null:o.createElement(s,null,o.createElement(d,{sx:v},o.createElement(u,{placeholder:e,onKeyUp:p,value:a,onChange:r}),h&&m?o.createElement(c,{disabled:l,size:"medium",color:"primary",variant:"text",onClick:m},i):null))}n(88485);var m=n(97837),g=n(91557);n(84680),n(97648),n(13586);let h="AddNewMembers",v=((0,l.Ay)("div")(({theme:e})=>({padding:e.spacing(0,1,0,2)})),(0,l.Ay)("div",{shouldForwardProp:e=>"users"!==e})(({theme:e,users:t})=>({...t&&{padding:e.spacing(0,1,1,2)},listStyle:"none",display:"flex",alignItems:"center",flexWrap:"wrap"})),(0,l.Ay)("li")(({theme:e})=>({margin:e.spacing(.5)})),(0,l.Ay)("div")(({theme:e})=>({padding:e.spacing(1.75,0),display:"flex",alignItems:"center",cursor:"pointer"})),(0,l.Ay)("span")(({theme:e})=>({...e.typography.h5,marginLeft:e.spacing(1)})),(0,l.Ay)("div",{name:h,slot:"RootSearch"})(({theme:e})=>({})),(0,l.Ay)("div",{name:h,slot:"SearchControl"})(({theme:e})=>({padding:e.spacing(0,1,0,2),display:"flex",flexDirection:"row",alignItems:"center"})),(0,l.Ay)(r.A,{name:h,slot:"ButtonCustom"})(({theme:e})=>({marginLeft:e.spacing(.5)})),(0,l.Ay)("input",{name:h,slot:"InputWrapper"})(({theme:e})=>({zIndex:"auto",backgroundColor:e.mixins.backgroundColor("paper"),color:"dark"===e.palette.mode?e.palette.grey["50"]:e.palette.grey["700"],height:"35px",borderRadius:"2px",fontSize:"14px",padding:"8px",paddingLeft:"12px",paddingRight:"72px",display:"block",width:"100%",margin:"0",border:e.mixins.border("secondary"),"&:focus":{borderColor:"#a2a2a2",boxShadow:"0 1px 4px 0 rgba(0,0,0,0.1)",outline:"none"},"&::placeholder":{fontSize:"14px"}})),(0,l.Ay)("div",{name:"ChatDockContent",slot:"root",shouldForwardProp:e=>"searching"!==e&&"collapsed"!==e})(({theme:e,searching:t,collapsed:n})=>({flex:1,maxHeight:"100%",position:"relative",paddingBottom:e.spacing(.75),...t&&{borderTop:"none"},...n&&{display:"none"},"&::-webkit-scrollbar":{height:"5px",width:"5px",background:"gray",borderRadius:e.spacing(.5),transition:"opacity 200ms"},"&::-webkit-scrollbar-track":{borderRadius:e.spacing(.5),background:"light"===e.palette.mode?"white":e.palette.grey["300"]},"&::-webkit-scrollbar-thumb":{background:e.palette.grey["600"],borderRadius:e.spacing(.5)},"&::-webkit-scrollbar-thumb:hover":{background:e.palette.grey["700"]},"&::-webkit-scrollbar-thumb:horizontal":{background:"#000",borderRadius:"10px"}})),"ChatDockFooter"),f=(0,l.Ay)("div",{name:v,slot:"root",shouldForwardProp:e=>"isAllPageMessages"!==e})(({theme:e,isAllPageMessages:t})=>({position:"relative",display:"flex",minHeight:e.spacing(5),zIndex:e.zIndex.tooltip+11,backgroundColor:e.palette.background.paper,borderTop:e.mixins.border("divider"),...t&&{minHeight:e.spacing(6)}})),y=(0,l.Ay)("div",{name:v,slot:"uiChatRoomFooter",shouldForwardProp:e=>"disable"!==e&&"isAllPageMessages"!==e})(({theme:e,disable:t,isAllPageMessages:n})=>({position:"relative",borderTop:e.mixins.border("secondary"),display:"flex",alignItems:"flex-end",minHeight:e.spacing(5),zIndex:e.zIndex.tooltip+11,flexFlow:"wrap",justifyContent:"center",...t&&{userSelect:"none",backgroundColor:"dark"===e.palette.mode?e.palette.grey["700"]:e.palette.background.paper},...n&&{minHeight:e.spacing(6)}})),b=(0,l.Ay)("div",{name:v,slot:"uiChatComposerContainer"})(({theme:e})=>({textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",height:"100%",padding:"4px 8px",color:e.palette.grey["500"]}));function x({children:e,archived:t,isReadOnly:n,isMuted:i,searching:l,isBlocked:a,reactMode:r,allowMsgNoOne:s}){let{i18n:d,usePageParams:c}=(0,g.PCX)(),u=c(),p=(null==u?void 0:u.isAllPageMessages)||!1;return l?null:t?o.createElement(y,{disable:!0,isAllPageMessages:p},o.createElement(b,null,d.formatMessage({id:"this_group_is_archived"}))):n?o.createElement(y,{disable:!0,isAllPageMessages:p},o.createElement(b,null,d.formatMessage({id:"this_group_is_readonly"}))):i?o.createElement(y,{disable:!0,isAllPageMessages:p},o.createElement(b,null,d.formatMessage({id:"you_have_been_muted_in_this_group"}))):a||s&&"edit"!==r?o.createElement(y,{disable:!0,isAllPageMessages:p},o.createElement(b,null,d.formatMessage({id:"you_can_not_send_message_in_this_conversation"}))):o.createElement(f,{isAllPageMessages:p},e)}var w=n(84058),A=n.n(w);let E=(0,l.Ay)("div",{shouldForwardProp:e=>"searching"!==e&&"addNewMembers"!==e})(({theme:e,searching:t,addNewMembers:n})=>({display:"flex",alignItems:"center",minHeight:e.spacing(7),padding:e.spacing(1.5,1.25,1.5,2),borderBottom:e.mixins.border("secondary"),...(t||n)&&{borderBottom:"none"}}));function k({children:e,onClick:t,searching:n,addNewMembers:i}){let l=o.useCallback(e=>{e.preventDefault(),t&&t()},[t]);return o.createElement(E,{"data-testid":A()("Chat Dock Header"),onClick:l,searching:n,addNewMembers:i},e)}function C(){return(C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let M="ChatDockPanel",_=(0,l.Ay)("div",{name:M,slot:"Root"})(({theme:e})=>({display:"flex",alignItems:"flex-end",marginLeft:e.spacing(2),width:"328px",zIndex:999})),R=(0,l.Ay)("div",{name:M,slot:"PanelStyled"})(({theme:e})=>({display:"flex",flexDirection:"column",zIndex:10,backgroundColor:e.mixins.backgroundColor("paper"),borderTopLeftRadius:e.shape.borderRadius/2,borderTopRightRadius:e.shape.borderRadius/2,boxShadow:"0 0 4px 0 rgba(0,0,0,0.2)",wordBreak:"break-word",wordWrap:"break-word",borderStartStartRadius:e.shape.borderRadius,borderStartEndRadius:e.shape.borderRadius,height:"455px",maxHeight:"calc(100vh - 60px)",position:"relative"})),P=(0,l.Ay)("div",{name:M,slot:"StageStyled"})(({theme:e})=>({width:"100%"})),I=o.forwardRef(function({children:e,...t},n){return o.createElement(_,C({ref:n},t),o.createElement(P,null,o.createElement(R,null,e)))});var S=n(61341),O=n(97763),T=n(95223),F=n(20053),z=n(38221),B=n.n(z),D=n(62193),j=n.n(D),W=n(56525),H=n(85838);let $=(0,W.A)(e=>(0,H.A)({optionLabel:{width:"32px",height:"32px",display:"inline-flex",alignItems:"center",justifyContent:"center",margin:"0",color:"#a2a2a2"},optionChecked:{color:e.palette.primary.main},optionInput:{display:"none"},optionIcon:{display:"inline-flex",alignItems:"center",marginTop:"1px",height:"14px",marginRight:"4px"}}),{name:"ChatDockSearchFilter"}),L=(0,l.Ay)("div")(({theme:e})=>({})),U=(0,l.Ay)("div")(({theme:e})=>({display:"inline-flex"})),N=(0,l.Ay)("label",{shouldForwardProp:e=>"id"!==e})(({theme:e,id:t})=>({cursor:"pointer",..."close"===t&&{"& span.ico":{"&:hover":{background:e.palette.action.selected,width:e.spacing(2.8),height:e.spacing(2.8),display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"40px"}}}})),X=(0,l.Ay)(a.A,{name:"SearchBox",slot:"Root"})(({theme:e})=>({margin:e.spacing(0,2,1,2),height:e.spacing(5),borderRadius:e.spacing(2.5),display:"flex",alignItems:"center",backgroundColor:e.palette.action.hover,"& input::placeholder":{color:e.palette.text.hint}})),V=(0,l.Ay)(i.s4,{shouldForwardProp:e=>"isMobile"!==e&&"disabled"!==e})(({theme:e,isMobile:t,disabled:n})=>({color:e.palette.text.primary,transition:"all .2s ease",cursor:"pointer",padding:e.spacing(0,1),width:e.spacing(4),height:e.spacing(4),display:"flex",justifyContent:"center",alignItems:"center",fontWeight:e.typography.fontWeightSemiBold,...t&&{padding:0},...n&&{cursor:"not-allowed",color:`${e.palette.text.disabled} !important`,fontWeight:e.typography.fontWeightMedium}})),Q=(0,l.Ay)(a.A)(({theme:e})=>({display:"flex",alignItems:"center"}));function Y({id:e,checked:t,icon:n,classes:l,value:a,roomId:r,onClick:s,tooltip:d}){let{dispatch:c,i18n:u}=(0,g.PCX)(),p=()=>{c({type:a,payload:{identity:r}}),"function"==typeof s&&s(t?void 0:e)};return o.createElement(O.A,{title:d?u.formatMessage({id:d}):"",placement:"top"},o.createElement(N,{id:e,className:(0,F.default)(l.optionLabel,t&&l.optionChecked)},o.createElement("input",{className:l.optionInput,type:"checkbox"}),o.createElement(i.s4,{icon:n,className:l.optionIcon,onClick:p})))}let q=({hide:e,roomId:t,searching:n,chatRoom:l,isBuddy:a=!1})=>{let r=$(),{dispatch:s,i18n:d}=(0,g.PCX)(),c=(0,o.useRef)(null),u=(0,o.useRef)(null),{msgSearch:p}=l||{},m=p?(null==p?void 0:p.slot)+1:0,[h,v]=o.useState((null==p?void 0:p.total)||0),f=(0,o.useMemo)(()=>!!j()(p)||(null==p?void 0:p.slot)===0,[p]),y=(0,o.useMemo)(()=>!!j()(p)||h===m,[p,h,m]),[b,x]=o.useState(null),w=d.formatMessage({id:"search_messages_dots"});(null==l?void 0:l.pinned)&&(w=d.formatMessage({id:"search_pinned_messages"})),(null==l?void 0:l.starred)&&(w=d.formatMessage({id:"search_starred_messages"}));let A=(0,o.useMemo)(()=>[{icon:"ico-close",value:"chatplus/room/toggleSearching",tooltip:"close",id:"close"}],[]);(0,o.useEffect)(()=>{c.current="",x(""),u.current=null,_()},[n]);let E=e=>{c.current=e.target.value,x(e.target.value),_()},k=e=>{v((null==e?void 0:e.total)||0)},C=()=>{},M=o.useCallback(()=>{s({type:u.current?"chatplus/room/pinnedMessages":"chatplus/room/searchMessages",payload:{roomId:t,text:c.current,filter:u.current,isBuddy:a},meta:{onSuccess:k,onFailure:C}})},[s,t]),_=(0,o.useMemo)(()=>B()(M,S.IG),[M]);(0,o.useEffect)(()=>{!t||(c.current="",x(""),(null==l?void 0:l.pinned)&&(u.current="pin",_()),(null==l?void 0:l.starred)&&(u.current="star",_()),(null==l?void 0:l.pinned)||(null==l?void 0:l.starred)||(u.current=null,_()))},[null==l?void 0:l.pinned,null==l?void 0:l.starred,t]);let R=o.useCallback(()=>{f||s({type:"chatplus/room/searchChangePosition",payload:{rid:t,mid:null==p?void 0:p.id,type:S.rs}})},[null==p?void 0:p.id,t,f]),P=o.useCallback(()=>{y||s({type:"chatplus/room/searchChangePosition",payload:{rid:t,mid:null==p?void 0:p.id,type:S.mR}})},[null==p?void 0:p.id,t,y]);return e||!t?null:o.createElement(L,null,o.createElement(X,null,o.createElement(T.Ay,{sx:{width:"100%"},variant:"search",onChange:E,placeholder:w,startAdornment:o.createElement(i.s4,{icon:"ico-search-o"}),"aria-controls":"search_complete",value:b,endAdornment:o.createElement(Q,null,(null==l?void 0:l.pinned)||(null==l?void 0:l.starred)?null:o.createElement(o.Fragment,null,o.createElement(V,{icon:"ico-angle-up",onClick:R,disabled:f}),o.createElement(V,{icon:"ico-angle-down",onClick:P,disabled:y})),A&&A.length?o.createElement(U,null,A.map(e=>o.createElement(Y,{id:e.id,key:e.id.toString(),checked:null==e?void 0:e.checked,classes:r,icon:e.icon,value:e.value,roomId:t,tooltip:null==e?void 0:e.tooltip}))):null)})))},J=(0,o.memo)(q);var G=n(65121),K=n(72761),Z=n(98023),ee=n.n(Z);let et=(0,l.Ay)("div")(({theme:e})=>({flex:1,fontWeight:"bold",display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"})),en=(0,l.Ay)("span",{shouldForwardProp:e=>"status"!==e})(({theme:e,status:t})=>({fontSize:e.mixins.pxToRem(13),color:e.palette.text.primary,lineHeight:e.spacing(2.375),...t===m.O2.Offline&&{color:e.palette.text.secondary}})),ei=(0,l.Ay)("span",{shouldForwardProp:e=>"variant"!==e&&"type"!==e&&"isChatBot"!==e})(({theme:e,variant:t,type:n,isChatBot:i})=>({...e.typography.subtitle1,fontSize:"15px",lineHeight:e.spacing(2.375),...n===m.CJ.Direct&&{":hover":{cursor:"pointer",textDecoration:"underline"}},..."new_message"===t&&{fontSize:e.typography.pxToRem(18),":hover":{cursor:"auto",textDecoration:"none"}},...i&&{":hover":{cursor:"auto",textDecoration:"none"}}})),el=(0,l.Ay)(K.A,{shouldForwardProp:e=>"status"!==e})(({theme:e,status:t})=>({margin:e.spacing(0,1,0,.5),"& .MuiBadge-badge":{...t===m.O2.Online&&{color:e.palette.success.main,backgroundColor:e.palette.success.main},...t===m.O2.Away&&{color:e.palette.warning.main,backgroundColor:e.palette.warning.main},...t===m.O2.Busy&&{color:e.palette.error.main,backgroundColor:e.palette.error.main},"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},...t===m.O2.Invisible&&{display:"none"}})),ea=(0,l.Ay)("div",{name:"DockPanelTitle"})(({theme:e})=>({display:"flex",alignItems:"center",marginTop:e.spacing(.25)})),er=({statusProps:e,user:t,isSelfChat:n})=>{var i,l;let{i18n:a}=(0,g.PCX)();if(e===m.O2.Invisible||!n&&!(null==t?void 0:null===(i=t.lastStatusUpdated)||void 0===i?void 0:i.$date))return null;let r="";switch(e){case m.O2.Offline:{let s=(0,G.Rn)(null==t?void 0:null===(l=t.lastStatusUpdated)||void 0===l?void 0:l.$date);r=s?a.formatMessage({id:"active_time_ago"},{time:s}):"";break}case m.O2.Online:r=a.formatMessage({id:"online"});break;case m.O2.Away:r=a.formatMessage({id:"away"});break;case m.O2.Busy:r=a.formatMessage({id:"busy"})}return o.createElement(ea,null,e!==m.O2.Offline&&o.createElement(el,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot",status:e}),o.createElement(en,{status:e},r))};function eo({room:e,children:t,status:n,user:i,variant:l,isSelfChat:a=!1}){let{navigate:r}=(0,g.PCX)(),s=null==e?void 0:e.isBotRoom,d=()=>{!s&&(null==e?void 0:e.t)===m.CJ.Direct&&i&&i.username&&r(`/${i.username}`)};return(null==e?void 0:e.t)===m.CJ.Direct?o.createElement(et,{"data-testid":A()("Chat Dock Header title")},o.createElement(ei,{onClick:d,type:null==e?void 0:e.t,isChatBot:s},t),(null==e?void 0:e.t)===m.CJ.Direct&&ee()(n)?o.createElement(er,{statusProps:n,user:i,isSelfChat:a}):null):o.createElement(et,{"data-testid":A()("Chat Dock Header title")},o.createElement(ei,{type:null==e?void 0:e.t,variant:l},t))}var es=n(24713),ed=n.n(es);let ec=(0,W.A)(e=>(0,H.A)({root:{display:"flex",padding:"0",margin:"0",listStyle:"none"},item:{position:"relative",lineHeight:"34px",padding:"0",margin:"0",".panelHeader &":{height:"30px",width:"30px",marginLeft:e.spacing(.5)},".panelHeader &:hover button":{color:e.palette.text.secondary,backgroundColor:e.palette.action.selected,borderRadius:"50%"}},btn:{height:"34px",lineHeight:"20px",fontSize:"17px",padding:"0 6px",cursor:"pointer",color:"light"===e.palette.mode?e.palette.grey["600"]:e.palette.text.secondary,position:"relative",minWidth:e.spacing(3),display:"inline-flex",textAlign:"center",alignItems:"center",justifyContent:"center",border:"none",outline:"none",backgroundColor:"transparent",".panelHeader &":{height:"30px",width:"30px"}},itemActive:{},btnActive:{color:e.palette.primary.main}}),{name:"ChatDockToolbar"}),eu=(0,l.Ay)("div",{name:"ToolbarChat",slot:"root",shouldForwardProp:e=>"variant"!==e})(({theme:e,variant:t})=>({display:"flex",padding:"0",margin:"0",listStyle:"none",..."pageMessage"===t&&{"& .MuiListItem-root .ico":{fontSize:e.mixins.pxToRem(13)}}}));function ep({items:e,displayLimit:t=4,variant:n=null,handleAction:l,popperOptions:a}){var r,s,d;let c=ec();if(!Array.isArray(e))return null;if("roomPanel"===n){let u=t-2,p=ed()(e,{testid:"startVoiceCall"}),m=ed()(e,{testid:"startVideoChat"});u=t-2-(p>-1?0:1)-(m>-1?0:1);let g=e.filter((e,t)=>t<u||e.behavior),h=ed()(g,{behavior:"more"});if(h>-1){if(null===(r=g[h].items)||void 0===r?void 0:r.length)g[h].as="dropdown";else{let v=e.filter((e,t)=>t>u-1&&!e.behavior);g[h]={...g[h],items:v,as:"dropdown"}}}return o.createElement(eu,{variant:n},o.createElement(i.c,{items:g,prefixName:"chatplusToolbar.item.",fallbackName:"button",classes:c,handleAction:l,popperOptions:a,menuStyles:S.E1}))}if("pageMessage"===n){let f=e.filter((e,t)=>e.behavior),y=ed()(f,{behavior:"more"});if(y>-1){if(null===(s=f[y].items)||void 0===s?void 0:s.length)f[y].as="dropdown";else{let b=e.filter((e,t)=>!e.behavior);f[y]={...f[y],items:b,as:"dropdown"}}}return o.createElement(eu,{variant:n},o.createElement(i.c,{items:f,prefixName:"chatplusToolbar.item.",fallbackName:"button",classes:c,handleAction:l,variant:n,popperOptions:a}))}let x=e.filter((e,n)=>n<t-1||e.behavior),w=ed()(x,{behavior:"more"});if(w>-1){if(null===(d=x[w].items)||void 0===d?void 0:d.length)x[w].as="dropdown";else{let A=e.filter((e,n)=>n>t-2&&!e.behavior);x[w]={...x[w],items:A,as:"dropdown"}}}return o.createElement(eu,null,o.createElement(i.c,{items:x,prefixName:"chatplusToolbar.item.",fallbackName:"button",classes:c,handleAction:l,popperOptions:a,menuStyles:S.E1}))}},89509(e,t,n){n.d(t,{A:()=>v});var i=n(91557),l=n(3556),a=n(96540),r=n(84058),o=n.n(r),s=n(62193),d=n.n(s),c=n(36338),u=n(88485),p=n(35319);let m=(0,l.Ay)("div")(({theme:e})=>({display:"flex",justifyContent:"space-between",marginTop:e.spacing(.25)})),g=(0,l.Ay)("span",{slot:"UnReadDot"})(({theme:e})=>({display:"inline-block",width:12,height:12,backgroundColor:e.palette.primary.main,borderRadius:20,marginTop:e.spacing(.25)})),h=(0,l.Ay)("div",{shouldForwardProp:e=>"unread"!==e})(({theme:e,unread:t})=>({display:"block",color:e.palette.text.secondary,padding:0,minWidth:0,maxWidth:"calc(100% - 12px)",overflow:"hidden",textOverflow:"ellipsis",fontSize:e.spacing(1.625),lineHeight:e.spacing(2.35),whiteSpace:"nowrap",...t&&{fontWeight:e.typography.fontWeightBold},a:{color:e.palette.text.secondary,pointerEvents:"none"},br:{display:"none"}}));function v({room:e,unread:t,subscription:n}){var l,r,s,v,f,y,b,x,w,A,E,k,C,M,_;let R;let{i18n:P}=(0,i.PCX)(),I=(0,u.hB)(),S=null==e?void 0:e.lastMessage;if(!e||(null==e?void 0:e.no_join)||d()(S))return null;let O="",T=(null==S?void 0:S.t)||(null==S?void 0:S.type),F=!1,z=((null==S?void 0:S.owners)||[]).map(e=>e._id).includes(I._id),B=(null==I?void 0:I._id)===(null==S?void 0:null===(l=S.u)||void 0===l?void 0:l._id)?1:0;if(T){let D=S.msg,j=`user_${T}${(null==S?void 0:S.role)?`_${S.role}`:""}`;switch(j=j.replace(/-/g,"_"),"room_changed_privacy"===T&&(D="public"===D?"Public":"Private"),!0){case"deleted"===T||"rm"===T:j="message_was_deleted";break;case(0,c.A5)(T):/(invite)_/.test(T)||/(start)_/.test(T)?(j="started_a_call",B||(j="user_started_call")):j=/(miss)_/.test(T)&&!B?"missed_a_call":"call_ended"}O=j?P.formatMessage({id:j},{msg:D,type:T,name:null==S?void 0:null===(r=S.u)||void 0===r?void 0:r.name,role:null==S?void 0:S.role,user:a.createElement("b",null,null==S?void 0:null===(s=S.u)||void 0===s?void 0:s.name),bold:e=>a.createElement("b",null,e),owner:(null==S?void 0:null===(v=S.owners)||void 0===v?void 0:v.length)?a.createElement("b",null,null==S?void 0:S.owners[0].name):"",username:null==S?void 0:null===(f=S.u)||void 0===f?void 0:f.name,isUserToMe:B,isOwnerToMe:z?1:0,remaining:((null==S?void 0:S.total)||1)-1}):""}else if((null==S?void 0:null===(y=S.attachments)||void 0===y?void 0:y.length)>0){if("file"===S.attachments[0].type){let W=S.attachments.filter(e=>e.image_url).length;O=(null===(b=S.attachments[0])||void 0===b?void 0:b.image_url)?P.formatMessage({id:"user_sent_photos"},{isUserToMe:B?1:0,total:W,username:null==S?void 0:null===(A=S.u)||void 0===A?void 0:A.name}):(null===(x=S.attachments[0])||void 0===x?void 0:x.audio_url)?P.formatMessage({id:"user_sent_an_audio_clip"},{isUserToMe:B?1:0,username:null==S?void 0:null===(E=S.u)||void 0===E?void 0:E.name}):(null===(w=S.attachments[0])||void 0===w?void 0:w.video_url)?P.formatMessage({id:"user_sent_a_video"},{isUserToMe:B?1:0,username:null==S?void 0:null===(k=S.u)||void 0===k?void 0:k.name}):P.formatMessage({id:"user_sent_an_attachment"},{isUserToMe:B?1:0,username:null==S?void 0:null===(C=S.u)||void 0===C?void 0:C.name})}else{let{isQuote:H}=(0,p.checkIsQuote)(null==S?void 0:S.attachments);if(H){let $=(0,c.XC)(S);O=$?a.createElement("span",{dangerouslySetInnerHTML:{__html:$}}):""}}}else{let L=(0,c.XC)(S);O=L?a.createElement("span",{dangerouslySetInnerHTML:{__html:L}}):"",F=!0}return d()(O)?null:a.createElement(m,{"data-testid":o()("last message")},a.createElement(h,{unread:t},F?(R=P.formatMessage({id:"user_sent_a_message"},{isUserToMe:B?1:0,username:null==S?void 0:null===(M=S.u)||void 0===M?void 0:M.name,msg:F?O:""}),(T||(null==S?void 0:null===(_=S.attachments)||void 0===_?void 0:_.length)>0)&&(R=""),R):O),(null==n?void 0:n.alert)||(null==n?void 0:n.unread)?a.createElement(g,null):null)}},9880(e,t,n){n.d(t,{A:()=>f});var i=n(3556),l=n(8051),a=n(60780),r=n(63461),o=n(96540),s=n(91557),d=n(40515),c=n(62193),u=n.n(c),p=n(61341);let m=(0,i.Ay)(l.A,{name:"ChatPlusLatestMsgButton",slot:"wrapperStyled",shouldForwardProp:e=>"reactMode"!==e})(({theme:e,reactMode:t})=>({position:"absolute",bottom:e.spacing(1.5),display:"inline-flex",left:"50%",transform:"translate(-50%)",zIndex:e.zIndex.tooltip+10,width:"fit-content","& button":{..."light"===e.palette.mode?{boxShadow:e.shadows[3]}:{boxShadow:"none"},"&:hover":{backgroundColor:"dark"===e.palette.mode?e.palette.action.selected:e.palette.background.default}},..."no_react"!==t&&{display:"none"}})),g=(0,i.Ay)(a.A)(({theme:e})=>({boxShadow:"none",fontWeight:"400 !important",fontSize:"15px !important",borderRadius:"999px",padding:"16px 24px !important"})),h=(0,i.Ay)(r.A)(({theme:e})=>({boxShadow:"none",fontWeight:"400 !important",fontSize:"15px !important",borderRadius:"999px",backgroundColor:"dark"===e.palette.mode?e.palette.action.selected:e.palette.background.default})),v=({onClick:e=()=>{},text:t="latest_messages",reactMode:n="no_react",showText:i=!0,refMessage:l,setShowLatestMsg:a,searchMessages:r,rid:c})=>{let{i18n:v,dispatch:f}=(0,s.PCX)(),y=()=>{if(!u()(r)){f({type:"chatplus/room/modeSearch",payload:{rid:c,mode:p.Dn},meta:{onSuccess(){(null==l?void 0:l.current)&&(l.current.scrollToBottom(),a(!1))}}});return}(null==l?void 0:l.current)&&(l.current.scrollToBottom(),a(!1))};return o.createElement(m,{reactMode:n},i?o.createElement(g,{disableRipple:!0,disableFocusRipple:!0,"data-testid":"buttonFetchNewFeed",role:"button",id:"buttonFetchNewFeed",autoFocus:!0,color:"default",size:"smaller",variant:"contained",onClick:y,endIcon:o.createElement(d.s4,{sx:{fontSize:"16px !important"},icon:"ico-arrow-down"})},v.formatMessage({id:t})):o.createElement(h,{color:"default",onClick:y},o.createElement(d.s4,{sx:{fontSize:"16px !important"},icon:"ico-arrow-down"})))},f=v},67912(e,t,n){n.d(t,{A:()=>c});var i=n(97837),l=n(3556),a=n(97763),r=n(96540),o=n(13586);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let d=(0,l.Ay)(({className:e,...t})=>r.createElement(a.A,s({},t,{classes:{popper:e}})))(({theme:e})=>({"& .MuiTooltip-tooltip":{"&.MuiTooltip-tooltipPlacementLeft":{marginRight:`${e.spacing(1)} !important`}}})),c=(0,r.memo)(function({username:e,name:t,size:n="sm",status:l=null,room:a=null,avatarETag:s,hoverCard:c,showTooltip:u=!1}){return r.createElement(d,{title:u&&(t||e),placement:"left",arrow:!1,PopperProps:{popperOptions:{strategy:"fixed"}}},r.createElement("div",null,r.createElement(o.default,{username:e,size:n,name:t,roomType:i.CJ.Direct,status:l,room:a,avatarETag:s,hoverCard:c})))})},76799(e,t,n){n.d(t,{Ay:()=>ef});var i=n(10111),l=n(65121),a=n(91557),r=n(3556),o=n(8051),s=n(62193),d=n.n(s),c=n(96540),u=n(40515),p=n(81502);let m="ProgressItem",g=(0,r.Ay)("div",{name:m,slot:"root",shouldForwardProp:e=>"isAllPage"!==e&&"isMobile"!==e})(({theme:e,isAllPage:t,isMobile:n})=>({"&:not(:first-of-type)":{marginTop:e.spacing(.75)},position:"relative",padding:e.spacing(1),maxWidth:"245px",backgroundColor:e.palette.grey["100"],..."dark"===e.palette.mode&&{backgroundColor:e.palette.grey["600"]},borderRadius:e.spacing(1.25),overflow:"hidden",...t&&!n&&{maxWidth:"400px",padding:e.spacing(1.25,1)}})),h=(0,r.Ay)("div",{name:m,slot:"wrap-item"})(({theme:e})=>({display:"flex",alignItems:"center","& .ico":{marginRight:e.spacing(.75)}})),v=(0,r.Ay)(u.mE)(({theme:e})=>({flex:1,minWidth:0,fontSize:e.mixins.pxToRem(12)})),f=(0,r.Ay)("div",{shouldForwardProp:e=>"isAllPage"!==e})(({theme:e,isAllPage:t})=>({position:"absolute",bottom:0,left:0,right:0,padding:e.spacing(0,1),...t&&{span:{height:e.spacing(.75)}}})),y=function({count:e=1,files:t,progress:n=0,isAllPage:i=!1}){let{i18n:l,useIsMobile:r}=(0,a.PCX)(),o=r();if(t||t.length)return c.createElement(g,{isAllPage:i,isMobile:o},c.createElement(h,null,c.createElement(u.s4,{icon:"ico-paperclip-alt"}),c.createElement(v,{lines:1},1===e?c.createElement(c.Fragment,null,l.formatMessage({id:"uploading_name"},{name:t[0].name})):l.formatMessage({id:"uploading_n_attachments"},{count:e}))),c.createElement(f,{isAllPage:i},c.createElement(p.A,{variant:"determinate",value:n})))};var b=n(1882),x=n.n(b);function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let A=(0,r.Ay)("div")(({theme:e})=>({display:"flex",flexDirection:"column",alignItems:"flex-end",marginBottom:e.spacing(.5),padding:e.spacing(.5,2)})),E=(0,r.Ay)("div",{shouldForwardProp:e=>"isAllPage"!==e})(({theme:e,isAllPage:t})=>({display:"flex",flexDirection:"column",alignItems:"flex-end",width:"100%",...t&&{maxWidth:'calc(~"100% - 50px")'}})),k=function({data:e,eventInit:t,isAllPage:n=!1}){let i=Object.keys(e),l=i.map(t=>({id:t,...e[t]}));return(c.useEffect(()=>{x()(t)&&t()},[]),l.length)?c.createElement(A,null,c.createElement(E,{isAllPage:n},l.map(e=>c.createElement(y,w({},e,{key:e.id,isAllPage:n}))))):null};var C=n(88485),M=n(67912),_=n(97837),R=n(67725),P=n(40120),I=n(59408),S=n(97763);let O="MsgSeenUser",T=(0,r.Ay)("div",{name:O,slot:"UIChatMsgSeenUsers",shouldForwardProp:e=>"isOwner"!==e&&"indexLast"!==e})(({theme:e,isOwner:t,indexLast:n})=>({display:"flex",width:"100%",justifyContent:"flex-end",alignItems:"center",flexFlow:"wrap",transform:"translateX(12px)",marginBottom:e.spacing(-1.5),marginTop:e.spacing(.5),...t?{marginBottom:0}:{marginTop:e.spacing(0),...n&&{transform:"translateX(12px) translateY(-4px)"}}})),F=(0,r.Ay)("span",{name:O,slot:"UIChatMsgListUsersMore"})(({theme:e})=>({background:e.palette.grey["500"],color:e.palette.grey["50"],borderRadius:100,display:"inline-flex",alignItems:"center",justifyContent:"center",height:e.spacing(1.75),padding:e.spacing(0,.5),fontSize:e.spacing(1.5),lineHeight:e.spacing(1.75)})),z=(0,r.Ay)("div",{name:O,shouldForwardProp:e=>"isOwner"!==e})(({theme:e,isOwner:t})=>({marginRight:0,marginLeft:e.spacing(.25),"& .MuiAvatar-root":{fontSize:`${e.mixins.pxToRem(7)} !important`}})),B=({item:e,isOwner:t})=>{var n,i;let{i18n:r}=(0,a.PCX)(),o=(0,C.Fz)(null==e?void 0:e._id);return c.createElement(S.A,{className:"uiChatTooltipSeenUser",title:r.formatMessage({id:"seen_by_user_at_time"},{user:(i=(null==e?void 0:e.name)||(null==e?void 0:e.username)).length>20?`${i.slice(0,20)}...`:i,time:(0,l.rb)(null==e?void 0:null===(n=e.seenAt)||void 0===n?void 0:n.$date)}),placement:"top"},c.createElement(z,{isOwner:t},c.createElement(M.A,{allowLink:!0,size:14,username:(null==o?void 0:o.username)||(null==e?void 0:e.username),name:(null==o?void 0:o.name)||(null==e?void 0:e.name),avatarETag:(null==e?void 0:e.avatarETag)||(null==o?void 0:o.avatarETag)})))};function D({disabled:e,user:t,message:{u:n,seenUser:i},isOwner:l,indexLast:r}){let{dispatch:s}=(0,a.PCX)();if(e||!(null==i?void 0:i.length))return null;let d=i.filter(e=>e._id!==t._id);if(!d.length)return null;let u=d.length-4,p=d.slice(4),m=u?c.createElement(c.Fragment,null,p.slice(0,20).map((e,t)=>c.createElement("div",{key:t},(null==e?void 0:e.name)||e.username)),p.length>20?c.createElement("div",null,"..."):null):null,g=e=>{s({type:"chatplus/room/presentSeenUsersList",payload:e})};return c.createElement(T,{isOwner:l,indexLast:r},u>0?c.createElement(S.A,{title:m,placement:"top"},c.createElement(F,{onClick:()=>g(d)},`+${u}`)):null,d.slice(0,4).map((e,t)=>c.createElement(o.A,{key:t.toString(),onClick:()=>g(d)},c.createElement(B,{item:e,isOwner:l}))))}var j=n(36338),W=n(35319);let H="ChatPlus-ChatBotAction",$=(0,r.Ay)(o.A,{name:H,slot:"root"})(({theme:e})=>({display:"flex",gap:e.spacing(.75),marginTop:e.spacing(.25)})),L=(0,r.Ay)("div",{name:H,slot:"removeBtn",shouldForwardProp:e=>"isReport"!==e})(({theme:e,isReport:t})=>({width:e.spacing(3.75),height:e.spacing(3.75),color:e.palette.text.primary,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",...t&&{transform:"rotateY(180deg)"},"& .ico":{fontSize:e.mixins.pxToRem(16)},"&:hover":{borderRadius:e.shape.borderRadius,backgroundColor:e.palette.grey[100]}})),U=function({message:e,room:t}){let{i18n:n,dispatch:i}=(0,a.PCX)(),l=()=>{i({type:"chatplus/chatbot/likeItem",payload:{room_id:null==t?void 0:t.id,message_id:null==e?void 0:e.id}})},r=()=>{i({type:"chatplus/chatbot/reportItem",payload:{room_id:null==t?void 0:t.id,message_id:null==e?void 0:e.id}})};return c.createElement($,null,c.createElement(S.A,{title:n.formatMessage({id:"like"})},c.createElement(L,{onClick:l},c.createElement(u.s4,{icon:"ico-thumbup-o"}))),c.createElement(S.A,{title:n.formatMessage({id:"chatgpt_bot_report"})},c.createElement(L,{isReport:!0,onClick:r},c.createElement(u.s4,{icon:"ico-thumbdown-o"}))))},N="MsgItem",X=(0,r.Ay)("div",{name:N,slot:"uiChatMsgItem",shouldForwardProp:e=>"isOwner"!==e})(({theme:e,isOwner:t})=>({...t&&{flexDirection:"row-reverse"},minHeight:"40px",marginBottom:e.spacing(.5)})),V=(0,r.Ay)("div",{name:N,slot:"uiChatMsgItemBody",shouldForwardProp:e=>"isOwner"!==e&&"isAlert"!==e&&"isShowReact"!==e})(({theme:e,isOwner:t,isAlert:n,isShowReact:i})=>({display:"flex","@media (hover: hover)":{"&:hover .uiChatItemBtn":{visibility:"visible"}},"@media (hover: none)":{".uiChatItemBtn":{visibility:"visible"}},[e.breakpoints.down("sm")]:{".uiChatItemBtn":{visibility:"visible"}},...t&&{flexDirection:"row-reverse"},...n&&{textAlign:"center",...i&&{justifyContent:"center"}}})),Q=(0,r.Ay)("div",{name:N,slot:"uiChatMsgItemBodyOuter",shouldForwardProp:e=>"isPageAllMessages"!==e&&"msgType"!==e&&"isMsgEdit"!==e&&"totalImage"!==e&&"totalImageQuote"!==e&&"msgContentType"!==e})(({theme:e,isPageAllMessages:t,msgType:n,isMsgEdit:i,totalImage:l,totalImageQuote:a,msgContentType:r})=>({minWidth:0,maxWidth:`calc(100% - ${i?"80px":"50px"})`,...l>1&&{width:"75%"},...1===l&&{width:"65%"},...("message_pinned"===n||"message_unpinned"===n)&&{width:"100%"},..."messageDeleted"===r&&{maxWidth:"calc(100% - 26px)"},...t&&{maxWidth:"65%",...("message_pinned"===n||"message_unpinned"===n)&&{maxWidth:1===a?"300px":"400px",width:"100%"},...1===l&&{maxWidth:"300px",width:"100%"},...2===l&&{width:"36.67%"},...l>2&&{width:"55%"},[e.breakpoints.down("sm")]:{maxWidth:`calc(100% - ${i?"80px":"50px"})`,...l>1&&{width:"75%"},...1===l&&{width:"60%"},...("message_pinned"===n||"message_unpinned"===n)&&{width:"75%"}}}}));function Y({msgId:e,user:t,tooltipPosition:n,isMobile:i,showToolbar:r=!0,disableReact:o,seenUserShow:s,isRoomLimited:d,handleAction:p,isReadonly:m,isRoomOwner:g,room:h,subscription:v,indexLast:f}){let y=`chatplus.entities.message.${e}`,b=(0,C.wg)(y),{jsxBackend:x,usePageParams:w}=(0,a.PCX)(),[A,E]=c.useState(!0),k=c.useRef(null),M=(0,a.yX1)(),S=null==h?void 0:h.isBotRoom,O=(0,C.sz)(),T=(0,C.y8)(null==h?void 0:h.id),F=w(),z=(null==F?void 0:F.rid)||!1,[B]=(0,a.Vd3)(y,{}),H=(0,C.y0)(),{_id:$,t:L,system:N,attachments:Y,reactions:q,msgType:J,starred:G=[],ts:K,u:Z,msgContentType:ee,editedBy:et}=b||{},{dataQuote:en}=(0,W.checkIsQuote)(Y),{count:ei}=(0,l.Ry)(null==en?void 0:en.attachments),el=(0,C.Dr)(),ea=(0,l.Rt)(q,el),er=t._id===(null==Z?void 0:Z._id),eo=(0,l.rb)(null==K?void 0:K.$date),es=(0,l.rs)(Y),ed=(0,l.M2)(L),ec=!!((null==h?void 0:h.t)===_.CJ.Direct&&((null==v?void 0:v.metafoxBlocked)||(null==v?void 0:v.metafoxBlocker))),eu=!!((null==h?void 0:h.t)===_.CJ.Direct&&((null==v?void 0:v.blocked)||(null==v?void 0:v.blocker))),ep=!!(eu||ec),em=G.find(e=>e._id===t._id),eg=!((null==v?void 0:v.allowMessageFrom)!=="noone"),eh=(g||!m)&&!d&&!eg&&!ep,ev=O.Message_AllowStarring&&!eg&&!ep,ef=O.Message_AllowPinning&&T["pin-message"]&&!d&&!eg&&!ep,ey=O.Message_AllowEditing&&(T["edit-message"]||er)&&!d&&!eg&&!ep,eb=O.Message_AllowDeleting&&(T["force-delete-message"]||T["delete-message"]||er&&T["delete-own-message"])&&!d&&!eg&&!ep,ex=(0,j.g$)(b),ew=c.useMemo(()=>(0,R.Ue)(H,{allowReply:eh,allowQuote:!1,isSearch:!1,allowEdit:ey,allowPinning:ef,item:b,allowStarring:ev,isStarred:em,canDelete:eb,room:h,allowCopy:ex}),[H,eh,!1,!1,ey,ef,b,ev,em,eb,h,ex]),eA=(e,t,n)=>{B(e,t,n),p(e,b,n)},eE="messageDeleted"!==ee&&"message_pinned"!==J&&"message_unpinned"!==J,ek=(null==et?void 0:et.username)&&"messageDeleted"!==ee,eC=(0,C.Ay)(),eM=(0,C.nb)(null==h?void 0:h.id),{msgSearch:e_}=eM||{},{scrollToBottomNewest:eR}=eC,eP=c.useRef();c.useEffect(()=>{(null==eP?void 0:eP.current)&&f&&eR(eP.current.clientHeight)},[f]);let eI=c.useCallback(({identity:e,type:t})=>{var n,i,l;if((null==k?void 0:null===(n=k.current)||void 0===n?void 0:n.id)===e&&!(null==k?void 0:null===(i=k.current)||void 0===i?void 0:i.showHover)&&(null==k?void 0:null===(l=k.current)||void 0===l?void 0:l.type)===t){E(!0),k.current=null;return}E(y!==e),k.current={id:e,showHover:y!==e,type:t}},[y,A,null==k?void 0:k.current]);return(c.useEffect(()=>{if((null==e_||!e_.loading)&&eP.current&&((null==e_?void 0:e_.mQuoteId)===(null==b?void 0:b._id)||(null==e_?void 0:e_.id)===(null==b?void 0:b._id))){var e,t,n,i;let{top:l}=null===(e=eP.current)||void 0===e?void 0:e.getBoundingClientRect(),{top:a}=null===(t=M.current)||void 0===t?void 0:t.getBoundingClientRect();l-a>0&&l-a<(null===(n=M.current)||void 0===n?void 0:n.clientHeight)||M.current.scrollTo({top:null===(i=eP.current)||void 0===i?void 0:i.offsetTop})}},[null==e_?void 0:e_.loading,null==e_?void 0:e_.id,null==e_?void 0:e_.mQuoteId,null==b?void 0:b._id]),b)?c.createElement(X,{id:y,isOwner:er,"data-id":$,"data-t":L,"data-testid":$,ref:eP},c.createElement(V,{isOwner:er,isAlert:ed,isShowReact:eE},c.createElement(Q,{isMsgEdit:ek,msgContentType:ee,totalImage:es,isPageAllMessages:z,msgType:J,totalImageQuote:ei},x.render({component:`chatplus.messageContent.${ee}`,props:{message:b,isOwner:er,user:t,createdDate:eo,isRoomLimited:d,msgType:J,tooltipPosition:f||i?"top":n,scrollMessage(){}}})),ek?c.createElement(u.s4,{icon:"ico-pencil",sx:{alignSelf:"center",mr:1,ml:1}}):null,eE&&!ed&&c.createElement(I.A,{identity:y,handleAction:eA,disabled:N||!r,disableReact:o,items:ew,isOwner:er,showHover:A,onClickAction:eI,showActionRef:k,placement:f?"left-end":void 0})),eE&&c.createElement(P.A,{identity:y,disabled:!ea||N,reactions:ea,isOwner:er}),S&&!er?c.createElement(U,{message:b,room:h}):null,c.createElement(D,{disabled:!s,message:b,user:t,isOwner:er,indexLast:f})):null}let q="MsgSet",J=(0,r.Ay)("div",{name:q,slot:"uiChatMsgSet",shouldForwardProp:e=>"isOwner"!==e&&"isAlert"!==e&&"isGroup"!==e})(({theme:e,isOwner:t,isAlert:n,isGroup:i})=>({display:"flex",flexDirection:"row",padding:e.spacing(.5,2),...n&&{"&.uiChatMsgItemCall":{border:"none"},"&.uiChatMsgActions":{justifyContent:"center","&.my-1; .btn":{"&.mx-1":"!important"}}},...t&&{flexDirection:"row-reverse",padding:e.spacing(0,2)}})),G=(0,r.Ay)("div",{name:q,slot:"uiChatMsgSetAvatar",shouldForwardProp:e=>"isOwner"!==e&&"isAlert"!==e})(({theme:e,isOwner:t,isAlert:n})=>({marginRight:e.spacing(1),display:"flex",alignItems:"flex-end",marginBottom:e.spacing(.75),...t&&{display:"none",flexDirection:"row-reverse"},...n&&{display:"none"}})),K=(0,r.Ay)("div",{name:q,slot:"uiChatMsgSetBody",shouldForwardProp:e=>"isOwner"!==e})(({theme:e,isOwner:t})=>({flex:1,minWidth:0,...t&&{flexDirection:"row-reverse"}})),Z=(0,r.Ay)("div",{name:q,slot:"uiChatMsgSetBodyUser"})(({theme:e})=>({...e.typography.body2,color:e.palette.text.secondary,marginBottom:e.spacing(.5),padding:e.spacing(0,.5)}));function ee({msgSet:e,archived:t,settings:n,perms:i,tooltipPosition:a="top",isMobile:r,disableReact:o,room:s,subscription:d,user:u,seenUserShow:p,isReadonly:m,isRoomOwner:g,isRoomLimited:h,handleAction:v,showToolbar:f=!0}){var y;let b=(0,C.Fz)(null==e?void 0:null===(y=e.u)||void 0===y?void 0:y._id);if(!e)return;let{u:x,items:w,t:A}=e,E=u._id===x._id,k=(0,l.EI)(A),_=s&&["p","c"].includes(s.t);return w&&w.length?c.createElement(J,{isOwner:E,isAlert:k,isGroup:_,className:`uiChatMsgSet ${E?"isOwner":""} ${k?"roomAlert":""} ${_?"roomGroup":""}`},c.createElement(G,{isOwner:E,isAlert:k,className:"uiChatMsgSetAvatar"},c.createElement(M.A,{name:(null==b?void 0:b.name)||(null==x?void 0:x.name),username:(null==b?void 0:b.username)||(null==x?void 0:x.username),avatarETag:(null==b?void 0:b.avatarETag)||(null==x?void 0:x.avatarETag),size:32,showTooltip:!0})),c.createElement(K,{className:"uiChatMsgSetBody"},_&&!E&&!k&&c.createElement(Z,null,x.name),w.map((e,i)=>c.createElement(Y,{indexLast:i===w.length-1,user:u,settings:n,archived:t,key:e.toString(),msgId:e,room:s,subscription:d,tooltipPosition:a,isMobile:r,disableReact:o,seenUserShow:p&&i+1===w.length,isReadonly:m,isRoomLimited:h,isRoomOwner:g,handleAction:v,showToolbar:f})))):null}let et=e=>{let t=e.length;if(!t)return -1;for(;t--;){let n=(0,l.M2)(e[t].t);if(!n)return t}return -1};function en({msgGroup:e,archived:t,settings:n,tooltipPosition:i,isMobile:l,disableReact:a,room:r,subscription:o,user:s,isReadonly:d,isRoomOwner:u,isRoomLimited:p,handleAction:m,showToolbar:g=!0}){if(!e)return null;let{items:h}=e,v=et(h);return h?c.createElement("div",null,h.map((e,h)=>c.createElement(ee,{user:s,msgSet:e,key:`k.0${h}`,archived:t,settings:n,tooltipPosition:i,isMobile:l,disableReact:a,room:r,subscription:o,seenUserShow:v===h,isReadonly:d,isRoomLimited:p,isRoomOwner:u,handleAction:m,showToolbar:g}))):null}var ei=n(88980),el=n(13586);let ea="MsgTyping",er=(0,r.Ay)("div",{name:ea,slot:"uiChatMsgSet",shouldForwardProp:e=>"isOwner"!==e})(({theme:e,isOwner:t})=>({display:"flex",flexDirection:"row",padding:e.spacing(.5,2),...t&&{flexDirection:"row-reverse"}})),eo=(0,r.Ay)("div",{name:ea,slot:"uiChatMsgSetBody"})(({theme:e})=>({backgroundColor:"light"===e.palette.mode?"#f8f8f8":"#828080",borderRadius:e.spacing(2),fontSize:e.mixins.pxToRem(12),display:"inline-block"})),es=(0,ei.i7)`
    0% {transform: translateY(0);}
    25%{transform: translateY(-5px);}
    55% {transform: translateY(0);}
    100% {transform: translateY(0);}
`,ed=(0,ei.i7)`
    0% {transform: translateY(0);}
    20%{transform: translateY(0);}
    50% {transform: translateY(-5px);}
    80% {transform: translateY(0);}
    100% {transform: translateY(0);}
`,ec=(0,ei.i7)`
  0% {transform: translateY(0);}
  40%{transform: translateY(0);}
  70% {transform: translateY(-5px);}
  100% {transform: translateY(0);}
`,eu=(0,r.Ay)("div",{name:ea,slot:"uiChatMsgTypingIcon"})(({theme:e})=>({display:"inline-flex",alignItems:"flex-end",justifyContent:"center","& > span":{display:"inline-flex",width:"6px",height:"6px",borderRadius:"100%",background:"light"===e.palette.mode?"#828080":"#cecece",margin:"0 2px","&:nth-of-type(1)":{animation:`${es} 1.3s infinite`},"&:nth-of-type(2)":{animation:`${ed} 1.3s infinite`},"&:nth-of-type(3)":{animation:`${ec} 1.3s infinite`}}})),ep=(0,r.Ay)("div",{name:ea,slot:"uiChatMsgItemMsg"})(({theme:e})=>({borderRadius:e.spacing(1),fontSize:e.spacing(1.75),padding:e.spacing(1),display:"inline-block"})),em=(0,r.Ay)("div",{name:ea,slot:"uiChatMsgSetAvatar"})(({theme:e})=>({marginRight:e.spacing(1)}));function eg({onInit:e,typings:t}){return(c.useEffect(()=>{x()(e)&&e()},[e]),d()(t))?null:c.createElement(c.Fragment,null,t.slice(0,2).map((e,t)=>c.createElement(er,{key:t},c.createElement(em,null,c.createElement(el.default,{name:(null==e?void 0:e.name)||(null==e?void 0:e.username),username:null==e?void 0:e.username,size:32,avatarETag:null==e?void 0:e.avatarETag})),c.createElement(eo,null,c.createElement(ep,null,c.createElement(eu,null,c.createElement("span",null),c.createElement("span",null),c.createElement("span",null)))))))}var eh=n(61341);let ev=(0,r.Ay)(o.A,{name:"Messages",slot:"DateTimeGroup"})(({theme:e})=>({textAlign:"center",color:e.palette.grey["600"]})),ef=c.forwardRef(function({rid:e,typing:t,groups:n,newest:r,disableReact:o,isMobile:s,tooltipPosition:u,settings:p,room:m,archived:g,seenUserShow:h,user:v,groupIds:f,isReadonly:y,isRoomOwner:b,isRoomLimited:x,containerRef:w,handleAction:A,roomProgress:E,isAllPage:C,subscription:M,chatRoom:_,showToolbar:R=!0},P){let{msgSearch:I}=_||{},S=(0,a.yX1)(),[O,T]=c.useState(!!(null==f?void 0:f.length)),F=c.useRef(!1),z=()=>{if(I&&(null==I?void 0:I.mQuoteId)||!(null==I?void 0:I.id)){var e,t;let n=(null===(e=S.current)||void 0===e?void 0:e.scrollHeight)+10;null===(t=S.current)||void 0===t||t.scrollTo({top:n})}};c.useEffect(()=>{if(d()(I)&&!F.current&&O)return F.current=!0,setTimeout(()=>{z()},100),()=>{F.current=!1}},[e,O]),c.useEffect(()=>{T(!!(null==f?void 0:f.length))},[null==f?void 0:f.length]);let B=e=>{if(null==S?void 0:S.current){let t=S.current||{};t.scrollHeight-e-t.scrollTop-eh.AN<=t.clientHeight&&z()}};return(c.useEffect(()=>{if((null==I?void 0:I.mode)!=="quote"&&(null==S?void 0:S.current)&&t){let e=S.current||{};e.scrollHeight-e.scrollTop-eh.AN<=e.clientHeight&&z()}},[t,null==I?void 0:I.mode]),c.useImperativeHandle(P,()=>({scrollToBottom(){z()}})),n)?c.createElement(i.E.Provider,{value:{scrollToBottomNewest:B}},f.map((e,t)=>{var i,a,r,d;return c.createElement("div",{key:`k.0${t}`},n[e]&&(0,l.rb)(null===(i=n[e])||void 0===i?void 0:null===(a=i.ts)||void 0===a?void 0:a.$date)?c.createElement(ev,{py:1},(0,l.rb)(null===(r=n[e])||void 0===r?void 0:null===(d=r.ts)||void 0===d?void 0:d.$date)):null,c.createElement(en,{user:v,msgGroup:n[e],archived:g,settings:p,tooltipPosition:u,isMobile:s,disableReact:o,seenUserShow:h,room:m,subscription:M,isReadonly:y,isRoomLimited:x,isRoomOwner:b,handleAction:A,showToolbar:R}))}),d()(E)?null:c.createElement(k,{data:E,eventInit:z,isAllPage:C}),c.createElement(eg,{typings:t})):null});n(89509),n(9880)},17510(e,t,n){n.d(t,{A:()=>k});var i=n(91557),l=n(96540),a=n(3556);let r=(0,a.Ay)("div",{name:"MsgAttachmentAudio",slot:"uiChatAudioCustom",shouldForwardProp:e=>"isPageAllMessages"!==e&&"msgType"!==e&&"isOwner"!==e&&"isOther"!==e})(({theme:e,isPageAllMessages:t,msgType:n,isOwner:i,isOther:l})=>({width:"300px",maxWidth:"100%",...("message_pinned"===n||"message_unpinned"===n||l)&&{width:i?"177px":"137px"},...("message_pinned"===n||"message_unpinned"===n||l)&&t&&{width:"200px"}})),o=l.memo(function({audio_url:e,msgType:t,isOwner:n,isOther:a,audio_duration:o}){let{usePageParams:s,jsxBackend:d}=(0,i.PCX)(),c=s(),u=(null==c?void 0:c.rid)||!1;return l.createElement(r,{isPageAllMessages:u,msgType:t,isOwner:n,isOther:a},d.render({component:"chatplus.ui.messageWaveForm",props:{autoPlay:!1,url:e,isOwner:n,audioDuration:o,isPageAllMessages:u}}))},(e,t)=>(null==e?void 0:e.audio_url)===(null==t?void 0:t.audio_url)),s="MsgAttachmentImage",d=(0,a.Ay)("div",{name:s})(({theme:e})=>({position:"relative",width:"100%"})),c=(0,a.Ay)("figure",{name:s})(({theme:e})=>({margin:0,display:"block"})),u=(0,a.Ay)("div",{name:s,shouldForwardProp:e=>"isOwner"!==e&&"isPageAllMessages"!==e})(({theme:e,isOwner:t,isPageAllMessages:n})=>({width:"100%",minWidth:t?"200px":"180px",maxWidth:"100%",cursor:"pointer",...n&&{width:"300px",[e.breakpoints.down("sm")]:{width:t?"200px":"180px"}}})),p=(0,a.Ay)("img",{name:s})(({theme:e})=>({position:"absolute",left:0,top:0,width:"100%",borderRadius:e.spacing(1),border:e.mixins.border("secondary")}));function m({isOwner:e,title:t,image_url:n,image_dimensions:a,allowOpenPreview:r=!0}){let{chatplus:o,usePageParams:s}=(0,i.PCX)(),m=s(),g=(null==m?void 0:m.rid)||!1,h=!!a&&a.height/a.width,v=l.useCallback(e=>{r&&o.presentImageView(e,{id:"img0",src:o.sanitizeRemoteFileUrl(n)})},[o,n,r]);return l.createElement(d,null,l.createElement(c,null,l.createElement(u,{isOwner:!!e,isPageAllMessages:g,style:{paddingBottom:`${h?100*h:100}%`}},l.createElement(p,{src:`${o.sanitizeRemoteFileUrl(n)}&width=300`,onClick:v,alt:t}))))}let g="MsgAttachmentImage",h=(0,a.Ay)("div",{name:g,slot:"UIMsgAttachmentImgWrapper"})(({theme:e})=>({position:"relative",width:"100%"})),v=(0,a.Ay)("figure",{name:g})(({theme:e})=>({margin:0,display:"block"})),f=(0,a.Ay)("div",{name:g,shouldForwardProp:e=>"isPageAllMessages"!==e})(({theme:e,isPageAllMessages:t})=>({maxWidth:"100%",cursor:"pointer",marginBottom:"1px",width:"100%",height:"100%",...t&&{width:"100%",height:"100%"}})),y=(0,a.Ay)("img",{name:g})(({theme:e})=>({position:"absolute",left:0,top:0,width:"100%",objectFit:"cover",borderRadius:e.spacing(1),border:e.mixins.border("secondary"),height:"100%"}));function b({image_url:e,images:t,keyIndex:n}){let{chatplus:a,usePageParams:r}=(0,i.PCX)(),o=r(),s=(null==o?void 0:o.rid)||!1,d=t&&t.length?t.map((e,t)=>({id:t,src:a.sanitizeRemoteFileUrl(e.image_url)})):[];return l.createElement(h,null,l.createElement(v,null,l.createElement(f,{isPageAllMessages:s,style:{paddingBottom:"100%"}},l.createElement(y,{src:`${a.sanitizeRemoteFileUrl(e)}&width=150`,onClick(t){a.presentImageView(t,{id:parseInt(n),src:a.sanitizeRemoteFileUrl(e)},d)},alt:"MsgAttachmentMultiImage"}))))}var x=n(85376);let w=(0,a.Ay)("figure",{name:"MsgAttachmentVideo"})(({theme:e})=>({margin:0,display:"block"})),A=l.memo(function({video_url:e,video_width:t,video_height:n,thumb_url:a,isOwner:r,allowOpenPreview:o=!0}){let{chatplus:s,usePageParams:d,useIsMobile:c}=(0,i.PCX)(),u=c(),p=`msg-video-${e}`,m=d(),g=(null==m?void 0:m.rid)||!1,h=!u&&g?300:186;return l.createElement(w,null,l.createElement(x.A,{width:h,height:t<=h?"auto":n/(t<=h?h:t/h),src:s.sanitizeRemoteFileUrl(e),idPlaying:p,thumb_url:a,allowOpenPreview:o}))},(e,t)=>(null==e?void 0:e.video_url)===(null==t?void 0:t.video_url)&&(null==e?void 0:e.allowOpenPreview)===(null==t?void 0:t.allowOpenPreview));function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function k({image_url:e,image_dimensions:t,video_url:n,title:a,video_type:r,video_thumb_url:s,audio_url:d,layout:c,totalImages:u,isOwner:p,msgType:g,isOther:h,keyIndex:v,allowOpenPreview:f=!0,audio_duration:y,...x}){let{chatplus:w}=(0,i.PCX)();return d?l.createElement(o,{audio_url:w.sanitizeRemoteFileUrl(d),audio_duration:y,msgType:g,isOwner:p,isOther:h}):n?l.createElement(A,E({isOwner:p,video_url:n,video_type:w.sanitizeRemoteFileUrl(r),thumb_url:w.sanitizeRemoteFileUrl(s),allowOpenPreview:f},x)):e&&"multi-image"===c?l.createElement(b,{title:a,images:u,image_url:e,isOwner:p,msgType:g,isOther:h,keyIndex:v}):e?l.createElement(m,{isOwner:p,title:a,image_dimensions:t,image_url:e,allowOpenPreview:f}):null}},78976(e,t,n){n.d(t,{A:()=>S});var i=n(96540),l=n(88485),a=n(36338),r=n(65121),o=n(91557),s=n(40515),d=n(3556),c=n(8051),u=n(67912),p=n(17510);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let g="MsgAttachmentMultiMedia",h=(0,d.Ay)("div",{name:g,slot:"uiMsgImageAttachmentWrapper",shouldForwardProp:e=>"isOwner"!==e})(({theme:e,isOwner:t})=>({display:"flex",alignItems:"center",flexWrap:"wrap",justifyContent:t?"flex-end":"flex-start",marginTop:e.spacing(.25),width:"100%",gap:e.spacing(.5)})),v=(0,d.Ay)("div",{name:g,slot:"uiMsgImageAttachmentItem",shouldForwardProp:e=>"isPageAllMessages"!==e&&"isLastItem"!==e&&"isAudio"!==e&&"totalImages"!==e})(({theme:e,isPageAllMessages:t,isLastItem:n,isAudio:i,totalImages:l})=>({flexBasis:`calc(100% / 3 - ${e.spacing(.5)})`,...i&&{width:"185px"},...2===l&&{flexBasis:`calc(100% / 2 - ${e.spacing(.5)})`}}));function f({mediaItems:e,isOwner:t,msgType:n,isOther:l}){let{usePageParams:a}=(0,o.PCX)(),r=a(),s=(null==r?void 0:r.rid)||!1;return i.createElement(h,{isOwner:t},e.map((a,r)=>i.createElement(v,{isPageAllMessages:s,isLastItem:r===e.length-1,isAudio:!!(null==a?void 0:a.audio_url),key:`k${r}`,totalImages:e.length},i.createElement(p.A,m({},a,{layout:"multi-image",keyIndex:r,totalImages:e,isOwner:t,msgType:n,isOther:l})))))}function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let b="MsgAttachment",x=(0,d.Ay)("div",{name:b,slot:"UIMsgAttachment",shouldForwardProp:e=>"isOwner"!==e&&"isAudio"!==e&&"isTypeFile"!==e&&"isOther"!==e&&"totalImage"!==e&&"msgType"!==e})(({theme:e,isOwner:t,isAudio:n,isTypeFile:i,isOther:l,msgType:a,totalImage:r})=>({zIndex:2,maxWidth:"100%",display:"flex",flexDirection:"column",alignItems:"flex-start",paddingBottom:e.spacing(.5),marginTop:e.spacing(.25),overflow:"hidden",...(i||r)&&{width:"100%"},...(n||"message_pinned"===a||"message_unpinned"===a||l)&&{backgroundColor:e.palette.grey["100"],..."dark"===e.palette.mode&&{backgroundColor:e.palette.grey["600"]},padding:e.spacing(.5,.75),borderRadius:e.spacing(1.25),"& a":{color:t?"#fff":e.palette.text.primary,textDecoration:"underline",cursor:"pointer"},...t&&{backgroundColor:e.palette.primary.main,color:"#fff !important"}},...t&&{alignItems:"flex-end"},...n&&{width:"185px",paddingTop:e.spacing(1.5)}})),w=(0,d.Ay)("div",{name:b,slot:"TitleLinkStyled",shouldForwardProp:e=>"isOwner"!==e&&"isVideo"!==e&&"isImage"!==e&&"isAudio"!==e&&"isTypeFile"!==e})(({theme:e,isOwner:t,isVideo:n,isImage:i,isAudio:l,isTypeFile:a})=>({borderRadius:e.spacing(1),fontSize:e.spacing(1.75),padding:e.spacing(1),overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",display:"inline-block",maxWidth:"100%",wordBreak:"break-word",wordWrap:"break-word",backgroundColor:e.palette.grey["100"],..."dark"===e.palette.mode&&{backgroundColor:e.palette.grey["600"]},...t&&{backgroundColor:e.palette.primary.main,color:"#fff"},...(n||i)&&{display:"none"},...l&&{width:"300px"},cursor:"pointer","& .ico":{marginRight:e.spacing(1)}})),A=(0,d.Ay)("div",{name:b,slot:"DescriptionStyled",shouldForwardProp:e=>"isOwner"!==e&&"isVideo"!==e})(({theme:e,isOwner:t,isVideo:n})=>({backgroundColor:e.palette.grey["100"],..."dark"===e.palette.mode&&{backgroundColor:e.palette.grey["600"]},borderRadius:e.spacing(1),fontSize:e.spacing(1.75),padding:e.spacing(1),display:"inline-block",...t&&{backgroundColor:e.palette.primary.main,color:"#fff"}})),E=(0,d.Ay)("div",{name:b,slot:"uiMsgAttachmentAuthor"})(({theme:e})=>({display:"flex",justifyContent:"flex-start",alignItems:"center","& .MuiAvatar-root":{fontSize:`${e.spacing(1)} !important`},strong:{padding:e.spacing(0,.5,0,.25)}})),k=(0,d.Ay)("div",{name:b,slot:"uiMsgAttachmentFlex"})(({theme:e})=>({textAlign:"start"})),C=(0,d.Ay)("div",{name:b,slot:"uiMsgAttachmentText"})(({theme:e})=>({margin:e.spacing(.5,0)})),M=(0,d.Ay)("div",{name:b,slot:"UIMsgAttachmentTextDelete"})(({theme:e})=>({margin:e.spacing(.5),marginLeft:0,fontStyle:"italic"})),_=(0,d.Ay)("div",{name:b,slot:"uiMsgAttachmentInfoWrapper",shouldForwardProp:e=>"msgType"!==e&&"isOther"!==e})(({theme:e,msgType:t,isOther:n})=>({...("message_pinned"===t||"message_unpinned"===t||n)&&{borderLeft:"2px solid #a2a2a2",paddingLeft:e.spacing(1),width:"100%"}})),R=(0,d.Ay)(s.mE,{name:b,slot:"uiMsgAttachmentLink"})(({theme:e})=>({cursor:"pointer","& .ico":{marginRight:e.spacing(1)}}));function P({mentions:e=[],title:t,author_real_name:n,author_name:d,author_id:m,text:g,image_url:h,image_dimensions:v,audio_url:b,audio_duration:P,video_url:I,video_type:S,title_link:O,description:T,video_thumb_url:F,attachments:z,type:B,layout:D,isOwner:j,msgType:W,t:H,video_width:$,video_height:L}){let{chatplus:U,i18n:N}=(0,o.PCX)(),X="file"===B,{count:V,data:Q}=(0,r.Ry)(z),Y=(0,l.Fz)(m);return i.createElement(x,{isOwner:j,isAudio:!!b,isTypeFile:!!X,isOther:!b&&!X,msgType:W,totalImage:V},i.createElement(_,{msgType:W,isOther:!b&&!X},d?i.createElement(E,null,i.createElement(u.A,{size:16,name:(null==Y?void 0:Y.name)||d,username:(null==Y?void 0:Y.username)||d,avatarETag:null==Y?void 0:Y.avatarETag}),i.createElement("strong",null,n||d)):null,i.createElement(k,null,"rm"===H?i.createElement(M,null,N.formatMessage({id:"message_was_deleted"})):null,g&&"rm"!==H?i.createElement(C,{dangerouslySetInnerHTML:{__html:(0,a.Ay)(g,{mentions:e})}}):null,z&&z.length?i.createElement(c.A,{mt:1},V>1?i.createElement(f,{mediaItems:Q,isOwner:j,msgType:W,isOther:!b&&!X}):i.createElement(i.Fragment,null,z.map((e,t)=>i.createElement(i.Fragment,{key:`k${t}`},e.video_url||e.image_url||e.audio_url?i.createElement(p.A,y({},e,{key:`k${t}`,msgType:W,isOther:!b&&!X})):i.createElement(i.Fragment,null,e.title_link?i.createElement(R,{lines:1},i.createElement("div",{style:{display:"inline"},onClick:()=>(0,r.NK)(U.sanitizeRemoteFileUrl(e.title_link),!1,!0)},i.createElement(s.s4,{icon:"ico-arrow-down-circle"}),e.title)):null))))):null)),i.createElement(p.A,{image_url:h,video_url:I,audio_url:b,audio_duration:P,title:t,video_type:S,video_thumb_url:F,layout:D,image_dimensions:v,isOwner:j,video_width:$,video_height:L}),O?i.createElement(w,{isOwner:j,isVideo:!!I,isImage:!!h,isAudio:!!b,isTypeFile:!!X},i.createElement(s.mE,{lines:1,onClick:()=>(0,r.NK)(U.sanitizeRemoteFileUrl(O),!1,!0)},i.createElement(s.s4,{icon:"ico-arrow-down-circle"}),t)):null,T?i.createElement(A,{isOwner:j,isVideo:!!I,isImage:!!h,isAudio:!!b,isTypeFile:!!X},T):null)}function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function S({message:e,isOwner:t,msgType:n,dataQuote:l,isQuote:a}){var r;if(!(null===(r=e.attachments)||void 0===r?void 0:r.length))return null;let o=e.attachments;if(a&&l&&(o=o.filter(e=>!e.message_id)),!o&&!o.length)return null;let s=o.filter(e=>e.image_url);return s.length>1?i.createElement(f,{mediaItems:s,isOwner:t}):o.map((e,l)=>i.createElement(P,I({},e,{key:`k${l}`,isOwner:t,msgType:n})))}},35319(e,t,n){n.r(t),n.d(t,{checkIsQuote:()=>B,default:()=>D});var i=n(36338),l=n(3556),a=n(97763),r=n(62193),o=n.n(r),s=n(96540),d=n(78976),c=n(33440),u=n(65121),p=n(91557),m=n(40515),g=n(87773),h=n(8051),v=n(17510),f=n(61341);function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let b="MsgQuote",x=(0,l.Ay)("div",{name:b,slot:"UIMsgAttachment",shouldForwardProp:e=>"isOwner"!==e&&"isAudio"!==e&&"isTypeFile"!==e&&"isOther"!==e&&"msgType"!==e})(({theme:e,isOwner:t,isAudio:n,isTypeFile:i,isOther:l,msgType:a})=>({opacity:"0.8",marginBottom:e.spacing(-2),marginLeft:e.spacing(1),marginRight:0,marginTop:e.spacing(.25),paddingBottom:e.spacing(3),maxWidth:"calc(100% - 8px)",display:"flex",flexDirection:"row",overflow:"hidden",border:e.mixins.border("secondary"),borderRadius:e.spacing(1),minHeight:"70px",cursor:"pointer",...(n||"message_pinned"===a||"message_unpinned"===a||l)&&{"& a":{color:e.palette.text.primary,textDecoration:"underline",cursor:"pointer"},...t&&{color:e.palette.text.secondary,marginRight:e.spacing(1),marginLeft:0}}})),w=(0,l.Ay)("div",{name:b,slot:"uiMsgAttachmentAuthor"})(({theme:e})=>({display:"flex",justifyContent:"flex-start",alignItems:"center","& .MuiAvatar-root":{fontSize:`${e.spacing(1)} !important`}})),A=(0,l.Ay)(g.A)(({theme:e})=>({color:"light"===e.palette.mode?e.palette.grey.A200:e.palette.text.primary})),E=(0,l.Ay)("div",{name:b,slot:"MsgAttachmentFlex",shouldForwardProp:e=>"isAttachment"!==e})(({theme:e,isAttachment:t})=>({textAlign:"start",...t&&{maxWidth:"300px"}})),k=(0,l.Ay)(m.mE,{name:b,slot:"uiMsgAttachmentText"})(({theme:e})=>({color:e.palette.text.secondary})),C=(0,l.Ay)("div",{name:b,slot:"UIMsgAttachmentTextDelete"})(({theme:e})=>({margin:e.spacing(.5),marginLeft:0,fontStyle:"italic"})),M=(0,l.Ay)("div",{name:b,slot:"uiMsgAttachmentInfoWrapper",shouldForwardProp:e=>"msgType"!==e&&"isOther"!==e})(({theme:e,msgType:t,isOther:n})=>({...("message_pinned"===t||"message_unpinned"===t||n)&&{overflow:"hidden",margin:e.spacing(1,1,0,0)}})),_=(0,l.Ay)(m.mE,{name:b,slot:"uiMsgAttachmentLink"})(({theme:e})=>({cursor:"pointer","& .ico":{fontSize:e.mixins.pxToRem(12),marginRight:e.spacing(.5)}})),R=(0,l.Ay)("div")(({theme:e})=>({width:e.spacing(.5),height:"100%",backgroundColor:e.palette.grey["100"]})),P=(0,l.Ay)("div")(({theme:e})=>({width:e.spacing(3),minWidth:e.spacing(3),marginTop:e.spacing(1.5),display:"flex",justifyContent:"center",alignItems:"center"})),I=(0,l.Ay)(m.s4)(({theme:e})=>({marginRight:e.spacing(.5),display:"flex",alignItems:"center"}));function S({dataQuote:e,isOwner:t,rid:n,scrollMessage:l}){let{i18n:a,dispatch:r}=(0,p.PCX)();if(!e)return null;let{mentions:d=[],author_real_name:c,author_name:g,text:b,textRaw:S,audio_url:O,attachments:T,type:F,msgType:z,t:B}=e,D="file"===F,j=S||b,W=j?(0,i.Nj)(j,{mentions:d,onlyShowText:!0}):"",{count:H}=(0,u.Ry)(T),$=()=>{"rm"!==B&&r({type:f.ci,payload:{roomId:n,mid:null==e?void 0:e.message_id,mode:"quote"},meta:{onSuccess:l}})};return s.createElement(x,{isOwner:t,isAudio:!!O,isTypeFile:!!D,isOther:!O&&!D,msgType:z,onClick:$},s.createElement(P,null,s.createElement(R,null)),s.createElement(M,{msgType:z,isOther:!O&&!D},g?s.createElement(w,null,s.createElement(A,{component:"h2",variant:"h5"},c||g)):null,s.createElement(E,{isAttachment:null==T?void 0:T.length},"rm"===B?s.createElement(C,null,a.formatMessage({id:"message_was_deleted"})):null,o()(W)||"rm"===B?null:s.createElement(k,{lines:1,dangerouslySetInnerHTML:{__html:W}}),"rm"!==B&&T&&T.length?s.createElement(h.A,{mt:.5},H>1?s.createElement(k,{lines:1},s.createElement(h.A,{sx:{display:"flex",alignItems:"center"}},s.createElement(I,{icon:"ico-photos-alt-o"}),a.formatMessage({id:"total_photo"},{value:H}))):s.createElement(s.Fragment,null,T.map((e,t)=>s.createElement(s.Fragment,{key:`k${t}`},e.video_url||e.image_url?s.createElement(v.A,y({},e,{key:`k${t}`,msgType:z,isOther:!O&&!D,allowOpenPreview:!1})):e.audio_url?s.createElement(k,{lines:1},(null==e?void 0:e.title)||a.formatMessage({id:"file_attachment"})):s.createElement("div",null,e.title_link?s.createElement(_,{lines:1},s.createElement("div",{style:{display:"inline"}},s.createElement(m.s4,{icon:"ico-paperclip-alt"}),e.title)):null))))):null)))}var O=n(88485);let T="MessageText",F=(0,l.Ay)("div",{name:T,slot:"uiChatMsgItemMsg",shouldForwardProp:e=>"isOwner"!==e&&"isQuote"!==e&&"isMention"!==e&&"activeSearch"!==e&&"isMessageFilter"!==e})(({theme:e,isOwner:t,isQuote:n,isMention:i,activeSearch:l,isMessageFilter:a})=>({zIndex:2,borderRadius:e.spacing(1),fontSize:e.mixins.pxToRem(15),padding:e.spacing(1.25),display:"flex",alignItems:"center","& .mention":{fontWeight:"bold",textDecoration:"none","&:hover":{cursor:"pointer",textDecoration:"underline"}},backgroundColor:e.palette.grey["100"],..."dark"===e.palette.mode&&{backgroundColor:e.palette.grey["600"]},overflowWrap:"break-word",...!i&&{maxWidth:"100%"},"& div:first-of-type":{width:"100%"},"& a":{...!i&&{maxWidth:"100%"},overflowWrap:"break-word",color:e.palette.text.primary,textDecoration:"underline",cursor:"pointer",...i&&{textDecoration:"none","&:hover":{textDecoration:"underline"}}},...t&&!a&&{backgroundColor:e.palette.primary.main,color:"#fff !important","& a":{color:"#fff",textDecoration:"underline"}},...l&&{"& div":{background:"#000",color:"#fff","& a":{color:"#fff"}}}})),z=(0,l.Ay)("div",{name:T,slot:"uiChatMsgItemBodyInnerWrapper",shouldForwardProp:e=>"isOwner"!==e&&"isSearch"!==e&&"isMessageFilter"!==e})(({theme:e,isOwner:t,isSearch:n,isMessageFilter:i})=>({width:"100%",display:"flex",flexDirection:"column",alignItems:"flex-start",...!(n||i)&&t&&{alignItems:"flex-end"}})),B=e=>{var t;let n=e&&e.length&&(null===(t=e[e.length-1])||void 0===t?void 0:t.type)!=="file";if(!n)return{isQuote:n,dataQuote:null};{let i=e.filter(e=>e.message_id);return{isQuote:n,dataQuote:i?i[0]:null}}};function D({message:e,isOwner:t,createdDate:n,tooltipPosition:l,showActiveSearch:r=!0,isMessageFilter:u=!1,scrollMessage:p,isSearch:m=!1}){let[g,h]=s.useState(!1),v=e.msg?(0,i.Ay)(e.msg,{mentions:e.mentions}):null,{isQuote:y,dataQuote:b}=B(null==e?void 0:e.attachments),x=(0,O.nb)(null==e?void 0:e.rid),{msgSearch:w}=x||{},A=s.useMemo(()=>{if(!r||o()(w)||(null==w?void 0:w.mode)===f.Dn)return!1;let t=(null==w?void 0:w.id)===(null==e?void 0:e.id);return(null==w?void 0:w.mQuoteId)===(null==e?void 0:e.id)&&(t=g),t},[r,null==w?void 0:w.mQuoteId,null==w?void 0:w.id,null==w?void 0:w.mode,null==e?void 0:e.id,g]);return s.useEffect(()=>((null==w?void 0:w.mQuoteId)===(null==e?void 0:e.id)&&(h(!0),setTimeout(()=>{h(!1)},f.Uk)),()=>{h(!1)}),[null==e?void 0:e.id,null==w?void 0:w.mQuoteId]),s.createElement(a.A,{title:n,placement:l,PopperProps:{variant:"hidden-partview"}},s.createElement(z,{isOwner:t,isSearch:m,isMessageFilter:u},y?s.createElement(S,{dataQuote:b,isOwner:t,rid:null==e?void 0:e.rid,scrollMessage:p}):null,v?s.createElement(F,{activeSearch:A,isMention:!o()(e.mentions),isQuote:y,isOwner:t,isMessageFilter:u},s.createElement("div",{dangerouslySetInnerHTML:{__html:v}})):null,s.createElement(d.A,{message:e,isOwner:t,isQuote:y,dataQuote:b}),s.createElement(c.A,{message:e})))}},33440(e,t,n){n.d(t,{A:()=>x});var i=n(96540),l=n(65121),a=n(40515),r=n(3556),o=n(62193),s=n.n(o);let d="MsgEmbed",c=(0,r.Ay)("div",{name:d,slot:"uiMsgEmbed"})(({theme:e})=>({marginTop:"4px",marginBottom:"8px",width:"400px",maxWidth:"100%",cursor:"pointer"})),u=(0,r.Ay)("div",{name:d,slot:"uiMsgEmbedOuter"})(({theme:e})=>({display:"flex",flexDirection:"column",borderRadius:"8px",border:e.mixins.border("secondary"),color:"#555555"})),p=(0,r.Ay)("div",{name:d,slot:"ItemMedia"})(({theme:e})=>({width:"100%"})),m=(0,r.Ay)("div",{name:d,slot:"ItemMediaSrc"})(({theme:e})=>({width:"100%",display:"block",position:"relative",backgroundSize:"cover",backgroundPosition:"center center",backgroundRepeat:"no-repeat",backgroundOrigin:"border-box",border:"1px solid rgba(0, 0, 0, 0.1)",borderRadius:"8px 8px 0 0",backgroundColor:"transparent",borderBottom:"1px solid rgba(0, 0, 0, 0.1)","&:before":{content:"''",display:"block",paddingBottom:"56%"}})),g=(0,r.Ay)("div",{name:d,slot:"ItemInner"})(({theme:e})=>({flex:1,minWidth:0,padding:"8px"})),h=(0,r.Ay)(a.mE,{name:d,slot:"ItemTitle"})(({theme:e})=>({marginBottom:"2px",color:"light"===e.palette.mode?e.palette.grey["900"]:e.palette.text.primary})),v=(0,r.Ay)(a.mE,{name:d,slot:"ItemUrl"})(({theme:e})=>({marginBottom:"2px",color:e.palette.text.secondary})),f=(0,r.Ay)(a.mE,{name:d,slot:"ItemDescription"})(({theme:e})=>({color:"light"===e.palette.mode?e.palette.grey["900"]:e.palette.text.primary}));function y({url:e,meta:t,parsedUrl:n,ignoreParse:a}){let r=!a&&(t&&!s()(t)||n&&!s()(n));if(!r)return null;let{ogTitle:o,ogDescription:d,ogImage:y,oembedThumbnailUrl:b,oembedTitle:x,oembedDescription:w}=t,A=n.host,E=o||x,k=d||w;return i.createElement(c,null,i.createElement(u,{onClick:()=>(0,l.NK)(e,!0)},y||b?i.createElement(p,null,i.createElement(m,{style:{backgroundImage:`url(${y||b})`}})):i.createElement(p,null,i.createElement("span",{className:"item-media-src media-default"})),i.createElement(g,null,E?i.createElement(h,{lines:2,variant:"h6"},E):null,i.createElement(v,{lines:2,variant:"body2"},A),k?i.createElement(f,{lines:2,variant:"h6"},k):null)))}function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function x({message:e}){var t;return(null===(t=e.urls)||void 0===t?void 0:t.length)?e.urls.filter(e=>!(null==e?void 0:e.ignoreParse)&&e.meta&&e.parsedUrl).map((e,t)=>i.createElement(y,b({},e,{key:`k${t}`}))):null}},98820(e,t,n){n.d(t,{A:()=>R});var i=n(88485),l=n(91557),a=n(3556),r=n(62193),o=n.n(r),s=n(96540),d=n(67912),c=n(97837),u=n(65121),p=n(40120),m=n(59408),g=n(67725),h=n(61341);let v="MsgItemFilter",f=(0,a.Ay)("div",{name:v,slot:"uiChatMsgItem"})(({theme:e})=>({maxWidth:"100%",width:"100%"})),y=(0,a.Ay)("div",{name:v,slot:"uiChatMsgItemBody"})(({theme:e})=>({display:"flex"})),b=(0,a.Ay)("div",{name:v,slot:"ChatMsgItemBodyOuter"})(({theme:e})=>({maxWidth:"100%"}));function x({msgId:e,user:t,tooltipPosition:n="bottom",isMobile:a,showToolbar:r=!0,isRoomLimited:o,room:d,disableReact:v,subscription:x,settings:w,perms:A,type:E,firstIndex:k=!1,endIndex:C=!1}){let M=`chatplus.chatRooms.${d.id}.messageFilter.${e}`,_=(0,i.wg)(M),{jsxBackend:R,dispatch:P}=(0,l.PCX)(),[I]=(0,l.Vd3)(M,{}),{_id:S,t:O,system:T,reactions:F,msgType:z,ts:B,u:D,starred:j}=_||{},W=t._id===(null==D?void 0:D._id),H=(0,u.rb)(null==B?void 0:B.$date),$=(t,n,i)=>{t===h.ci&&e?P({type:h.ci,payload:{roomId:null==d?void 0:d.id,mid:e,identity:M}}):I(t,n,i)},L=!!((null==d?void 0:d.t)===c.CJ.Direct&&((null==x?void 0:x.metafoxBlocked)||(null==x?void 0:x.metafoxBlocker))),U=!!((null==d?void 0:d.t)===c.CJ.Direct&&((null==x?void 0:x.blocked)||(null==x?void 0:x.blocker))),N=!!(U||L),X=null==j?void 0:j.find(e=>e._id===t._id),V=!((null==x?void 0:x.allowMessageFrom)!=="noone"),Q=(null==w?void 0:w.Message_AllowStarring)&&!V&&!N,Y=w.Message_AllowPinning&&A["pin-message"]&&!o&&!V&&!N,q=w.Message_AllowDeleting&&(A["force-delete-message"]||A["delete-message"]||W&&A["delete-own-message"])&&!o&&!V&&!N,J=(0,i.B)(),G=s.useMemo(()=>(0,g.Ue)(J,{allowPinning:Y,item:_,allowStarring:Q,isStarred:X,canDelete:q,type:E}),[J,Y,_,Q,X,q,E]);return s.createElement(f,{"data-id":S,"data-t":O},s.createElement(y,null,s.createElement(b,null,R.render({component:"chatplus.messageContent.standard",props:{message:_,isOwner:W,user:t,createdDate:H,isRoomLimited:o,msgType:z,tooltipPosition:k?"bottom":C||a?"top":n,isMessageFilter:!0}})),s.createElement(m.A,{identity:M,items:G,handleAction:$,disabled:!1,disableReact:!0})),s.createElement(p.A,{identity:M,disabled:!F||T,reactions:F}))}function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let A="MessageFilter",E=(0,a.Ay)("div",{name:A,slot:"uiChatMsgSet",shouldForwardProp:e=>"isOwner"!==e&&"isAlert"!==e&&"isGroup"!==e})(({theme:e,isOwner:t,isAlert:n,isGroup:i})=>({display:"flex",flexDirection:"row",padding:e.spacing(.5,2),...n&&{"&.uiChatMsgSetAvatar":{display:"none"},"&.uiChatMsgItemCall":{border:"none"},"&.uiChatMsgActions":{justifyContent:"center","&.my-1; .btn":{"&.mx-1":"!important"}}},...t&&{flexDirection:"row-reverse"}})),k=(0,a.Ay)("div",{name:A,slot:"uiChatMsgSetAvatar"})(({theme:e})=>({marginRight:e.spacing(1)})),C=(0,a.Ay)("div",{name:A,slot:"noItemFound"})(({theme:e})=>({...e.typography.body1,padding:e.spacing(1,2),color:e.palette.grey["600"],marginTop:e.spacing(2)})),M=({item:e,isMobile:t,...n})=>{var l,a,r,o;let c=(0,i.Fz)(null==e?void 0:null===(l=e.u)||void 0===l?void 0:l._id);return s.createElement(E,null,s.createElement(k,null,s.createElement(d.A,{name:null==e?void 0:null===(a=e.u)||void 0===a?void 0:a.name,username:null==e?void 0:null===(r=e.u)||void 0===r?void 0:r.username,avatarETag:(null==e?void 0:null===(o=e.u)||void 0===o?void 0:o.avatarETag)||(null==c?void 0:c.avatarETag),size:32,showTooltip:!0})),s.createElement(x,w({msgId:e._id,isMobile:t},n)))},_=({items:e,phraseNoContent:t="no_results_found",isMobile:n=!1,...i},a)=>{let{i18n:r}=(0,l.PCX)(),d=(0,l.yX1)(),c=()=>{let e=d.current.scrollHeight+10;d.current.scrollTo({top:e})};return(s.useImperativeHandle(a,()=>({scrollToBottom(){c()}})),o()(e))?s.createElement(C,null,r.formatMessage({id:t})," "):s.createElement("div",null,e&&Object.values(e).map((t,l)=>s.createElement(M,w({key:t.id.toString(),item:t,firstIndex:0===l,isMobile:n,endIndex:Object.values(e).length===l+1},i))))},R=s.forwardRef(_)},40120(e,t,n){n.d(t,{A:()=>v});var i=n(91557),l=n(3556),a=n(96540),r=n(88485),o=n(85015),s=n.n(o);let d=(0,l.Ay)("span")(({theme:e})=>({display:"inline-flex",alignItems:"center",justifyContent:"center",margin:e.spacing(0,.25)})),c=(0,l.Ay)("img")(({theme:e})=>({width:15,height:15}));function u({id:e,usernames:t}){let n=(0,r.Dr)();if(!e||!t)return null;let i=s()(e)&&e.split(":")[1].split("_")[1];if(!i||!n)return null;let l=n.find(e=>e.id===parseInt(i));return a.createElement(d,null,a.createElement(c,{src:null==l?void 0:l.src,draggable:!1,alt:null==l?void 0:l.title}))}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let m=(0,l.Ay)("div",{shouldForwardProp:e=>"isOwner"!==e})(({theme:e,isOwner:t})=>({display:"flex",margin:0,padding:0,marginBottom:e.spacing(-1),...t&&{flexDirection:"row-reverse"}})),g=(0,l.Ay)("span")(({theme:e})=>({marginLeft:e.spacing(.5),position:"relative",top:"-1px",fontSize:e.typography.pxToRem(14),height:e.spacing(2.5),fontWeight:e.typography.fontWeightRegular})),h=(0,l.Ay)("div")(({theme:e})=>({cursor:"pointer",color:e.palette.grey["800"],backgroundColor:e.palette.grey["50"],position:"relative",borderRadius:e.spacing(1),lineHeight:e.spacing(2.5),whiteSpace:"nowrap",display:"inline-flex",alignItems:"center",padding:e.spacing(.5,.75),boxShadow:"0px 0px 15px 0px #00000026",transform:"translateY(-10px)",height:e.spacing(3),zIndex:2}));function v({identity:e,disabled:t,reactions:n,isOwner:l}){let{dispatch:r,getSetting:o}=(0,i.PCX)(),s=!o("preaction"),d=()=>{r({type:"chatplus/presentReactionsList",payload:{identity:e}})};if(s||t||!n||!Object.keys(n).length)return null;let c=0,v=Object.keys(n).sort((e,t)=>{var i,l,a,r,o,s,d,c;return((null===(i=n[t])||void 0===i?void 0:null===(l=i.usernames)||void 0===l?void 0:l.length)||1)-((null===(a=n[e])||void 0===a?void 0:null===(r=a.usernames)||void 0===r?void 0:r.length)||1)-((null===(o=n[t])||void 0===o?void 0:null===(s=o.updatedAt)||void 0===s?void 0:s.$date)||1)-((null===(d=n[e])||void 0===d?void 0:null===(c=d.updatedAt)||void 0===c?void 0:c.$date)||1)}).reduce((e,t)=>{var i,l;return c+=null===(i=n[t])||void 0===i?void 0:null===(l=i.usernames)||void 0===l?void 0:l.length,{...e,[t]:n[t]}},{});return a.createElement(m,{isOwner:l},a.createElement(h,{onClick:d},Object.keys(v).slice(0,3).map((e,t)=>a.createElement(u,p({id:e},v[e],{key:`k${t}`}))),a.createElement(g,null,c)))}},59408(e,t,n){n.d(t,{A:()=>N});var i=n(91557),l=n(3556),a=n(96540),r=n(40515),o=n(60780),s=n(97763),d=n(63461),c=n(86139),u=n.n(c),p=n(1882),m=n.n(p);function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let h="actionMenu";function v(e){let{id:t,label:n,dependName:l,appName:o,menuName:c="itemActionMenu",icon:p="ico-dottedmore-vertical-o",size:v="small",color:f,variant:y,identity:b,testid:x,handleAction:w,className:A,iconClassName:E,control:k,items:C,tooltipTitle:M="",autoHide:_=!0,placement:R,onClickAction:P,showActionRef:I,...S}=e,O=(0,i.wVH)(),T=(0,i.dx2)(b),{compactUrl:F,i18n:z}=(0,i.PCX)(),[B,D]=(0,a.useState)(!1),[j,W]=(0,a.useState)(null!=C?C:[]),H=()=>{D(e=>!e),m()(P)&&P({identity:b,type:h})},$=()=>{var e,t,n;D(!1),(null==I?void 0:I.current)&&(null==I?void 0:null===(e=I.current)||void 0===e?void 0:e.id)===b&&!(null==I?void 0:null===(t=I.current)||void 0===t?void 0:t.showHover)&&(null==I?void 0:null===(n=I.current)||void 0===n?void 0:n.type)===h&&m()(P)&&P({identity:b,type:h})},L=(e,t,n)=>{w(e,t,u()({setMenu:W},n))};if((0,a.useEffect)(()=>{W(C)},[C]),(0,a.useEffect)(()=>{!C&&(C||!B&&_)&&L(o&&c?"presentAppMenu":"presentItemMenu",{dependName:l,appName:o,menuName:c})},[o,l,b,c,B,T,_]),!O.loggedIn||!(null==j?void 0:j.length)&&_)return null;let U=null==j?void 0:j.map(e=>({...e,label:(null==e?void 0:e.label)&&F(null==e?void 0:e.label,T)}));return a.createElement(r.B0,g({open:Boolean(B&&(null==j?void 0:j.length)),id:null!=t?t:c,label:null!=n?n:z.formatMessage({id:"action_menu"}),handleAction:L,items:U,testid:null!=x?x:"action menu",onOpen:H,onClose:$,identity:b,placement:R},S,{control:null!=k?k:a.createElement(s.A,{title:M,disableHoverListener:!M},a.createElement(d.A,{size:v,color:f,variant:y,className:A,disableRipple:!0,disableFocusRipple:!0},a.createElement(r.s4,{icon:p,className:E})))}))}function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let y="MsgActionMenu",b=(0,l.Ay)("div",{name:y,slot:"root"})(({theme:e})=>({})),x=(0,l.Ay)(o.A,{name:y,slot:"UIChatItemBtn",shouldForwardProp:e=>"showHover"!==e})(({theme:e,showHover:t})=>({position:"relative",visibility:t?"hidden":"unset",padding:e.spacing(1,.5),cursor:"pointer",minWidth:e.spacing(3),lineHeight:e.spacing(2.5),color:"light"===e.palette.mode?e.palette.grey["600"]:e.palette.text.secondary})),w={overflowY:"auto",overflowX:"hidden",maxHeight:"260px",maxWidth:"170px","&::-webkit-scrollbar":{height:"6px",width:"6px",borderRadius:"3px",transition:"opacity 200ms"},"&::-webkit-scrollbar-track":{borderRadius:"3px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,.2)",borderRadius:"3px"},"&::-webkit-scrollbar-thumb:horizontal":{background:"#000",borderRadius:"10px"}};function A({identity:e,handleAction:t,scrollRef:n,items:l,showHover:o=!0,placement:d="auto-start",menuStyles:c,...u}){let{i18n:p}=(0,i.PCX)();return a.createElement(b,null,a.createElement(v,f({items:l,placement:d,identity:e,handleAction:t,dependName:"chatplus/msgActionMenu",scrollRef:n,scrollClose:!0,popperOptions:{strategy:"fixed"},variantPopper:"hidden-outview",menuStyles:{menuStyles:w,...c}},u,{control:a.createElement(s.A,{title:p.formatMessage({id:"more"}),placement:"top"},a.createElement(x,{showHover:o,disableFocusRipple:!0,disableRipple:!0,disableTouchRipple:!0,className:"uiChatItemBtn"},a.createElement(r.s4,{icon:"ico-dottedmore-vertical-o"})))})))}var E=n(18799),k=n(83445),C=n(88485),M=n(10671),_=n(20053),R=n(56525),P=n(85838),I=n(62193),S=n.n(I);let O=(0,R.A)(e=>(0,P.A)({paper:{borderRadius:24,margin:0,padding:0},itemsRoot:{display:"flex",flexDirection:"row"},itemRoot:{padding:"4px",display:"flex",alignItem:"center",alignSelf:"center"},itemImage:{width:27,height:27},active:{background:e.palette.grey["300"],padding:e.spacing(.5),borderRadius:e.spacing(1),width:34,height:34,display:"flex",alignItem:"center",justifyContent:"center",margin:e.spacing(.2)}}),{name:"ReactionThisItemPopover"}),T=({item:e,classes:t,onClick:n,active:i})=>a.createElement("div",{className:(0,_.default)(t.itemRoot,i&&t.active),role:"button",onClick:n,"aria-label":e.title,"data-testid":"itemReaction"},a.createElement(s.A,{title:e.title},a.createElement("img",{src:e.src,draggable:!1,alt:e.title,className:t.itemImage}))),F=function({onEmojiClick:e,unsetReaction:t,identity:n}){let{useReactions:l=M.a}=(0,i.PCX)(),r=l(),o=O(),s=(0,C.wg)(n),d=(0,C.hB)(),c=d.username,u=e=>{var t,n,i;return!S()(null==s?void 0:null===(t=s.reactions)||void 0===t?void 0:t[e])&&(null===(n=s.reactions)||void 0===n?void 0:null===(i=n[e])||void 0===i?void 0:i.usernames.includes(c))},p=n=>{let i=u(n);i?t(n):e(n,null)};return a.createElement("div",{className:o.itemsRoot},r.map(e=>a.createElement(T,{key:e.id.toString(),onClick(){p(`:reaction_${e.id.toString()}:`)},classes:o,item:e,active:u(`:reaction_${e.id}:`)})))},z=(0,l.Ay)(E.A)(({theme:e})=>({margin:0,padding:e.spacing(0,.5),maxHeight:"48px",display:"flex",alignItems:"center",whiteSpace:"nowrap"})),B="emoji";function D({onEmojiClick:e,multiple:t=!0,disabled:n,scrollRef:l,scrollClose:o,placement:s="top",label:d="react",control:c,identity:u,unsetReaction:p,showHover:g,onClickAction:h,showActionRef:v}){let{i18n:f}=(0,i.PCX)(),y=f.formatMessage({id:d}),[b,x]=a.useState(null),w=a.useRef(),[A,E]=a.useState(!1),C=a.useCallback(()=>{var e,t,n;E(!1),(null==v?void 0:v.current)&&(null==v?void 0:null===(e=v.current)||void 0===e?void 0:e.id)===u&&!(null==v?void 0:null===(t=v.current)||void 0===t?void 0:t.showHover)&&(null==v?void 0:null===(n=v.current)||void 0===n?void 0:n.type)===B&&m()(h)&&h({identity:u,type:B})},[null==v?void 0:v.current]),M=a.useCallback(()=>{C()},[null==v?void 0:v.current,C]),_=a.useCallback(e=>{E(e=>!e),x(b?null:e.currentTarget),m()(h)&&h({identity:u,type:B})},[]),R=a.useCallback((n,i)=>{e&&e(n,i),t||E(!1)},[t,e]),P=a.useCallback(e=>{p&&p(e),E(!1)},[p]);return a.useEffect(()=>{if(A&&l&&l.current&&o){let e=()=>C();return l.current.addEventListener("scroll",e),()=>{null==l||l.current.removeEventListener("scroll",e)}}},[A]),a.createElement(a.Fragment,null,a.createElement(c,{showHover:g,onClick:_,disabled:n,title:y,"data-testid":"buttonAttachEmoji",icon:"ico-smile-o"}),A?a.createElement(r.qB,{excludeRef:w,onClickAway:M},a.createElement(k.A,{ref:w,open:A,anchorEl:b,placement:s,role:"presentation",style:{zIndex:1300},popperOptions:{strategy:"fixed"},variant:"hidden-outview"},a.createElement(z,{"data-testid":"dialogEmojiPicker"},a.createElement(F,{onEmojiClick:R,unsetReaction:P,identity:u})))):null)}function j(){return(j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let W=(0,l.Ay)(o.A,{name:"MsgEmojiPicker",slot:"UIChatItemBtn",shouldForwardProp:e=>"showHover"!==e})(({theme:e,showHover:t})=>({position:"relative",visibility:t?"hidden":"unset",padding:e.spacing(1,.75),cursor:"pointer",minWidth:e.spacing(2.5),lineHeight:e.spacing(2.5),color:"light"===e.palette.mode?e.palette.grey["600"]:e.palette.text.secondary})),H=a.forwardRef(({title:e,...t},n)=>a.createElement(s.A,{title:e,placement:"top"},a.createElement(W,j({className:"uiChatItemBtn uiChatIconBtn",disableFocusRipple:!0,disableRipple:!0,disableTouchRipple:!0},t,{ref:n}),a.createElement(r.s4,{icon:"ico-smile-o"}))));function $({handleAction:e,scrollRef:t,identity:n,showHover:i=!0,...l}){let r=a.useCallback((t,n=null)=>e("chatplus/messageReaction",{shortcut:t,unicode:n}),[e]),o=a.useCallback(t=>{e("chatplus/unsetReaction",{identity:n,shortcut:t})},[e]);return a.createElement(D,j({size:"small",multiple:!1,onEmojiClick:r,unsetReaction:o,scrollRef:t,scrollClose:!0,identity:n,control:H,showHover:i},l))}function L(){return(L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let U=(0,l.Ay)("div",{name:"MsgToolbar",slot:"uiChatToolbar",shouldForwardProp:e=>"isOwner"!==e})(({theme:e,isOwner:t})=>({display:"flex",justifyContent:"flex-end",alignItems:"center",flex:1,...!t&&{flexDirection:"row-reverse"}}));function N({items:e,disabled:t,disableReact:n,handleAction:l,identity:r,isOwner:o,showHover:s,placement:d,onClickAction:c,showActionRef:u,sxFieldWrapper:p,rest:m}){let{useScrollRef:g}=(0,i.PCX)(),h=g();return t?null:a.createElement(U,{isOwner:o,sx:p},a.createElement(A,L({identity:r,items:e,scrollRef:h,handleAction:l,showHover:s,placement:d,popperOptions:{strategy:"fixed"},onClickAction:c,showActionRef:u},m)),n?null:a.createElement($,{scrollRef:h,handleAction:l,identity:r,showHover:s,onClickAction:c,showActionRef:u}))}},67999(e,t,n){n.d(t,{A:()=>z});var i=n(96540),l=n(3556),a=n(14931),r=n(8051),o=n(97763),s=n(40244),d=n(96327),c=n(8586),u=n(58654),p=n(90590),m=n(64992),g=n(99520),h=n(4634),v=n(91557),f=n(1882),y=n.n(f),b=n(84149);let x="control-video",w=(0,l.Ay)("div",{name:x,slot:"root"})(({theme:e})=>({position:"absolute",bottom:0,right:0,left:0,transition:"all 150ms ease",width:"100%",userSelect:"none"})),A=(0,l.Ay)("div",{name:x,slot:"bottom",shouldForwardProp:e=>"isMinimize"!==e})(({theme:e,isMinimize:t})=>({width:"100%",padding:e.spacing(0,t?1:2),maxHeight:"65%",backgroundImage:"linear-gradient(0deg, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.35) 40%, transparent)",borderRadius:e.shape.borderRadius})),E=(0,s.A)({root:{color:"#fff",width:"10px !important"},thumb:{width:"16px !important",height:"16px !important",boxShadow:"none !important",color:"#fff"},track:{width:"10px !important"},rail:{color:"#fff"}})(a.Ay),k=(0,l.Ay)(r.A,{name:x,slot:"VolumeSliderWrapper",shouldForwardProp:e=>"isHover"!==e&&"isMinimize"!==e})(({theme:e,isHover:t,isMinimize:n})=>({height:70,visibility:"hidden",opacity:0,transition:"all 300ms ease",position:"absolute",bottom:"100%",paddingBottom:e.spacing(2),left:0,...n&&{height:50,paddingBottom:0},...t&&{visibility:"visible",opacity:1}})),C=(0,l.Ay)(r.A,{name:x,slot:"ButtonVolume"})(({theme:e})=>({display:"flex",flexDirection:"column",alignItems:"center",position:"relative",padding:e.spacing(1)})),M=(0,s.A)({root:{padding:0,height:"3px !important",color:"#fff !important",display:"flex",justifyContent:"center",alignItems:"center",flex:1,"& .MuiSlider-thumb:is(:focus, :hover, $active, .Mui-active)":{display:"inline-block !important"}},thumb:{height:"14px !important",width:"14px !important",backgroundColor:"#fff !important",border:"2px solid currentColor",marginTop:0,marginLeft:0,display:"none !important","&:focus, &:hover, &$active":{boxShadow:"inherit !important"}},active:{},valueLabel:{left:"calc(-50% + 4px)"},track:{border:"0 !important",height:"4px !important",borderRadius:4,width:"100%"},rail:{height:"4px !important",borderRadius:4}})(a.Ay),_=(0,l.Ay)("div",{name:x,slot:"slider",shouldForwardProp:e=>"isMinimize"!==e})(({theme:e,isMinimize:t})=>({display:"flex",alignItems:"center",padding:e.spacing(0,2),flex:1,paddingLeft:0,...t&&{paddingRight:e.spacing(.75),paddingLeft:e.spacing(.75)}})),R=(0,l.Ay)("div",{name:x,slot:"ControlBox"})(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"space-between"})),P=(0,l.Ay)("div",{name:x,slot:"InnerControls",shouldForwardProp:e=>!/visible|isMinimize/i.test(e)})(({theme:e,visible:t,isMinimize:n})=>({display:"flex",...!n&&{padding:e.spacing(1.25,0)},alignItems:"center",width:"100%",...!t&&{"& > *":{opacity:0}}})),I=(0,l.Ay)("div",{name:x,slot:"icon-button"})(({theme:e})=>({display:"flex",alignItems:"center",color:"#fff !important",fontSize:e.mixins.pxToRem(15),zIndex:1,"&:hover":{cursor:"pointer"}})),S=(0,l.Ay)(r.A,{name:x,slot:"icon-button"})(({theme:e})=>({padding:e.spacing(1)})),O=(0,l.Ay)("span",{name:x,slot:"TimeSpan"})(({theme:e})=>({color:"#fff",fontSize:e.mixins.pxToRem(12),"& > span":{minWidth:"40px",display:"inline-block","&:nth-of-type(1)":{textAlign:"end"},"&:nth-of-type(2)":{textAlign:"start"}}})),T=(0,l.Ay)(r.A,{name:x,slot:"ProgressWrapper"})(({theme:e})=>({position:"relative",width:"100%",height:"100%",display:"flex",alignItems:"center",flex:1})),F=e=>{var t;let{onPlayPause:n,playing:l,played:a,onSeek:r,onSeekMouseUp:s,onVolumeChangeHandler:f,volume:x,mute:F,onMute:z,formatDuration:B,duration:D,currentTime:j,onMouseSeekDown:W,controlRef:H,loaded:$,onFullScreen:L,showFullScreen:U=!1,isMinimize:N}=e||{},{i18n:X,useIsMobile:V}=(0,v.PCX)(),Q=V(!0),[Y,q]=i.useState(!1),[J,G]=i.useState(!0),[K,Z]=i.useState(""),ee=i.useRef({x:0}),et=i.useRef(null),en=i.useRef(null),ei=()=>{y()(L)&&L()};i.useImperativeHandle(H,()=>({setVisible(e){G(e)},visible:J}));let el=i.useCallback(e=>{try{let t=e.currentTarget.getBoundingClientRect(),n=e.clientX-e.currentTarget.getBoundingClientRect().left,i=(0,b.f)(Math.max(0,n/t.width*D));Z(i),ee.current={x:e.clientX},null!=et.current&&et.current.update()}catch(l){}},[Z,D]);return i.createElement(w,{ref:H},i.createElement(A,{isMinimize:N},i.createElement(R,null,i.createElement(P,{visible:J,isMinimize:N},i.createElement(I,{onClick:n},1===a?i.createElement(h.A,{fontSize:"medium"}):l?i.createElement(d.A,{fontSize:"medium"}):i.createElement(c.A,{fontSize:"medium"})),i.createElement(_,{isMinimize:N},N?null:i.createElement(O,null,i.createElement("span",null,j)," / ",i.createElement("span",null,B)),i.createElement(T,null,i.createElement(o.A,{title:K,placement:"top",arrow:!0,PopperProps:{container:null!==(t=document.fullscreenElement)&&void 0!==t?t:document.body,popperRef:et,sx:{pointerEvents:"none",display:J?void 0:"none !important"},anchorEl:{getBoundingClientRect:()=>new DOMRect(ee.current.x,en.current.getBoundingClientRect().y+10,0,0)}}},i.createElement(M,{min:0,max:100,value:100*a,onChange:r,onChangeCommitted:s,onMouseDown:W,onMouseMove:el,ref:en})),i.createElement(M,{disabled:!0,min:0,max:100,value:100*$,sx:{position:"absolute",top:0,left:0,opacity:.3}}))),N?null:i.createElement(S,null,i.createElement(o.A,{title:X.formatMessage({id:U?"exit_full_screen":"switch_to_full_screen"})},i.createElement(I,{onClick:ei},U?i.createElement(m.A,null):i.createElement(g.A,null)))),i.createElement(C,{sx:{opacity:"1 !important"},onMouseEnter:()=>q(!0),onMouseLeave:()=>q(!1)},Q?null:i.createElement(k,{isHover:Y,isMinimize:N},i.createElement(E,{min:0,max:1,step:.1,orientation:"vertical",onChange:f,value:x})),i.createElement(I,{onClick:z},F?i.createElement(u.A,{fontSize:"medium"}):i.createElement(p.A,{fontSize:"medium"})))))))},z=F},27571(e,t,n){n.d(t,{A:()=>c});var i=n(8051),l=n(89481),a=n(3556),r=n(96540);let o="loading-video",s=(0,a.Ay)(i.A,{name:o,slot:"backdrop"})(({theme:e})=>({position:"absolute",left:0,top:0,bottom:0,right:0,zIndex:10})),d=(0,a.Ay)(i.A,{name:o,slot:"conent"})(({theme:e})=>({position:"absolute",left:"50%",top:"50%",marginLeft:-20,marginTop:-20}));function c({size:e=40}){return r.createElement(s,{"data-testid":"loadingIndicator"},r.createElement(d,null,r.createElement(l.A,{color:"primary",size:e})))}},84149(e,t,n){n.d(t,{f:()=>i,h:()=>l});let i=e=>{if(isNaN(e)||0===e)return"00:00";let t=new Date(1e3*e),n=t.getUTCHours(),i=t.getUTCMinutes(),l=t.getUTCSeconds().toString().padStart(2,"0");return n?`${n}:${i.toString().padStart(2,"0")} `:`${i}:${l}`},l=(e,t)=>{let n=e/t;return isNaN(n)||0===n?"56.25%":`${e/t*100}%`}},85376(e,t,n){n.d(t,{A:()=>S});var i=n(91557),l=n(40515),a=n(3556),r=n(8051),o=n(96540),s=n(26287),d=n(47695),c=n(97200),u=n.n(c),p=n(67999),m=n(84149),g=n(27571),h=n(67725);function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let f=(0,s.Ay)({resolved:{},chunkName:()=>"VideoPlayer",isReady(e){let t=this.resolve(e);return!0===this.resolved[t]&&!!n.m[t]},importAsync:()=>n.e("VideoPlayer").then(n.bind(n,13554)),requireAsync(e){let t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then(e=>(this.resolved[t]=!0,e))},requireSync(e){let t=this.resolve(e);return n(t)},resolve:()=>13554}),y="VideoPlayer",b=(0,a.Ay)(r.A,{name:y,slot:"root"})(({theme:e})=>({width:"100%",height:"100%",display:"flex",alignItems:"center",overflow:"hidden",position:"relative","& .react-player__preview":{position:"relative","&:before":{content:'""',position:"absolute",top:0,bottom:0,left:0,right:0,backgroundColor:"#000",opacity:.4}},"& .ico-play-circle-o":{fontSize:e.mixins.pxToRem(48),color:"#fff",position:"relative"}})),x=(0,a.Ay)("div",{name:y,slot:"playerContainer",shouldForwardProp:e=>!/ratioPercent/i.test(e)})(({theme:e,ratioPercent:t})=>({width:"100%",height:"100%",...t&&{"&:before":{content:'""',paddingTop:null!=t?t:"56.25%",backgroundColor:e.palette.grey.A700,display:"block",width:"100%",borderRadius:e.shape.borderRadius}}})),w=(0,a.Ay)(r.A,{name:y,slot:"playerWrapper"})(({theme:e})=>({width:"100%",height:"100%"})),A=(0,a.Ay)(f,{name:y,slot:"reactPlayer"})(({theme:e})=>({display:"flex",minHeight:"104px",".controls":{width:"10px"},"& video":{maxWidth:"100%",display:"inline-block",borderRadius:e.shape.borderRadius}})),E=(0,a.Ay)("div",{name:y,slot:"ThumbImageWrapper"})(({theme:e})=>({width:"100%",height:"100%",position:"absolute",top:0,zIndex:1,filter:"brightness(0.7)"})),k=(0,a.Ay)(l.s4,{name:y,slot:"CustomPlayButton"})({position:"absolute !important",top:0,bottom:0,left:0,right:0,margin:"auto",width:"fit-content",height:"fit-content",zIndex:2,pointerEvents:"none"}),C=(0,a.Ay)(l._V,{name:y,slot:"imageThumbnail"})(({theme:e})=>({width:"100%",height:"100%","& img":{borderRadius:e.shape.borderRadius}})),M=0,_=e=>Math.min(e/100,.99),R=o.forwardRef((e,t)=>o.createElement(A,v({},e,{ref:t}))),P={},I={};function S(e){var t,n,a,s,c;let{src:v,autoPlay:f=!1,autoplayIntersection:y=!1,idPlaying:A,width:S,height:O,isMinimize:T=!0,currentTime:F,thumb_url:z,allowOpenPreview:B,isDialog:D=!1}=e||{},{dialogBackend:j,useMediaPlaying:W,useSession:H,useIsMobile:$,assetUrl:L,useDialog:U}=(0,i.PCX)(),{dialogProps:N}=U(),X=$(),V=o.useRef(!1),{user:Q}=H(),Y=o.useMemo(()=>A||u()("video"),[A]),q=(0,m.h)(O,S),J=(0,h.AE)(z,"500",L("video.no_image")),[G,K]=W(Y),[Z,ee]=o.useState(!1),[et,en]=o.useState(!1),[ei,el]=(0,d.Wx)({threshold:.5}),[ea,er]=o.useState(!0),eo=o.useRef(null),es=o.useRef(null),ed=o.useRef(null),[ec,eu]=o.useState({muted:null===(s=null==I?void 0:I.muted)||void 0===s||s,volume:null!==(c=null==I?void 0:I.volume)&&void 0!==c?c:1,played:0,seeking:!1,buffer:!0,loadedSeconds:0}),ep=o.useRef(!1),em=(0,i.zy2)();o.useLayoutEffect(()=>{f&&er(!0)},[f]),o.useEffect(()=>{eu(e=>({...e,...I}))},[G]),o.useEffect(()=>{if(P[v]||F){var e;null===(e=eo.current)||void 0===e||e.seekTo(P[v]||F,"fraction")}},[null==em?void 0:em.pathname,F]),o.useEffect(()=>()=>{P[v]=void 0,K(!1)},[]);let{muted:eg,volume:eh,played:ev,buffer:ef,loadedSeconds:ey,seeking:eb}=ec||{};o.useEffect(()=>{P[v]=ev},[ev]);let ex=null===(t=eo.current)||void 0===t?void 0:t.getDuration(),ew=eo.current?null===(n=eo.current)||void 0===n?void 0:n.getCurrentTime():0,eA=eo.current?ex:0,eE=null==Q?void 0:null===(a=Q.video_settings)||void 0===a?void 0:a.user_auto_play_videos,ek=eE&&y,eC=e=>{!Z&&(ee(!0),ek||!f||G||K(!0))},eM=o.useCallback(e=>{K(!0)},[K]),e_=o.useCallback(e=>{K(!1)},[K]);(0,o.useEffect)(()=>{ek&&K(el)},[el]);let eR=(0,m.f)(ew),eP=(0,m.f)(eA),eI=e=>{B&&(e.stopPropagation(),er(!1),K(!0))};(0,o.useEffect)(()=>{D&&(er(!1),K(!0))},[D]);let eS=(e,t=!1)=>{if(e.stopPropagation(),1===ev){var n,i,l,a;null===(n=eo.current)||void 0===n||n.seekTo(0),(null===(i=eo.current)||void 0===i?void 0:i.getInternalPlayer())&&(null===(a=null===(l=eo.current)||void 0===l?void 0:l.getInternalPlayer())||void 0===a||a.play());return}if(G&&!N.open&&!t){j.present({component:"chatplus.dialog.VideoPlayer",props:{src:v,currentTime:ev,thumbUrl:J}});return}K(!G)},eO=e=>{var t;M>3e3?eL():(null===(t=es.current)||void 0===t?void 0:t.visible)&&(M+=200),eb||eu({...ec,...e})},eT=(e,t)=>{var n;let i=_(t);eu({...ec,played:i}),null===(n=eo.current)||void 0===n||n.seekTo(i,"fraction")},eF=(e,t)=>{var n;ep.current&&(K(!0),ep.current=!1);let i=_(t);eu({...ec,seeking:!1}),null===(n=eo.current)||void 0===n||n.seekTo(i,"fraction")},ez=e=>{G&&(ep.current=!0),eu({...ec,seeking:!0})},eB=(e,t)=>{e.stopPropagation();let n={muted:0===Number(t),volume:t};I=n,eu(e=>({...e,...n}))},eD=e=>{e.stopPropagation();let t={muted:!ec.muted,volume:0===ec.volume&&ec.muted?1:ec.volume};I=t,eu(e=>({...e,...t}))},ej=()=>{e$(),V.current=!1},eW=e=>{eu({...ec,buffer:!0})},eH=e=>{eu({...ec,buffer:!1})},e$=o.useCallback(()=>{es.current&&(es.current.setVisible(!0),M=0)},[]),eL=()=>{1!==ec.played&&G&&!et&&es.current&&es.current.setVisible(!1)},eU=()=>{var e,t,n,i,l;if(es.current&&ed.current){if(X){let a=null===(e=ed.current)||void 0===e?void 0:e.querySelector("video");if(!a)return;if(a.webkitSupportsFullscreen){a.webkitEnterFullscreen();return}a.requestFullscreen();return}document.fullscreenElement?document.exitFullscreen():(null===(t=ed.current)||void 0===t?void 0:t.requestFullscreen)?null===(i=ed.current)||void 0===i||i.requestFullscreen():(null===(n=ed.current)||void 0===n?void 0:n.webkitRequestFullscreen)&&(null===(l=ed.current)||void 0===l||l.webkitRequestFullscreen())}},[eN,eX]=o.useState(!1);return o.useEffect(()=>{let e=()=>{document.fullscreenElement?eX(!0):eX(!1)};return document.addEventListener("fullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e)}},[]),o.createElement(o.Fragment,null,o.createElement(r.A,{display:ea&&z?"inherit":"none !important"},o.createElement(b,{width:`${S}px !important`},o.createElement(x,{ratioPercent:q},o.createElement(E,{onClick:eI},o.createElement(C,{src:J,aspectRatio:"fixed"})),o.createElement(k,{icon:"ico-play-circle-o"})))),o.createElement(b,{display:ea&&z?"none !important":"inherit",ref:ei,onMouseLeave:eL,onMouseMove:e$},o.createElement(x,{ref:ed},o.createElement(w,{onClick:eS},ef&&G?o.createElement(g.A,{size:T?26:50}):null,o.createElement(R,{ref:eo,onEnded:ej,onPause:e_,onPlay:eM,onClickPreview:eM,progressInterval:200,url:v,controls:!1,config:{...X&&{file:{attributes:{controlsList:"nofullscreen",disablePictureInPicture:"",playsInline:!0}}}},onReady:eC,className:"player",width:S,height:O,playing:G&&!ep.current,volume:eh,muted:eg,playIcon:o.createElement(l.s4,{icon:"ico-play-circle-o"}),onProgress:eO,onBuffer:eW,onBufferEnd:eH})),Z?o.createElement(p.A,{controlRef:es,onPlayPause:e=>eS(e,!0),playing:G,played:ev,loaded:ey/ex,buffer:ef,onSeek:eT,onSeekMouseUp:eF,onMouseSeekDown:ez,volume:eg?0:eh,onVolumeChangeHandler:eB,mute:eg,onMute:eD,duration:eA,formatDuration:eP,currentTime:eR,onFullScreen:eU,showFullScreen:eN,setIsEditControl:en,isMinimize:T}):null)))}}}]);