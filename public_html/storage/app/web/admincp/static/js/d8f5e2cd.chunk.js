"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-photo-components-UploadMultiPhoto-UploadMultiPhotoField"],{59262(e,t,r){r.d(t,{A:()=>l});var i=r(96540),n=r(23805),o=r.n(n);let a=e=>e?o()(e)?a(Object.values(e)[0]):e.toString():null;function l({error:e,className:t="invalid-feedback order-last"}){return e?i.createElement("div",{"data-testid":"error",className:t},a(e)):null}},21505(e,t,r){r.d(t,{A:()=>_});var i=r(91557),n=r(40515),o=r(67725),a=r(3556),l=r(8051),s=r(20053),d=r(96540),u=r(85838),c=r(56525);let g=e=>(0,u.A)({isDragging:{},itemRoot:{width:"100%",backgroundColor:e.mixins.backgroundColor("paper"),borderRadius:e.shape.borderRadius,boxShadow:e.shadows[2],"&$isDragging":{width:"100%",border:"dashed 2px",borderColor:e.palette.primary.main}},itemMediaBackdrop:{backgroundColor:e.mixins.backgroundColor("paper"),textAlign:"center",overflow:"hidden",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",paddingBottom:"56%",borderRadius:e.shape.borderRadius},ratioauto:{},ratio169:{paddingBottom:"56.25%"},ratio916:{paddingBottom:"177.77%"},ratio32:{paddingBottom:"66.66%"},ratio23:{paddingBottom:"150%"},ratio43:{paddingBottom:"75%"},ratio34:{paddingBottom:"133.33%"},ratio13:{paddingBottom:"31%"},ratio11:{paddingBottom:"100%"},itemMedia:{position:"absolute",left:0,top:0,width:"100%",height:"100%",borderRadius:e.shape.borderRadius}}),p=(0,c.A)(g);var h=r(58935),m=r(5079),v=r(58410);let f={PHOTO:"photo"};function b({id:e,index:t,item:r,movePhoto:i,allowDnD:n=!1,children:o}){let a=p(),l=d.useRef(null);if(!r)return;if(!n||!i)return o;let[,u]=(0,m.H)({accept:f.PHOTO,drop(e,r){if(!l.current)return;let n=e.index;n!==t&&(i(n,t),e.index=t)}}),[c,g]=(0,v.i)({type:f.PHOTO,item:{type:f.PHOTO,id:e,index:t},collect:e=>({isDragging:e.isDragging()})}),h=c.isDragging?.5:.9999,b=c.isDragging?"isDragging":"";return g(u(l)),d.createElement("div",{"data-uid":r.uid,style:{cursor:"move",opacity:h},ref:l,className:(0,s.default)(a.itemRoot,b?a.isDragging:"")},o)}var S=r(62193),w=r.n(S),D=r(44383),y=r.n(D),P=r(76096);function C(){return(C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}let I=(0,a.Ay)(l.A,{name:"MultipleUploadField",slot:"ActionsWrapper"})(({theme:e})=>({position:"absolute",top:e.spacing(1),right:e.spacing(1)})),O=(0,a.Ay)(l.A,{name:"MultipleUploadField",slot:"OtherActionsWrapper"})(({theme:e})=>({position:"absolute",top:e.spacing(1),left:e.spacing(1)})),M=(0,a.Ay)(n.Bj,{name:"MultipleUploadField",slot:"ActionButton"})(({theme:e})=>({fontSize:"14px",background:"rgba(0,0,0,0.4) !important",color:e.palette.common.white,"&:hover":{background:"rgba(0,0,0,0.4) !important",color:e.palette.common.white}})),E=(0,a.Ay)("div",{name:"MultipleUploadField",slot:"PreviewVideoWrapper"})(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"center",height:"100%"})),A=(0,a.Ay)("div",{name:"MultipleUploadField",slot:"MaskPlay"})(({theme:e})=>({position:"absolute",width:e.spacing(5),height:e.spacing(5),color:"#fff",backgroundColor:"rgba(0,0,0,0.4)",borderRadius:"50%",left:"50%",top:"50%",marginLeft:e.spacing(-2.5),marginTop:e.spacing(-2.5),display:"flex",alignItems:"center",justifyContent:"center",fontSize:e.mixins.pxToRem(24)})),k=(0,a.Ay)("video",{name:"MultipleUploadField",slot:"PreviewVideo"})({position:"absolute",left:0,top:0,right:0,bottom:0,backgroundRepeat:"no-repeat",backgroundPosition:"center",maxWidth:"100%"}),x=(0,a.Ay)(l.A,{name:"MultipleUploadField",slot:"ItemMediaContainer"})({position:"relative",textAlign:"center"});function _(e){var t;let r=p(),{i18n:a,dialogBackend:u}=(0,i.PCX)(),{item:c,removeItem:g,aspectRatio:m,editItem:v,id:f,allowRemove:S=!0,allowEdit:D=!1,mappingEditPhotoFields:_=[],editPhotoAction:R}=e,U=(0,o.EL)(null==c?void 0:null===(t=c.file)||void 0===t?void 0:t.type)||(null==c?void 0:c.module_name)==="video",T=!o.un&&U&&!(null==c?void 0:c.image),F=(0,i.EkY)(U?"video":P.Zt,U?"video":P.i3,U?"edit_selecting_video":"edit_selecting_photo"),z=(0,i.IgF)(null==R?void 0:R.module_name,null==R?void 0:R.resource_name,null==R?void 0:R.action_name)||{};if(!c)return;let{extra:H}=c,{can_delete:B,can_edit:j}=H||{can_edit:!0,can_delete:!0},N=null!=c&&!!c.uid||B&&S,V=(null==c?void 0:c.uid)?D:j&&D,W=async()=>{if(!V||!z&&!F)return;let e=y()(c,_),t=await u.present({component:"photo.dialog.quickEditPhotoFieldItem",props:{formSchema:w()(z)?F:void 0,dataSource:{...z,apiUrl:(0,o.vi)(z.apiUrl,c)},initialValues:{...e,...null==c?void 0:c.extra_info}}});t&&v(f,{extra_info:t})};return d.createElement(b,C({},e),d.createElement(x,null,d.createElement(l.A,{sx:{position:"relative"},className:(0,s.default)(r.itemMediaBackdrop,r[`ratio${m}`])},U?d.createElement(E,null,T?d.createElement(k,{src:(null==c?void 0:c.source)||(null==c?void 0:c.destination),controls:!1}):d.createElement(h.A,{item:c}),d.createElement(A,null,d.createElement(n.s4,{icon:"ico-play"}))):d.createElement(h.A,{item:c}),d.createElement(O,null,V&&(F||z)?d.createElement(M,{size:"small",onClick:W,color:"primary",icon:"ico-pencil",title:a.formatMessage({id:"edit"})}):null),d.createElement(I,null,N?d.createElement(M,{size:"small",onClick:g,color:"primary",icon:"ico-close",title:a.formatMessage({id:"remove"})}):null))))}},58935(e,t,r){r.d(t,{A:()=>s});var i=r(67725),n=r(3556),o=r(96540);let a=(0,n.Ay)("div",{name:"MultipleUploadField",slot:"PreviewImg",shouldForwardProp:e=>"radio"!==e})(({theme:e,radio:t})=>({position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:e.palette.grey.A700,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"auto 100%",maxWidth:"100%",...t&&"horizontal"===t&&{backgroundSize:"cover"}})),l=({item:e})=>{let[t,r]=o.useState({}),n=(e,t)=>{try{let r=new Image;r.src=t,r.onload=()=>{e({height:r.height,width:r.width})},r.onerror=e=>{}}catch(i){}},l=(null==e?void 0:e.source)||e.image_url||(0,i.AE)(null==e?void 0:e.image,"1024");o.useEffect(()=>{n(r,l)},[]);let s="horizontal";return s=t&&t.width/t.height<=1?"vertical":"horizontal",o.createElement(a,{radio:s,style:{backgroundImage:`url(${l})`}})},s=l},92560(e,t,r){r.r(t),r.d(t,{default:()=>A});var i=r(59262),n=r(91557),o=r(40515),a=r(60780),l=r(89335),s=r(20687),d=r(77299),u=r(8051),c=r(87773),g=r(3556),p=r(30261),h=r(84058),m=r.n(h),v=r(62193),f=r.n(v),b=r(2404),S=r.n(b),w=r(96540),D=r(65639),y=r(21505),P=r(16535);function C(){return(C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}let I=(0,g.Ay)("div",{name:"MultipleUploadField",slot:"Control",shouldForwardProp:e=>"haveError"!==e})(({theme:e,haveError:t})=>({height:120,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",border:e.mixins.border("secondary"),borderColor:"light"===e.palette.mode?"#0000003b":"rgba(255, 255, 255, 0.23)","& .ico-photos-plus-o":{fontSize:`${e.mixins.pxToRem(15)} !important`},"&:hover":{borderColor:"light"===e.palette.mode?"#000":"#fff"},"& button":{[e.breakpoints.down("sm")]:{flexDirection:"column",height:"auto",maxWidth:"calc(100% - 40px)",padding:"10px"}},...t&&{borderColor:`${e.palette.error.main} !important`}})),O=(0,g.Ay)(a.A,{name:"DropButton",slot:"DropButton"})(({theme:e,isOver:t})=>({...t&&{backgroundColor:e.palette.action.hover}})),M=(0,g.Ay)(a.A,{name:"MultipleUploadField",slot:"AddMoreBtnWrapper"})(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"center",color:e.palette.primary.main,borderStyle:"solid",borderWidth:1,borderRadius:e.shape.borderRadius,height:"100%",width:"100%"})),E=(0,g.Ay)(l.A,{name:"Label"})(({theme:e,haveError:t})=>({padding:e.spacing(0,1),background:e.palette.background.paper,...t&&{color:e.palette.error.main}}));function A({name:e,formik:t,acceptTypeFile:r,config:a,disabled:l}){var g;let{accept:h,upload_url:v,item_type:b,max_upload_filesize:A,description:k,label:x,isVideoUploadAllowed:_,acceptFail:R,required:U,allowDrop:T,allowEditPhoto:F=!1,thumbnail_sizes:z,aspectRatio:H="auto",columnSpacing:B=1,rowSpacing:j=1,grid:N={md:4,sm:6,xs:6},mappingEditPhotoFields:V=[],editPhotoAction:W}=a,{i18n:$,jsxBackend:L,ParserPreviewPhoto:q}=(0,n.PCX)(),[,,{setValue:X}]=(0,p.Mt)("fileItemType"),[Y,Z,{setValue:G,setTouched:J}]=(0,p.Mt)(null!=e?e:"ItemPhotoField"),K=(0,w.useRef)(),[Q,ee]=w.useState({}),et=(e,t)=>{let r=Math.round(100*e.loaded/e.total);ee(e=>({...e,[t]:r}))},[er,ei,en]=(0,D.A)({initialValues:Y.value||[],upload_url:v,maxSizeLimit:A,isAcceptVideo:_,messageAcceptFail:R,accept:r||h,inputRef:K}),eo=a.placeholder||"add_photo",ea=e=>ei(t=>t.filter(t=>t.uid!==e)),el=e=>{ei(t=>t.map(t=>t.id===e?{...t,status:"remove"}:t))};w.useEffect(()=>{if(S()(er,Y.value))return;f()(er)&&X(void 0),f()(er)||Z.touched||J(!0);let e=er.map((e,t)=>({...e,ordering:t+1,file_type:null==e?void 0:e.type,fileItemType:b,status:null==e?void 0:e.status,thumbnail_sizes:z,onUploadProgress:t=>et(t,(null==e?void 0:e.id)||(null==e?void 0:e.uid))}));G(e)},[er]);let es=()=>{K.current.click()},ed=e=>{e.length&&en(e,Y.value)},eu=()=>{let e=K.current.files;e.length&&(X(b),en(Object.values(e),Y.value),(null==K?void 0:K.current)&&(K.current.value=null))},ec=Boolean(Z.error&&(Z.touched||t.submitCount)),eg=null==Y?void 0:null===(g=Y.value)||void 0===g?void 0:g.filter(e=>(null==e?void 0:e.status)!=="remove"),ep=null==eg?void 0:eg.length,eh=w.useCallback((e,t)=>{ei(r=>{let i=[...r];return i.splice(t,0,i.splice(e,1)[0]),[...i=null==i?void 0:i.map((e,t)=>({status:"update",...e,ordering:t+1}))]})},[ei]),em=w.useCallback((e,t)=>{ei(r=>{let i=(0,P.jM)(r,r=>{let i=r.find(t=>(null==t?void 0:t.uid)===e||(null==t?void 0:t.id)===e);i&&((null==i?void 0:i.status)||(i.status="update"),Object.assign(i,t))});return i})},[ei]),ev=(e,t)=>{ei(r=>r.map(r=>{var i,n;return(null==r?void 0:r.uid)===(null==t?void 0:t.uid)&&(null==e?void 0:null===(i=e.preUploadFile)||void 0===i?void 0:i.url)?{...r,...null==e?void 0:e.preUploadFile,source:e.source,id:null==e?void 0:null===(n=e.preUploadFile)||void 0===n?void 0:n.temp_file}:r}))};return w.createElement(w.Fragment,null,w.createElement(s.A,{required:U,error:ec,fullWidth:!0,margin:"normal","data-testid":m()(`field ${e}`)},w.createElement(E,{haveError:ec,required:U,variant:"outlined",shrink:!0,color:"primary",disabled:l||t.isSubmitting},a.label),ep?w.createElement(d.Ay,{container:!0,columnSpacing:B,rowSpacing:j},w.createElement(d.Ay,C({item:!0},N),w.createElement(o.dl,{style:{height:"100%"},onDrop:e=>ed(e),render:({canDrop:e,isOver:r})=>w.createElement(M,{disabled:l||t.isSubmitting,onClick:es,startIcon:w.createElement(o.s4,{icon:"ico-photos-plus-o"}),sx:{fontWeight:"bold"},size:"large"},x)})),null==eg?void 0:eg.map((e,r)=>{let i=(null==e?void 0:e.uid)||(null==e?void 0:e.id);return w.createElement(d.Ay,C({item:!0,key:i},N),w.createElement(q,{item:e,onParse:t=>ev(t,e)},w.createElement(u.A,{sx:{position:"relative"}},w.createElement(y.A,{aspectRatio:H,index:r,id:i,movePhoto:eh,item:e,allowDnD:T,allowEdit:F,editPhotoAction:W,mappingEditPhotoFields:V,removeItem:()=>!t.isSubmitting&&((null==e?void 0:e.uid)?ea(null==e?void 0:e.uid):el(e.id)),editItem:em}),L.render({component:"photo.progress.loading",props:{value:Q[i]||0,uploading:t.isSubmitting}}))))})):w.createElement(o.dl,{onDrop:e=>ed(e),render:({canDrop:t,isOver:r})=>w.createElement(I,{haveError:ec,role:"button",onClick:es},w.createElement(O,{size:"small",color:"primary",isOver:r,variant:"outlined","data-testid":m()(`field ${e}`),startIcon:w.createElement(o.s4,{icon:"ico-photos-plus-o"})},$.formatMessage({id:eo})))}),w.createElement("input",{ref:K,type:"file","aria-hidden":!0,className:"srOnly",multiple:!0,accept:r||h,onChange:eu})),k?w.createElement(c.A,{sx:{fontSize:"13px"},color:"text.hint",mt:1},k):null,ec?w.createElement(i.A,{error:Z.error}):null)}},65639(e,t,r){r.d(t,{A:()=>u});var i=r(91557),n=r(96540),o=r(62193),a=r.n(o),l=r(97200),s=r.n(l),d=r(67725);function u({initialValues:e,upload_url:t="",maxSizeLimit:r,isAcceptVideo:o=!0,messageAcceptFail:l,accept:u,inputRef:c,storage_id:g}){var p,h,m,v;let{dialogBackend:f,i18n:b}=(0,i.PCX)(),[S,w]=n.useState(e||[]),D=null!==(h=null!==(p=null==r?void 0:r.photo)&&void 0!==p?p:null==r?void 0:r.other)&&void 0!==h?h:0,y=null!==(v=null!==(m=null==r?void 0:r.video)&&void 0!==m?m:null==r?void 0:r.other)&&void 0!==v?v:0,P=(e,r)=>{let i=[];if(a()(e))return;let n=[];for(let p=0;p<e.length;++p){let h=e[p],m=h.size,v=(0,d.EL)(null==h?void 0:h.type)?y:D,S=(0,d.ti)(h),P={id:0,uid:s()(),source:URL.createObjectURL(h),file_name:h.name,file_size:h.size,file_type:h.type,file:h,upload_url:t,storage_id:g,type:S.match("image/*")?"photo":"video",status:"new"};if("video"===P.type&&!o||!(0,d.HH)((0,d.ti)(h),u)){f.alert({message:l||b.formatMessage({id:"file_accept_type_fail"})}),(null==c?void 0:c.current)&&(c.current.value=null);break}m>v&&0!==v?(P.max_size=v,n.push(P)):i.push(P)}if(i.length&&w(e=>[...r||e,...i]),n.length>0){var C;f.alert({message:1===n.length?b.formatMessage({id:"warning_upload_limit_one_file"},{fileName:(0,d.Tu)(n[0].file_name,30),fileSize:(0,d.lT)(n[0].file_size),maxSize:(0,d.lT)(null===(C=n[0])||void 0===C?void 0:C.max_size)}):b.formatMessage({id:"warning_upload_limit_multi_file"},{numberFile:n.length,photoMaxSize:(0,d.lT)(D),videoMaxSize:(0,d.lT)(y)})})}};return[S,w,P]}},58410(e,t,r){r.d(t,{i:()=>b});var i=r(79396),n=r(8576),o=r(27739),a=r(96540),l=r(31670),s=r(58853),d=r(71643);class u{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){let e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){let e=this.dragSource,t=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return(t&&this.disconnectDragSource(),this.handlerId)?e?(t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)),t):(this.lastConnectedDragSource=e,t):t}reconnectDragPreview(e=!1){let t=this.dragPreview,r=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(r&&this.disconnectDragPreview(),this.handlerId){if(!t){this.lastConnectedDragPreview=t;return}r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=t,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,t,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!(0,l.b)(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!(0,l.b)(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=(0,d.i)({dragSource:(e,t)=>{this.clearDragSource(),this.dragSourceOptions=t||null,(0,s.i)(e)?this.dragSourceRef=e:this.dragSourceNode=e,this.reconnectDragSource()},dragPreview:(e,t)=>{this.clearDragPreview(),this.dragPreviewOptions=t||null,(0,s.i)(e)?this.dragPreviewRef=e:this.dragPreviewNode=e,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}var c=r(56143),g=r(27727);let p=!1,h=!1;class m{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){(0,i.V)(!p,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return p=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{p=!1}}isDragging(){if(!this.sourceId)return!1;(0,i.V)(!h,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return h=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{h=!1}}subscribeToStateChange(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,t){return this.internalMonitor.isOverTarget(e,t)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}}var v=r(85711);class f{beginDrag(){let e=this.spec,t=this.monitor,r=null;return null!=(r="object"==typeof e.item?e.item:"function"==typeof e.item?e.item(t):{})?r:null}canDrag(){let e=this.spec,t=this.monitor;return"boolean"==typeof e.canDrag?e.canDrag:"function"!=typeof e.canDrag||e.canDrag(t)}isDragging(e,t){let r=this.spec,i=this.monitor,{isDragging:n}=r;return n?n(i):t===e.getSourceId()}endDrag(){let e=this.spec,t=this.monitor,r=this.connector,{end:i}=e;i&&i(t.getItem(),t),r.reconnect()}constructor(e,t,r){this.spec=e,this.monitor=t,this.connector=r}}function b(e,t){let r=(0,o.I)(e,t);(0,i.V)(!r.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");let l=function(){let e=(0,c.u)();return(0,a.useMemo)(()=>new m(e),[e])}(),s=function(e,t){let r=(0,c.u)(),i=(0,a.useMemo)(()=>new u(r.getBackend()),[r]);return(0,g.E)(()=>(i.dragSourceOptions=e||null,i.reconnect(),()=>i.disconnectDragSource()),[i,e]),(0,g.E)(()=>(i.dragPreviewOptions=t||null,i.reconnect(),()=>i.disconnectDragPreview()),[i,t]),i}(r.options,r.previewOptions);return!function(e,t,r){let n=(0,c.u)(),o=function(e,t,r){let i=(0,a.useMemo)(()=>new f(e,t,r),[t,r]);return(0,a.useEffect)(()=>{i.spec=e},[e]),i}(e,t,r),l=(0,a.useMemo)(()=>{let t=e.type;return(0,i.V)(null!=t,"spec.type must be defined"),t},[e]);(0,g.E)(function(){if(null!=l){let[e,i]=(0,v.V)(l,o,n);return t.receiveHandlerId(e),r.receiveHandlerId(e),i}},[n,t,r,o,l])}(r,l,s),[(0,n.j)(r.collect,l,s),(0,a.useMemo)(()=>s.hooks.dragSource(),[s]),(0,a.useMemo)(()=>s.hooks.dragPreview(),[s])]}}}]);