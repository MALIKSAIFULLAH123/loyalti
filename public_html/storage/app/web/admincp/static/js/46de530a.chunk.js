"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-chatplus-components-BuddyBlock-Block","metafox-chatplus-components-Avatar"],{72761(e,t,n){n.d(t,{A:()=>O});var i=n(98587),a=n(58168),l=n(96540),r=n(20053),o=n(5004),s=n(75659),d=n(38413),c=n(31609);function u(e){return(0,c.A)("MuiBadge",e)}(0,d.A)("MuiBadge",["root","badge","invisible"]);var m=n(99977),p=n(74848);let g=["badgeContent","component","children","invisible","max","slotProps","slots","showZero"],h=e=>{let{invisible:t}=e;return(0,s.A)({root:["root"],badge:["badge",t&&"invisible"]},u,void 0)},v=l.forwardRef(function(e,t){let{component:n,children:l,max:r=99,slotProps:s={},slots:d={},showZero:c=!1}=e,u=(0,i.A)(e,g),{badgeContent:v,max:f,displayValue:y,invisible:b}=function(e){let{badgeContent:t,invisible:n=!1,max:i=99,showZero:a=!1}=e,l=(0,o.A)({badgeContent:t,max:i}),r=n;!1!==n||0!==t||a||(r=!0);let{badgeContent:s,max:d=i}=r?l:e,c=s&&Number(s)>d?`${d}+`:s;return{badgeContent:s,invisible:r,max:d,displayValue:c}}((0,a.A)({},e,{max:r})),A=(0,a.A)({},e,{badgeContent:v,invisible:b,max:f,showZero:c}),E=h(A),x=n||d.root||"span",w=(0,m.A)({elementType:x,externalSlotProps:s.root,externalForwardedProps:u,additionalProps:{ref:t},ownerState:A,className:E.root}),k=d.badge||"span",C=(0,m.A)({elementType:k,externalSlotProps:s.badge,ownerState:A,className:E.badge});return(0,p.jsxs)(x,(0,a.A)({},w,{children:[l,(0,p.jsx)(k,(0,a.A)({},C,{children:y}))]}))});var f=n(3556),y=n(92353),b=n(87447),A=n(75630);function E(e){return(0,c.A)("MuiBadge",e)}let x=(0,d.A)("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),w=["anchorOrigin","className","component","components","componentsProps","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],k=e=>{let{color:t,anchorOrigin:n,invisible:i,overlap:a,variant:l,classes:r={}}=e,o={root:["root"],badge:["badge",l,i&&"invisible",`anchorOrigin${(0,A.A)(n.vertical)}${(0,A.A)(n.horizontal)}`,`anchorOrigin${(0,A.A)(n.vertical)}${(0,A.A)(n.horizontal)}${(0,A.A)(a)}`,`overlap${(0,A.A)(a)}`,"default"!==t&&`color${(0,A.A)(t)}`]};return(0,s.A)(o,E,r)},C=(0,f.Ay)("span",{name:"MuiBadge",slot:"Root",overridesResolver:(e,t)=>t.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),_=(0,f.Ay)("span",{name:"MuiBadge",slot:"Badge",overridesResolver(e,t){let{ownerState:n}=e;return[t.badge,t[n.variant],t[`anchorOrigin${(0,A.A)(n.anchorOrigin.vertical)}${(0,A.A)(n.anchorOrigin.horizontal)}${(0,A.A)(n.overlap)}`],"default"!==n.color&&t[`color${(0,A.A)(n.color)}`],n.invisible&&t.invisible]}})(({theme:e,ownerState:t})=>(0,a.A)({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(12),minWidth:20,lineHeight:1,padding:"0 6px",height:20,borderRadius:10,zIndex:1,transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.enteringScreen})},"default"!==t.color&&{backgroundColor:(e.vars||e).palette[t.color].main,color:(e.vars||e).palette[t.color].contrastText},"dot"===t.variant&&{borderRadius:4,height:8,minWidth:8,padding:0},"top"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap&&{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${x.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}},"bottom"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap&&{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${x.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}},"top"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap&&{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${x.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}},"bottom"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap&&{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${x.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}},"top"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"circular"===t.overlap&&{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${x.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}},"bottom"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"circular"===t.overlap&&{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${x.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}},"top"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"circular"===t.overlap&&{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${x.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}},"bottom"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"circular"===t.overlap&&{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${x.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}},t.invisible&&{transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.leavingScreen})})),M=l.forwardRef(function(e,t){var n,l,s,d,c,u;let m;let g=(0,y.A)({props:e,name:"MuiBadge"}),{anchorOrigin:h={vertical:"top",horizontal:"right"},className:f,component:A="span",components:E={},componentsProps:x={},overlap:M="rectangular",color:O="default",invisible:P=!1,max:I,badgeContent:R,slots:S,slotProps:T,showZero:B=!1,variant:z="standard"}=g,F=(0,i.A)(g,w),$=(0,o.A)({anchorOrigin:h,color:O,overlap:M,variant:z}),W=P;!1!==P||(0!==R||B)&&(null!=R||"dot"===z)||(W=!0);let{color:j=O,overlap:D=M,anchorOrigin:L=h,variant:U=z}=W?$:g,H=(0,a.A)({},g,{anchorOrigin:L,invisible:W,color:j,overlap:D,variant:U}),N=k(H);"dot"!==U&&(m=R&&Number(R)>I?`${I}+`:R);let X=null!=(n=null!=(l=null==S?void 0:S.root)?l:E.Root)?n:C,V=null!=(s=null!=(d=null==S?void 0:S.badge)?d:E.Badge)?s:_,Q=null!=(c=null==T?void 0:T.root)?c:x.root,q=null!=(u=null==T?void 0:T.badge)?u:x.badge;return(0,p.jsx)(v,(0,a.A)({invisible:P,badgeContent:m,showZero:B,max:I},F,{slots:{root:X,badge:V},className:(0,r.default)(null==Q?void 0:Q.className,N.root,f),slotProps:{root:(0,a.A)({},Q,(0,b.A)(X)&&{as:A,ownerState:(0,a.A)({},null==Q?void 0:Q.ownerState,{anchorOrigin:L,color:j,overlap:D,variant:U})}),badge:(0,a.A)({},q,{className:(0,r.default)(N.badge,null==q?void 0:q.className)},(0,b.A)(V)&&{ownerState:(0,a.A)({},null==q?void 0:q.ownerState,{anchorOrigin:L,color:j,overlap:D,variant:U})})},ref:t}))}),O=M},13586(e,t,n){n.r(t),n.d(t,{default:()=>w});var i=n(91557),a=n(67725),l=n(3556),r=n(12789),o=n(72761),s=n(8051),d=n(30719),c=n(96540),u=n(97837),m=n(65121),p=n(86663),g=n(84058),h=n.n(g);let v=(0,l.Ay)(r.A,{name:"AvatarWrapper"})(({theme:e})=>({borderWidth:"thin",borderStyle:"solid",borderColor:e.palette.border.secondary})),f=(0,l.Ay)(i.N_E,{name:"Link"})(({theme:e})=>({"&:hover":{textDecoration:"none"}})),y=(0,l.Ay)(o.A,{shouldForwardProp:e=>"status"!==e})(({theme:e,status:t})=>({"& .MuiBadge-badge":{...t===u.O2.Offline&&{display:"none"},...t===u.O2.Online&&{color:e.palette.success.main,backgroundColor:e.palette.success.main},...t===u.O2.Away&&{color:e.palette.warning.main,backgroundColor:e.palette.warning.main},...t===u.O2.Busy&&{color:e.palette.error.main,backgroundColor:e.palette.error.main},boxShadow:"dark"===e.palette.mode?"none":`0 0 0 2px ${e.palette.background.paper}`,"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}}})),b=(0,l.Ay)("div",{shouldForwardProp:e=>"sizeProps"!==e})(({theme:e,sizeProps:t})=>({position:"relative",width:"32px",height:"32px",...t&&{width:t,height:t}})),A=(0,l.Ay)(r.A,{shouldForwardProp:e=>"sizeProps"!==e})(({theme:e,sizeProps:t})=>({position:"absolute",bottom:0,left:0,width:"26px",height:"26px",backgroundColor:"dark"===e.palette.mode?e.palette.grey["600"]:e.palette.grey["300"],borderWidth:1,borderStyle:"solid",borderColor:"light"===e.palette.mode?e.palette.grey["50"]:e.palette.grey["800"],zIndex:2,...t&&{width:.7*t,height:.7*t}})),E=(0,l.Ay)(s.A,{shouldForwardProp:e=>"sizeProps"!==e})(({theme:e,sizeProps:t})=>({position:"relative",width:"100%",height:"100%"})),x=(0,l.Ay)(r.A,{shouldForwardProp:e=>"sizeProps"!==e})(({theme:e,sizeProps:t})=>({position:"absolute",top:"50%",right:0,transform:"translate(0%, -50%)",width:"26px",height:"26px",...t&&{width:`${.7*t}px !important`,height:`${.7*t}px !important`}})),w=(0,c.memo)(function({username:e="Name",name:t="Name",src:n,size:l,to:o,onClick:s,status:g=0,room:w,uploadLocal:k=!1,roomType:C=null,avatarETag:_,component:M="span",target:O="_self",noLink:P}){var I,R;let{getSetting:S}=(0,i.PCX)(),T=(0,d.A)(),B=P,z=o,F=C||(null==w?void 0:w.t),$=(0,a.cb)(t),W={width:l,height:l,color:T.palette.grey["50"],fontSize:l/3},j=S("chatplus"),D=null==j?void 0:null===(I=j.server)||void 0===I?void 0:I.replace(/\/$/,""),L=n;if(L||(L=_?`${D}/avatar/${e}?${p.stringify({etag:_})}`:""),$&&(W.backgroundColor=a.m6.hex($)),(null==w?void 0:w.isBotRoom)&&(z=null,B=!0),z)return c.createElement(f,{target:O,to:z||`/${e}`},c.createElement(v,{"data-testid":h()("chatplus avatar"),src:L,alt:t,style:W,component:M,children:$}));if([u.CJ.Private,u.CJ.Public].includes(F)){if(k)return c.createElement(v,{"data-testid":h()("chatplus avatar"),src:L,alt:t,style:W,component:M,children:$});if(null==w?void 0:w.avatarETag)return L=`${D}/avatar/room/${null==w?void 0:w.id}?${p.stringify({etag:null==w?void 0:w.avatarETag})}`,c.createElement(v,{"data-testid":h()("chatplus avatar"),src:L,alt:t,style:W,component:M,children:$});{let U=`${D}/avatar/${null==w?void 0:null===(R=w.u)||void 0===R?void 0:R.username}`;return c.createElement(b,{"data-testid":h()("chatplus avatar"),sizeProps:l},c.createElement(A,{sizeProps:l,src:U,alt:t,component:M,children:$}),c.createElement(E,null,c.createElement(x,{sizeProps:l,src:L,alt:t,style:W,component:M,children:$})))}}if(F===u.CJ.Direct&&g){let H=(0,m.cR)(g);return c.createElement(y,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot",status:H},c.createElement(r.A,{"data-testid":h()("chatplus avatar"),src:L,alt:t,style:W,component:M,children:$}))}return c.createElement(v,{"data-testid":h()("chatplus avatar"),src:L,alt:t,style:W,component:M,children:$,onClick:s,to:B?null:e})})},50728(e,t,n){n.r(t),n.d(t,{default:()=>ew});var i=n(91557),a=n(88485),l=n(84680),r=n(40515),o=n(3556),s=n(8051),d=n(60780),c=n(87773),u=n(63461),m=n(97763),p=n(96540),g=n(16677),h=n(71468),v=n(61341),f=n(97837),y=n(67725),b=n(84058),A=n.n(b),E=n(56449),x=n.n(E),w=n(62193),k=n.n(w),C=n(78106),_=n(13586),M=n(10895),O=n(89509);function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let I=(0,o.Ay)("div",{name:"Chat",slot:"rootBuddyItem",overridesResolver:(e,t)=>[t.rootBuddyItem],shouldForwardProp:e=>"unread"!==e&&"isFocus"!==e&&"isMobile"!==e&&"isActive"!==e})(({theme:e,unread:t,isFocus:n,isMobile:i,isActive:a})=>({marginRight:e.spacing(1),marginLeft:e.spacing(.5),padding:e.spacing(.5,1.5,.5,2),cursor:"pointer",transition:"background-color 300ms ease",display:"flex",alignItems:"center",marginBottom:e.spacing(.5),borderRadius:e.shape.borderRadius,...n&&{background:e.palette.action.selected},position:"relative","&:hover":{background:e.palette.action.hover,"& > div:first-of-type":{flex:"unset",width:"calc(100% - 40px)"}},"&:hover .itemSubtitle,&:hover .uiItemUnReadDot":{display:"none"},"&:hover .uiChatItemBtn":{opacity:1},...i&&{".uiChatItemBtn, &:hover .itemSubtitle":{opacity:1},"& > div:first-of-type":{flex:"unset",width:"calc(100% - 40px)"}},...a&&{".uiChatItemBtn":{opacity:1},".itemSubtitle":{display:"none"},"& > div:first-of-type":{flex:"unset",width:"calc(100% - 40px)"}}})),R=(0,o.Ay)("div")(({theme:e})=>({flex:1,display:"flex",alignItems:"center",padding:e.spacing(1.5,0),color:e.palette.grey["700"],fontSize:e.spacing(1.75),cursor:"pointer",overflow:"hidden"})),S=(0,o.Ay)("div")(({theme:e})=>({marginRight:e.spacing(1)})),T=(0,o.Ay)("div")(({theme:e})=>({flex:1,minWidth:"0"})),B=(0,o.Ay)("div",{shouldForwardProp:e=>"lastMessage"!==e})(({theme:e,lastMessage:t})=>({display:"flex",justifyContent:"space-between",alignItems:"center",...t&&{marginTop:e.spacing(.25)}})),z=(0,o.Ay)("div")(({theme:e})=>({fontWeight:"bold",fontSize:e.spacing(1.875),lineHeight:e.spacing(2.25),color:e.palette.text.primary,flex:1,minWidth:0,maxWidth:"100%",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"})),F=(0,o.Ay)("div")(({theme:e})=>({color:e.palette.text.secondary,display:"inline-flex",alignItems:"center",fontSize:e.spacing(1.625),lineHeight:e.spacing(2.35),marginLeft:e.spacing(1)})),$=(0,o.Ay)(r.s4,{shouldForwardProp:e=>"favorite"!==e})(({theme:e,favorite:t})=>({marginRight:e.spacing(.5),...t&&{color:e.palette.primary.main}})),W=(0,o.Ay)(u.A,{slot:"UIChatItemBtn",shouldForwardProp:e=>"isActive"!==e})(({theme:e,isActive:t})=>({position:"relative",padding:e.spacing(1,.5),cursor:"pointer",minWidth:e.spacing(3),lineHeight:e.spacing(2.5)})),j=(0,o.Ay)("div",{slot:"root",shouldForwardProp:e=>"isSelfChat"!==e})(({theme:e,isSelfChat:t})=>({position:"absolute",right:8,opacity:0,display:"flex",alignItems:"center",...t&&{minWidth:"24px",minHeight:"40px"}})),D=(0,o.Ay)(({className:e,...t})=>p.createElement(m.A,P({},t,{classes:{popper:e}})))(({theme:e})=>({"& .MuiTooltip-tooltip":{..."dark"===e.palette.mode&&{border:e.mixins.border("secondary")}},"& .MuiTooltip-arrow":{"&::before":{..."dark"===e.palette.mode&&{border:e.mixins.border("secondary")}}}}));function L({item:e,handleResetSearch:t,active:n,setActive:l}){var o,d;let{usePageParams:c,dispatch:u,i18n:m,useActionControl:b,ItemActionMenu:E,useIsMobile:w,navigate:P,useScrollRef:L}=(0,i.PCX)(),U=p.useRef(),H=c(),N=(0,C.zy)(),X=L(),{rid:V}=H,Q=w(!0),q=(0,h.d4)(t=>(0,g.a7)(t,null==e?void 0:e.id)),G=(0,a.GV)(null==e?void 0:e.id),J=(0,a.Fz)(null==e?void 0:e.userId),[K]=b(null==e?void 0:e.id,{}),Z=(0,a.f3)(),Y=(0,a.nb)(null==e?void 0:e.id),ee=(0,a.iW)(null==e?void 0:e.id),et=(0,a.sz)(),en=(0,a.y8)(null==e?void 0:e.id),ei=(0,a.Iv)(null==e?void 0:e.id),ea=(0,a.hB)(),el=p.useCallback(()=>{if(t&&t(),(null==e?void 0:e.no_join)||!G){if(null==e?void 0:e.spotlight_user){u({type:"chatplus/chatRoom/newConversation",payload:{users:[{value:null==e?void 0:e.username,label:null==e?void 0:e.name}]}});return}u({type:"chatplus/room/openChatRoomFromBuddy",payload:{rid:e.id||e._id}});return}N.pathname.includes("/messages")||V?P({pathname:`/messages/${e.id}`}):u({type:"chatplus/room/openBuddy",payload:{rid:e.id}})},[e]),er=ei?1:(null==J?void 0:J.status)||0,eo=!!((null==ee?void 0:ee.t)===f.CJ.Direct&&((null==G?void 0:G.blocked)||(null==G?void 0:G.blocker))),es=!!((null==ee?void 0:ee.t)===f.CJ.Direct&&((null==G?void 0:G.metafoxBlocked)||(null==G?void 0:G.metafoxBlocker))),ed=!!(eo||es),ec=!((null==G?void 0:G.allowMessageFrom)!=="noone"),eu=ea&&ee&&ee.muted&&x()(ee.muted)&&!!ee.muted.find(e=>e===ea.username),em=p.useMemo(()=>(0,y.Ue)(Z,{room:e,subscription:G,groups:null==Y?void 0:Y.groups,favorite:null==G?void 0:G.f,settings:et,perms:en,isBlocked:ed,isMetaFoxBlocked:es,isMuted:eu,allowMsgNoOne:ec,isSelfChat:ei}),[Y,G,ee,et,en,Z,ed,es,eu,ec,ei]),ep=!(null==e?void 0:e.no_join)&&!k()(null==e?void 0:e.lastMessage)&&((null==G?void 0:G.alert)||!!(null==G?void 0:G.unread)),eg=p.useCallback(()=>{if(n===e.id){l(null);return}l(e.id)},[n,e.id]),eh=p.useCallback(()=>{n===e.id&&l(null)},[n,e.id]);return p.createElement(r.qB,{excludeRef:U,onClickAway:eh},p.createElement(I,{"data-testid":A()("Buddy Item"),unread:ep,isFocus:!(null==e?void 0:e.no_join)&&V===e.id,isMobile:Q,isActive:n===e.id},p.createElement(R,{"data-testid":A()("Buddy Item Wrapper"),onClick:el},p.createElement(S,{"data-testid":A()("Buddy Item Media")},p.createElement(_.default,{name:(null==q?void 0:q.name)||e.name,username:(null==q?void 0:q.username)||e.fname||e.username,avatarETag:(null==q?void 0:q.avatarETag)||(null==e?void 0:e.avatarETag),size:40,src:null==q?void 0:q.avatar,status:er,room:e})),p.createElement(T,{"data-testid":A()("Buddy Item Inner")},p.createElement(B,{"data-testid":A()("Buddy Item favorite")},(null==G?void 0:G.f)?p.createElement($,{favorite:!0,icon:"ico-heart"}):null,p.createElement(z,{"data-testid":A()("Buddy Item title")},(null==q?void 0:q.name)||e.fname||e.name),(null==e?void 0:e.no_join)?null:p.createElement(F,{className:"itemSubtitle","data-testid":A()("Buddy Item updatedAt")},p.createElement(M.A,{value:null==e?void 0:null===(o=e.lastMessage)||void 0===o?void 0:null===(d=o._updatedAt)||void 0===d?void 0:d.$date,format:"ll"}))),p.createElement(O.A,{room:ee,unread:ep,subscription:G}))),(null==e?void 0:e.no_join)||!G?null:p.createElement(j,{isSelfChat:ei,className:"uiChatItemBtn",onClick:eg},p.createElement(E,{items:em,placement:"bottom-end",scrollRef:X,handleAction:K,popperOptions:{strategy:"fixed"},menuStyles:v.E1,variantPopper:"hidden-outview",control:p.createElement(s.A,null,p.createElement(D,{title:m.formatMessage({id:"more"}),placement:"top"},p.createElement(W,{disableFocusRipple:!0,disableRipple:!0,disableTouchRipple:!0},p.createElement(r.s4,{icon:"ico-dottedmore-vertical-o"}))))}))))}let U="ArchivedList-ChatRoom",H=(0,o.Ay)("div",{name:U,slot:"NoResult"})(({theme:e})=>({padding:e.spacing(1.5,0),fontSize:e.spacing(1.875),color:e.palette.grey["600"],textAlign:"center"})),N=(0,o.Ay)("div",{name:U,slot:"NoMessages"})(({theme:e})=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",padding:e.spacing(1.5,0),fontSize:e.spacing(1.875),color:e.palette.grey["600"],textAlign:"center"})),X=(0,o.Ay)("div",{name:U,slot:"MoreConversations"})(({theme:e})=>({padding:e.spacing(1.5,2),cursor:"pointer","& .ico":{display:"inline-block",width:e.spacing(4),height:e.spacing(4),lineHeight:"32px",backgroundColor:"dark"===e.palette.mode?e.palette.grey["400"]:e.palette.grey["300"],borderRadius:"50%",color:e.palette.grey["600"],textAlign:"center",marginRight:e.spacing(1)},"& span":{...e.typography.h5}})),V=({archivedMessages:e})=>{let{i18n:t}=(0,i.PCX)(),[n,a]=p.useState(20),l=p.useCallback(()=>{a(e=>e+10)},[]);return p.createElement("div",null,null==e?void 0:e.slice(0,n).map(e=>p.createElement(L,{item:e,key:e.id})),e.length>20?p.createElement(X,{onClick:l},p.createElement(r.s4,{icon:"ico-angle-down"}),p.createElement("span",null,t.formatMessage({id:"more_conversations"}))):null)},Q=function({searchValue:e}){let{i18n:t}=(0,i.PCX)(),n=(0,h.d4)(t=>(0,g.d0)(t,e));return n.length?e&&!n.length?p.createElement(H,null,t.formatMessage({id:"no_results_found"})):p.createElement(V,{archivedMessages:n}):p.createElement(N,null,t.formatMessage({id:"no_messages"}))};var q=n(22220),G=n(2404),J=n.n(G),K=n(80962);let Z="BuddyList-ChatRoom",Y=(0,o.Ay)("div",{name:Z,slot:"NoResult"})(({theme:e})=>({padding:e.spacing(1.5,0),fontSize:e.spacing(1.875),color:e.palette.grey["600"],textAlign:"center"})),ee=(0,o.Ay)("div",{name:Z,slot:"NoMessages"})(({theme:e})=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",padding:e.spacing(1.5,0),fontSize:e.spacing(1.875),color:e.palette.grey["600"],textAlign:"center"})),et=(0,o.Ay)("div",{name:Z,slot:"MoreConversations"})(({theme:e})=>({padding:e.spacing(2),cursor:"pointer",display:"flex",alignItems:"center","& span":{...e.typography.h5},"& .ico":{display:"flex",alignItems:"center",justifyContent:"center",width:e.spacing(4.5),height:e.spacing(4.5),backgroundColor:"dark"===e.palette.mode?e.palette.grey["400"]:e.palette.grey["300"],borderRadius:"50%",color:e.palette.grey["600"],textAlign:"center",marginRight:e.spacing(1),fontWeight:e.typography.fontWeightMedium,fontSize:e.mixins.pxToRem(18)}})),en=(0,o.Ay)("div",{name:Z,slot:"BlockCollapse"})(({theme:e})=>({borderTop:e.mixins.border("secondary")})),ei=(0,o.Ay)("div",{name:Z,slot:"BlockCollapseHeader"})(({theme:e})=>({padding:e.spacing(3,2),display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",cursor:"pointer"})),ea=(0,o.Ay)("div",{name:Z,slot:"BlockTitle"})(({theme:e})=>({...e.typography.body1,color:e.palette.text.primary,fontWeight:"600"})),el=(0,o.Ay)(s.A,{name:Z,slot:"ChatBotBlock"})(({theme:e})=>({})),er=(0,o.Ay)("div",{name:Z,slot:"ChatBotBlock"})(({theme:e})=>({borderTop:e.mixins.border("secondary"),margin:e.spacing(1,0)})),eo=({data:e,loading:t,handleResetSearch:n,active:a,setActive:l})=>{let{i18n:o}=(0,i.PCX)(),[s,d]=p.useState(5),c=p.useCallback(()=>{d(e=>e+5)},[]),u=null==e?void 0:e.slice(0,s);return t?p.createElement(K.A,null):p.createElement("div",{"data-testid":A()("block buddy list")},u.map(e=>p.createElement(L,{item:e,key:e.id,handleResetSearch:n,active:a,setActive:l})),e.length>5?u.length===e.length?null:p.createElement(et,{"data-testid":A()("more conversation"),onClick:c},p.createElement(r.s4,{icon:"ico-angle-down"}),p.createElement("span",null,o.formatMessage({id:"more_conversations"}))):null)},es=({title:e,data:t,searchValue:n,roomIdActive:a,loading:l,handleResetSearch:o,active:s,setActive:d,defaultOpen:c=!1})=>{let{i18n:m}=(0,i.PCX)(),[g,h]=p.useState(c),v=p.useCallback(()=>h(e=>!e),[]);p.useEffect(()=>{let e=t.filter(e=>e.id===a);(n||(null==e?void 0:e.length))&&h(!0)},[n,t]);let[f,y]=p.useState(5),b=p.useCallback(()=>{y(e=>e+5)},[]);return l?p.createElement(K.A,{title:e}):t.length?p.createElement(en,{"data-testid":A()("Block Collapse")},p.createElement(ei,{"data-testid":A()("Block Collapse header"),onClick:v},p.createElement(ea,null,e),p.createElement(u.A,{"data-testid":A()("Block Collapse Toggle"),size:"small",color:"default"},p.createElement(r.s4,{icon:g?"ico-angle-up":"ico-angle-down"}))),g?p.createElement("div",{"data-testid":A()("block buddy list collapse")},null==t?void 0:t.slice(0,f).map(e=>p.createElement(L,{item:e,key:null==e?void 0:e.id,handleResetSearch:o,active:s,setActive:d})),t.length>5?(null==t?void 0:t.slice(0,f).length)===t.length?null:p.createElement(et,{"data-testid":A()("more conversation"),onClick:b},p.createElement(r.s4,{icon:"ico-angle-down"}),p.createElement("span",null,m.formatMessage({id:"more_conversations"}))):null):null):null},ed=(0,p.memo)(function({rid:e,handleResetSearch:t,searchValue:n}){var a,l;let{i18n:r,dispatch:o}=(0,i.PCX)(),{loading:d}=(0,q.A)(),{directChats:c,publicGroups:u,isFetchDone:m,chatBot:v}=(0,h.d4)(e=>(0,g.U$)(e,null,!0)),f=p.useRef({directChats:c,publicGroups:u,chatBot:v,isFetchDone:m}),y=p.useRef(!0),[b,E]=p.useState(null);p.useEffect(()=>{n||J()(f.current,{directChats:c,publicGroups:u,chatBot:v,isFetchDone:m})||(f.current={directChats:c,publicGroups:u,chatBot:v,isFetchDone:m})},[c,u,v,m,f,n]),p.useEffect(()=>{if(y.current){y.current=!1;return}o({type:"chatplus/spotlight",payload:{query:n,users:!0,rooms:!0},meta:{onSuccess(e){f.current=e}}})},[n]);let x=p.useMemo(()=>!n&&!!v&&!!f.current.directChats.length,[n,v,f.current.directChats]);return!f.current.isFetchDone||f.current.directChats.length||f.current.publicGroups.length||(null===(a=f.current)||void 0===a?void 0:a.chatBot)?!n||f.current.directChats.length||f.current.publicGroups.length||(null===(l=f.current)||void 0===l?void 0:l.chatBot)?p.createElement("div",null,!d&&f.current.chatBot?p.createElement(el,{"data-testid":A()("block buddy chatbot")},p.createElement(L,{item:f.current.chatBot,handleResetSearch:t,active:b,setActive:E})):null,p.createElement(s.A,null,x?p.createElement(er,null):null,p.createElement(eo,{data:f.current.directChats,searchValue:n,handleResetSearch:t,loading:!f.current.isFetchDone||d,setActive:E,active:b})),p.createElement(es,{title:r.formatMessage({id:"public_group_chats"}).toUpperCase(),data:f.current.publicGroups,searchValue:n,roomIdActive:e,handleResetSearch:t,loading:!f.current.isFetchDone||d,setActive:E,active:b,defaultOpen:!0})):p.createElement(Y,null,r.formatMessage({id:"no_results_found"})):p.createElement(ee,null,r.formatMessage({id:"no_messages"}))}),ec="BuddyBlock",eu=(0,o.Ay)(s.A,{name:ec,slot:"root",overridesResolver:(e,t)=>[t.root]})(({theme:e})=>({backgroundColor:e.palette.background.paper,width:"100%",height:"100%",display:"flex",flexDirection:"column"})),em=(0,o.Ay)("div",{name:ec,slot:"WrapperHeader",overridesResolver:(e,t)=>[t.wrapperHeader]})(({theme:e})=>({})),ep=(0,o.Ay)("div",{name:ec,slot:"BackAllMessages"})(({theme:e})=>({cursor:"pointer",color:e.palette.primary.main})),eg=(0,o.Ay)("div",{name:ec,slot:"Header",overridesResolver:(e,t)=>[t.header]})(({theme:e})=>({alignItems:"center",boxSizing:"border-box",display:"flex",padding:e.spacing(3,2,1),justifyContent:"space-between"})),eh=(0,o.Ay)("div",{name:ec,slot:"HeaderArchived",overridesResolver:(e,t)=>[t.headerArchived]})(({theme:e})=>({display:"flex",alignItems:"flex-start",justifyContent:"center",flexDirection:"column",boxSizing:"border-box",height:e.spacing(9),padding:e.spacing(1,1,1,2)})),ev=(0,o.Ay)("div")(({theme:e})=>({})),ef=(0,o.Ay)("div")(({theme:e})=>({padding:e.spacing(2,2,1,2)})),ey=(0,o.Ay)(d.A)(({theme:e})=>({padding:e.spacing(0,1),height:"auto",color:"light"===e.palette.mode?e.palette.grey["600"]:e.palette.text.primary,fontSize:e.spacing(2.75),minWidth:"auto","& .ico-circle ":{fontSize:e.spacing(1.75)},"& .ico-gear-o":{fontSize:e.spacing(1.75)},"& .ico-inbox-o":{fontSize:e.spacing(1.75)}})),eb=(0,o.Ay)("span")(({theme:e})=>({display:"inline-flex",textAlign:"center",alignItems:"center",justifyContent:"center"})),eA=(0,o.Ay)("div",{name:ec,slot:"Content",overridesResolver:(e,t)=>[t.content]})(({theme:e})=>({backgroundColor:e.palette.background.paper,padding:e.spacing(1,0),flex:1,minHeight:0})),eE=(0,o.Ay)(r.Gd,{name:"SearchWrapper"})(({theme:e})=>({"& input::placeholder, .ico":{color:e.palette.text.hint}})),ex=(0,i.WvA)({name:"ChatplusBuddyBlock",extendBlock:function(e){var t,n;let{i18n:o,dispatch:s,useActionControl:d,usePageParams:g}=(0,i.PCX)(),h=p.useRef(),{searchText:v}=(0,q.A)(),[f,y]=p.useState(v||""),b=g(),{rid:E}=b,[x,w]=p.useState(!1);p.useEffect(()=>()=>{s({type:"chatplus/spotlight/clearSearching"})},[]),p.useEffect(()=>{y("")},[x]);let[k]=d(null,{}),C=(e,t,n)=>{k(e,t,n),e.includes("archivedChatMode")&&w(!0)},_=(0,a.hB)(),M=[{label:"online",icon:"ico-circle",color:"success",value:"closeMenu, chatplus/setUserStatus:online",testid:"status_online",item_name:"online"},{label:"away",icon:"ico-circle",color:"warning",value:"closeMenu, chatplus/setUserStatus:away",testid:"status_away",item_name:"away"},{label:"busy",icon:"ico-circle",color:"danger",value:"closeMenu, chatplus/setUserStatus:busy",testid:"status_busy",item_name:"busy"},{label:"invisible",icon:"ico-circle",color:"gray",value:"closeMenu, chatplus/setUserStatus:invisible",testid:"status_offline",item_name:"offline"},{as:"divider",testid:"status_divider"},{label:"settings",icon:"ico-gear-o",value:"closeMenu, chatplus/editUserPreferences",testid:"editUserPreferences"},{label:"archived_chats",icon:"ico-inbox-o",value:"closeMenu, chatplus/archivedChatMode",testid:"archivedChatMode"}],O=p.useMemo(()=>M.map(e=>(null==_?void 0:_.status)===e.item_name?{...e,active:!0}:e),[M,_]),P=()=>{s({type:"chatplus/room/newGroup",payload:{}})},I=()=>{s({type:"chatplus/room/newConversationPage",payload:{}})},R=e=>{e&&e.target&&y(e.target.value)},S=()=>{y(""),s({type:"chatplus/spotlight/clearSearching"})};return x?p.createElement(eu,null,p.createElement(em,null,p.createElement(eh,null,p.createElement(ep,{onClick:()=>w(!1)},p.createElement(c.A,{variant:"body2"},o.formatMessage({id:"all_messages"}))),p.createElement(c.A,{component:"h1",variant:"h3"},o.formatMessage({id:"archived_groups"}))),p.createElement(ef,null,p.createElement(eE,{placeholder:o.formatMessage({id:"search_archived_group"}),value:f,onChange:R,endAdornment:f?p.createElement(u.A,{onClick:()=>y("")},p.createElement(r.s4,{icon:"ico-close"})):null}))),p.createElement(eA,null,p.createElement(l.P,{autoHide:!0,autoHeight:!0,autoHeightMax:"100%",ref:h},p.createElement(Q,{searchValue:f})))):p.createElement(eu,{"data-testid":A()("chat room buddy")},p.createElement(em,{"data-testid":A()("block header container")},p.createElement(eg,{"data-testid":A()("chat room header")},p.createElement(c.A,{component:"h1",variant:"h3",color:"textPrimary","data-testid":A()("block header title")},o.formatMessage({id:"messages"})),p.createElement(ev,{"data-testid":A()("block header action")},p.createElement(m.A,{title:null!==(t=o.formatMessage({id:"create_new_group"}))&&void 0!==t?t:"",placement:"top"},p.createElement(ey,{onClick:P,"data-testid":A()("block header action new group")},p.createElement(r.s4,{icon:"ico-user2-three-o"}))),p.createElement(m.A,{title:null!==(n=o.formatMessage({id:"new_conversation"}))&&void 0!==n?n:"",placement:"top"},p.createElement(ey,{onClick:I,"data-testid":A()("block header new conversation")},p.createElement(r.s4,{icon:"ico-compose"}))),p.createElement(ey,{"data-testid":A()("block header more action")},p.createElement(r.pN,{items:O,disablePortal:!0,handleAction:C,control:p.createElement(m.A,{title:o.formatMessage({id:"more"}),placement:"top"},p.createElement(eb,null,p.createElement(r.s4,{icon:"ico-dottedmore-o"})))})))),p.createElement(ef,{"data-testid":A()("chat room search header")},p.createElement(r.Gd,{placeholder:o.formatMessage({id:"search_people_group"}),value:f,onChange:R,endAdornment:f?p.createElement(u.A,{onClick:()=>y("")},p.createElement(r.s4,{icon:"ico-close"})):null}))),p.createElement(eA,{"data-testid":A()("block chat list buddy")},p.createElement(l.P,{autoHide:!0,autoHeight:!0,autoHeightMax:"100%",ref:h},p.createElement(ed,{searchValue:f,rid:E,handleResetSearch:S}))))}}),ew=ex},80962(e,t,n){n.d(t,{A:()=>g});var i=n(40515),a=n(3556),l=n(8051),r=n(63461),o=n(52705),s=n(96540);let d="loading-skeleton",c=(0,a.Ay)(l.A)(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"space-between",height:72,padding:e.spacing(.5,1)})),u=(0,a.Ay)(l.A,{name:d,slot:"BlockCollapse",shouldForwardProp:e=>"title"!==e})(({theme:e,title:t})=>({...t&&{borderTop:e.mixins.border("secondary")}})),m=(0,a.Ay)("div",{name:d,slot:"BlockCollapseHeader"})(({theme:e})=>({padding:e.spacing(2.5,2,2.5,3),display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",cursor:"pointer"})),p=(0,a.Ay)("div",{name:d,slot:"BlockTitle"})(({theme:e})=>({...e.typography.body1,color:e.palette.text.primary,fontWeight:"600"}));function g({title:e}){return s.createElement(u,{title:e},e?s.createElement(m,null,s.createElement(p,null,e),s.createElement(r.A,{size:"small",color:"default"},s.createElement(i.s4,{icon:"ico-angle-up"}))):null,[,,,,].fill(0).map((e,t)=>s.createElement(c,{key:t},s.createElement(i.Qm,null,s.createElement(o.A,{variant:"avatar",width:40,height:40,sx:{mr:1}})),s.createElement(i.p4,null,s.createElement(i.Et,null,s.createElement(o.A,{variant:"text",width:"100%"})),s.createElement(i.Et,null,s.createElement(o.A,{width:120}))))))}},10895(e,t,n){n.d(t,{A:()=>o});var i=n(65121),a=n(91557),l=n(97763),r=n(96540);function o({className:e,value:t,component:n="span",format:o="lll"}){let{moment:s}=(0,a.PCX)();if(!t)return null;let d=s(t),c=d.format("llll"),u=(0,i.rb)(d,o);return r.createElement(l.A,{title:c},r.createElement(n,{role:"link",className:e,"aria-label":c},u))}},89509(e,t,n){n.d(t,{A:()=>v});var i=n(91557),a=n(3556),l=n(96540),r=n(84058),o=n.n(r),s=n(62193),d=n.n(s),c=n(36338),u=n(88485),m=n(35319);let p=(0,a.Ay)("div")(({theme:e})=>({display:"flex",justifyContent:"space-between",marginTop:e.spacing(.25)})),g=(0,a.Ay)("span",{slot:"UnReadDot"})(({theme:e})=>({display:"inline-block",width:12,height:12,backgroundColor:e.palette.primary.main,borderRadius:20,marginTop:e.spacing(.25)})),h=(0,a.Ay)("div",{shouldForwardProp:e=>"unread"!==e})(({theme:e,unread:t})=>({display:"block",color:e.palette.text.secondary,padding:0,minWidth:0,maxWidth:"calc(100% - 12px)",overflow:"hidden",textOverflow:"ellipsis",fontSize:e.spacing(1.625),lineHeight:e.spacing(2.35),whiteSpace:"nowrap",...t&&{fontWeight:e.typography.fontWeightBold},a:{color:e.palette.text.secondary,pointerEvents:"none"},br:{display:"none"}}));function v({room:e,unread:t,subscription:n}){var a,r,s,v,f,y,b,A,E,x,w,k,C,_,M;let O;let{i18n:P}=(0,i.PCX)(),I=(0,u.hB)(),R=null==e?void 0:e.lastMessage;if(!e||(null==e?void 0:e.no_join)||d()(R))return null;let S="",T=(null==R?void 0:R.t)||(null==R?void 0:R.type),B=!1,z=((null==R?void 0:R.owners)||[]).map(e=>e._id).includes(I._id),F=(null==I?void 0:I._id)===(null==R?void 0:null===(a=R.u)||void 0===a?void 0:a._id)?1:0;if(T){let $=R.msg,W=`user_${T}${(null==R?void 0:R.role)?`_${R.role}`:""}`;switch(W=W.replace(/-/g,"_"),"room_changed_privacy"===T&&($="public"===$?"Public":"Private"),!0){case"deleted"===T||"rm"===T:W="message_was_deleted";break;case(0,c.A5)(T):/(invite)_/.test(T)||/(start)_/.test(T)?(W="started_a_call",F||(W="user_started_call")):W=/(miss)_/.test(T)&&!F?"missed_a_call":"call_ended"}S=W?P.formatMessage({id:W},{msg:$,type:T,name:null==R?void 0:null===(r=R.u)||void 0===r?void 0:r.name,role:null==R?void 0:R.role,user:l.createElement("b",null,null==R?void 0:null===(s=R.u)||void 0===s?void 0:s.name),bold:e=>l.createElement("b",null,e),owner:(null==R?void 0:null===(v=R.owners)||void 0===v?void 0:v.length)?l.createElement("b",null,null==R?void 0:R.owners[0].name):"",username:null==R?void 0:null===(f=R.u)||void 0===f?void 0:f.name,isUserToMe:F,isOwnerToMe:z?1:0,remaining:((null==R?void 0:R.total)||1)-1}):""}else if((null==R?void 0:null===(y=R.attachments)||void 0===y?void 0:y.length)>0){if("file"===R.attachments[0].type){let j=R.attachments.filter(e=>e.image_url).length;S=(null===(b=R.attachments[0])||void 0===b?void 0:b.image_url)?P.formatMessage({id:"user_sent_photos"},{isUserToMe:F?1:0,total:j,username:null==R?void 0:null===(x=R.u)||void 0===x?void 0:x.name}):(null===(A=R.attachments[0])||void 0===A?void 0:A.audio_url)?P.formatMessage({id:"user_sent_an_audio_clip"},{isUserToMe:F?1:0,username:null==R?void 0:null===(w=R.u)||void 0===w?void 0:w.name}):(null===(E=R.attachments[0])||void 0===E?void 0:E.video_url)?P.formatMessage({id:"user_sent_a_video"},{isUserToMe:F?1:0,username:null==R?void 0:null===(k=R.u)||void 0===k?void 0:k.name}):P.formatMessage({id:"user_sent_an_attachment"},{isUserToMe:F?1:0,username:null==R?void 0:null===(C=R.u)||void 0===C?void 0:C.name})}else{let{isQuote:D}=(0,m.checkIsQuote)(null==R?void 0:R.attachments);if(D){let L=(0,c.XC)(R);S=L?l.createElement("span",{dangerouslySetInnerHTML:{__html:L}}):""}}}else{let U=(0,c.XC)(R);S=U?l.createElement("span",{dangerouslySetInnerHTML:{__html:U}}):"",B=!0}return d()(S)?null:l.createElement(p,{"data-testid":o()("last message")},l.createElement(h,{unread:t},B?(O=P.formatMessage({id:"user_sent_a_message"},{isUserToMe:F?1:0,username:null==R?void 0:null===(_=R.u)||void 0===_?void 0:_.name,msg:B?S:""}),(T||(null==R?void 0:null===(M=R.attachments)||void 0===M?void 0:M.length)>0)&&(O=""),O):S),(null==n?void 0:n.alert)||(null==n?void 0:n.unread)?l.createElement(g,null):null)}},67912(e,t,n){n.d(t,{A:()=>c});var i=n(97837),a=n(3556),l=n(97763),r=n(96540),o=n(13586);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let d=(0,a.Ay)(({className:e,...t})=>r.createElement(l.A,s({},t,{classes:{popper:e}})))(({theme:e})=>({"& .MuiTooltip-tooltip":{"&.MuiTooltip-tooltipPlacementLeft":{marginRight:`${e.spacing(1)} !important`}}})),c=(0,r.memo)(function({username:e,name:t,size:n="sm",status:a=null,room:l=null,avatarETag:s,hoverCard:c,showTooltip:u=!1}){return r.createElement(d,{title:u&&(t||e),placement:"left",arrow:!1,PopperProps:{popperOptions:{strategy:"fixed"}}},r.createElement("div",null,r.createElement(o.default,{username:e,size:n,name:t,roomType:i.CJ.Direct,status:a,room:l,avatarETag:s,hoverCard:c})))})},17510(e,t,n){n.d(t,{A:()=>k});var i=n(91557),a=n(96540),l=n(3556);let r=(0,l.Ay)("div",{name:"MsgAttachmentAudio",slot:"uiChatAudioCustom",shouldForwardProp:e=>"isPageAllMessages"!==e&&"msgType"!==e&&"isOwner"!==e&&"isOther"!==e})(({theme:e,isPageAllMessages:t,msgType:n,isOwner:i,isOther:a})=>({width:"300px",maxWidth:"100%",...("message_pinned"===n||"message_unpinned"===n||a)&&{width:i?"177px":"137px"},...("message_pinned"===n||"message_unpinned"===n||a)&&t&&{width:"200px"}})),o=a.memo(function({audio_url:e,msgType:t,isOwner:n,isOther:l,audio_duration:o}){let{usePageParams:s,jsxBackend:d}=(0,i.PCX)(),c=s(),u=(null==c?void 0:c.rid)||!1;return a.createElement(r,{isPageAllMessages:u,msgType:t,isOwner:n,isOther:l},d.render({component:"chatplus.ui.messageWaveForm",props:{autoPlay:!1,url:e,isOwner:n,audioDuration:o,isPageAllMessages:u}}))},(e,t)=>(null==e?void 0:e.audio_url)===(null==t?void 0:t.audio_url)),s="MsgAttachmentImage",d=(0,l.Ay)("div",{name:s})(({theme:e})=>({position:"relative",width:"100%"})),c=(0,l.Ay)("figure",{name:s})(({theme:e})=>({margin:0,display:"block"})),u=(0,l.Ay)("div",{name:s,shouldForwardProp:e=>"isOwner"!==e&&"isPageAllMessages"!==e})(({theme:e,isOwner:t,isPageAllMessages:n})=>({width:"100%",minWidth:t?"200px":"180px",maxWidth:"100%",cursor:"pointer",...n&&{width:"300px",[e.breakpoints.down("sm")]:{width:t?"200px":"180px"}}})),m=(0,l.Ay)("img",{name:s})(({theme:e})=>({position:"absolute",left:0,top:0,width:"100%",borderRadius:e.spacing(1),border:e.mixins.border("secondary")}));function p({isOwner:e,title:t,image_url:n,image_dimensions:l,allowOpenPreview:r=!0}){let{chatplus:o,usePageParams:s}=(0,i.PCX)(),p=s(),g=(null==p?void 0:p.rid)||!1,h=!!l&&l.height/l.width,v=a.useCallback(e=>{r&&o.presentImageView(e,{id:"img0",src:o.sanitizeRemoteFileUrl(n)})},[o,n,r]);return a.createElement(d,null,a.createElement(c,null,a.createElement(u,{isOwner:!!e,isPageAllMessages:g,style:{paddingBottom:`${h?100*h:100}%`}},a.createElement(m,{src:`${o.sanitizeRemoteFileUrl(n)}&width=300`,onClick:v,alt:t}))))}let g="MsgAttachmentImage",h=(0,l.Ay)("div",{name:g,slot:"UIMsgAttachmentImgWrapper"})(({theme:e})=>({position:"relative",width:"100%"})),v=(0,l.Ay)("figure",{name:g})(({theme:e})=>({margin:0,display:"block"})),f=(0,l.Ay)("div",{name:g,shouldForwardProp:e=>"isPageAllMessages"!==e})(({theme:e,isPageAllMessages:t})=>({maxWidth:"100%",cursor:"pointer",marginBottom:"1px",width:"100%",height:"100%",...t&&{width:"100%",height:"100%"}})),y=(0,l.Ay)("img",{name:g})(({theme:e})=>({position:"absolute",left:0,top:0,width:"100%",objectFit:"cover",borderRadius:e.spacing(1),border:e.mixins.border("secondary"),height:"100%"}));function b({image_url:e,images:t,keyIndex:n}){let{chatplus:l,usePageParams:r}=(0,i.PCX)(),o=r(),s=(null==o?void 0:o.rid)||!1,d=t&&t.length?t.map((e,t)=>({id:t,src:l.sanitizeRemoteFileUrl(e.image_url)})):[];return a.createElement(h,null,a.createElement(v,null,a.createElement(f,{isPageAllMessages:s,style:{paddingBottom:"100%"}},a.createElement(y,{src:`${l.sanitizeRemoteFileUrl(e)}&width=150`,onClick(t){l.presentImageView(t,{id:parseInt(n),src:l.sanitizeRemoteFileUrl(e)},d)},alt:"MsgAttachmentMultiImage"}))))}var A=n(85376);let E=(0,l.Ay)("figure",{name:"MsgAttachmentVideo"})(({theme:e})=>({margin:0,display:"block"})),x=a.memo(function({video_url:e,video_width:t,video_height:n,thumb_url:l,isOwner:r,allowOpenPreview:o=!0}){let{chatplus:s,usePageParams:d,useIsMobile:c}=(0,i.PCX)(),u=c(),m=`msg-video-${e}`,p=d(),g=(null==p?void 0:p.rid)||!1,h=!u&&g?300:186;return a.createElement(E,null,a.createElement(A.A,{width:h,height:t<=h?"auto":n/(t<=h?h:t/h),src:s.sanitizeRemoteFileUrl(e),idPlaying:m,thumb_url:l,allowOpenPreview:o}))},(e,t)=>(null==e?void 0:e.video_url)===(null==t?void 0:t.video_url)&&(null==e?void 0:e.allowOpenPreview)===(null==t?void 0:t.allowOpenPreview));function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function k({image_url:e,image_dimensions:t,video_url:n,title:l,video_type:r,video_thumb_url:s,audio_url:d,layout:c,totalImages:u,isOwner:m,msgType:g,isOther:h,keyIndex:v,allowOpenPreview:f=!0,audio_duration:y,...A}){let{chatplus:E}=(0,i.PCX)();return d?a.createElement(o,{audio_url:E.sanitizeRemoteFileUrl(d),audio_duration:y,msgType:g,isOwner:m,isOther:h}):n?a.createElement(x,w({isOwner:m,video_url:n,video_type:E.sanitizeRemoteFileUrl(r),thumb_url:E.sanitizeRemoteFileUrl(s),allowOpenPreview:f},A)):e&&"multi-image"===c?a.createElement(b,{title:l,images:u,image_url:e,isOwner:m,msgType:g,isOther:h,keyIndex:v}):e?a.createElement(p,{isOwner:m,title:l,image_dimensions:t,image_url:e,allowOpenPreview:f}):null}},78976(e,t,n){n.d(t,{A:()=>R});var i=n(96540),a=n(88485),l=n(36338),r=n(65121),o=n(91557),s=n(40515),d=n(3556),c=n(8051),u=n(67912),m=n(17510);function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let g="MsgAttachmentMultiMedia",h=(0,d.Ay)("div",{name:g,slot:"uiMsgImageAttachmentWrapper",shouldForwardProp:e=>"isOwner"!==e})(({theme:e,isOwner:t})=>({display:"flex",alignItems:"center",flexWrap:"wrap",justifyContent:t?"flex-end":"flex-start",marginTop:e.spacing(.25),width:"100%",gap:e.spacing(.5)})),v=(0,d.Ay)("div",{name:g,slot:"uiMsgImageAttachmentItem",shouldForwardProp:e=>"isPageAllMessages"!==e&&"isLastItem"!==e&&"isAudio"!==e&&"totalImages"!==e})(({theme:e,isPageAllMessages:t,isLastItem:n,isAudio:i,totalImages:a})=>({flexBasis:`calc(100% / 3 - ${e.spacing(.5)})`,...i&&{width:"185px"},...2===a&&{flexBasis:`calc(100% / 2 - ${e.spacing(.5)})`}}));function f({mediaItems:e,isOwner:t,msgType:n,isOther:a}){let{usePageParams:l}=(0,o.PCX)(),r=l(),s=(null==r?void 0:r.rid)||!1;return i.createElement(h,{isOwner:t},e.map((l,r)=>i.createElement(v,{isPageAllMessages:s,isLastItem:r===e.length-1,isAudio:!!(null==l?void 0:l.audio_url),key:`k${r}`,totalImages:e.length},i.createElement(m.A,p({},l,{layout:"multi-image",keyIndex:r,totalImages:e,isOwner:t,msgType:n,isOther:a})))))}function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let b="MsgAttachment",A=(0,d.Ay)("div",{name:b,slot:"UIMsgAttachment",shouldForwardProp:e=>"isOwner"!==e&&"isAudio"!==e&&"isTypeFile"!==e&&"isOther"!==e&&"totalImage"!==e&&"msgType"!==e})(({theme:e,isOwner:t,isAudio:n,isTypeFile:i,isOther:a,msgType:l,totalImage:r})=>({zIndex:2,maxWidth:"100%",display:"flex",flexDirection:"column",alignItems:"flex-start",paddingBottom:e.spacing(.5),marginTop:e.spacing(.25),overflow:"hidden",...(i||r)&&{width:"100%"},...(n||"message_pinned"===l||"message_unpinned"===l||a)&&{backgroundColor:e.palette.grey["100"],..."dark"===e.palette.mode&&{backgroundColor:e.palette.grey["600"]},padding:e.spacing(.5,.75),borderRadius:e.spacing(1.25),"& a":{color:t?"#fff":e.palette.text.primary,textDecoration:"underline",cursor:"pointer"},...t&&{backgroundColor:e.palette.primary.main,color:"#fff !important"}},...t&&{alignItems:"flex-end"},...n&&{width:"185px",paddingTop:e.spacing(1.5)}})),E=(0,d.Ay)("div",{name:b,slot:"TitleLinkStyled",shouldForwardProp:e=>"isOwner"!==e&&"isVideo"!==e&&"isImage"!==e&&"isAudio"!==e&&"isTypeFile"!==e})(({theme:e,isOwner:t,isVideo:n,isImage:i,isAudio:a,isTypeFile:l})=>({borderRadius:e.spacing(1),fontSize:e.spacing(1.75),padding:e.spacing(1),overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",display:"inline-block",maxWidth:"100%",wordBreak:"break-word",wordWrap:"break-word",backgroundColor:e.palette.grey["100"],..."dark"===e.palette.mode&&{backgroundColor:e.palette.grey["600"]},...t&&{backgroundColor:e.palette.primary.main,color:"#fff"},...(n||i)&&{display:"none"},...a&&{width:"300px"},cursor:"pointer","& .ico":{marginRight:e.spacing(1)}})),x=(0,d.Ay)("div",{name:b,slot:"DescriptionStyled",shouldForwardProp:e=>"isOwner"!==e&&"isVideo"!==e})(({theme:e,isOwner:t,isVideo:n})=>({backgroundColor:e.palette.grey["100"],..."dark"===e.palette.mode&&{backgroundColor:e.palette.grey["600"]},borderRadius:e.spacing(1),fontSize:e.spacing(1.75),padding:e.spacing(1),display:"inline-block",...t&&{backgroundColor:e.palette.primary.main,color:"#fff"}})),w=(0,d.Ay)("div",{name:b,slot:"uiMsgAttachmentAuthor"})(({theme:e})=>({display:"flex",justifyContent:"flex-start",alignItems:"center","& .MuiAvatar-root":{fontSize:`${e.spacing(1)} !important`},strong:{padding:e.spacing(0,.5,0,.25)}})),k=(0,d.Ay)("div",{name:b,slot:"uiMsgAttachmentFlex"})(({theme:e})=>({textAlign:"start"})),C=(0,d.Ay)("div",{name:b,slot:"uiMsgAttachmentText"})(({theme:e})=>({margin:e.spacing(.5,0)})),_=(0,d.Ay)("div",{name:b,slot:"UIMsgAttachmentTextDelete"})(({theme:e})=>({margin:e.spacing(.5),marginLeft:0,fontStyle:"italic"})),M=(0,d.Ay)("div",{name:b,slot:"uiMsgAttachmentInfoWrapper",shouldForwardProp:e=>"msgType"!==e&&"isOther"!==e})(({theme:e,msgType:t,isOther:n})=>({...("message_pinned"===t||"message_unpinned"===t||n)&&{borderLeft:"2px solid #a2a2a2",paddingLeft:e.spacing(1),width:"100%"}})),O=(0,d.Ay)(s.mE,{name:b,slot:"uiMsgAttachmentLink"})(({theme:e})=>({cursor:"pointer","& .ico":{marginRight:e.spacing(1)}}));function P({mentions:e=[],title:t,author_real_name:n,author_name:d,author_id:p,text:g,image_url:h,image_dimensions:v,audio_url:b,audio_duration:P,video_url:I,video_type:R,title_link:S,description:T,video_thumb_url:B,attachments:z,type:F,layout:$,isOwner:W,msgType:j,t:D,video_width:L,video_height:U}){let{chatplus:H,i18n:N}=(0,o.PCX)(),X="file"===F,{count:V,data:Q}=(0,r.Ry)(z),q=(0,a.Fz)(p);return i.createElement(A,{isOwner:W,isAudio:!!b,isTypeFile:!!X,isOther:!b&&!X,msgType:j,totalImage:V},i.createElement(M,{msgType:j,isOther:!b&&!X},d?i.createElement(w,null,i.createElement(u.A,{size:16,name:(null==q?void 0:q.name)||d,username:(null==q?void 0:q.username)||d,avatarETag:null==q?void 0:q.avatarETag}),i.createElement("strong",null,n||d)):null,i.createElement(k,null,"rm"===D?i.createElement(_,null,N.formatMessage({id:"message_was_deleted"})):null,g&&"rm"!==D?i.createElement(C,{dangerouslySetInnerHTML:{__html:(0,l.Ay)(g,{mentions:e})}}):null,z&&z.length?i.createElement(c.A,{mt:1},V>1?i.createElement(f,{mediaItems:Q,isOwner:W,msgType:j,isOther:!b&&!X}):i.createElement(i.Fragment,null,z.map((e,t)=>i.createElement(i.Fragment,{key:`k${t}`},e.video_url||e.image_url||e.audio_url?i.createElement(m.A,y({},e,{key:`k${t}`,msgType:j,isOther:!b&&!X})):i.createElement(i.Fragment,null,e.title_link?i.createElement(O,{lines:1},i.createElement("div",{style:{display:"inline"},onClick:()=>(0,r.NK)(H.sanitizeRemoteFileUrl(e.title_link),!1,!0)},i.createElement(s.s4,{icon:"ico-arrow-down-circle"}),e.title)):null))))):null)),i.createElement(m.A,{image_url:h,video_url:I,audio_url:b,audio_duration:P,title:t,video_type:R,video_thumb_url:B,layout:$,image_dimensions:v,isOwner:W,video_width:L,video_height:U}),S?i.createElement(E,{isOwner:W,isVideo:!!I,isImage:!!h,isAudio:!!b,isTypeFile:!!X},i.createElement(s.mE,{lines:1,onClick:()=>(0,r.NK)(H.sanitizeRemoteFileUrl(S),!1,!0)},i.createElement(s.s4,{icon:"ico-arrow-down-circle"}),t)):null,T?i.createElement(x,{isOwner:W,isVideo:!!I,isImage:!!h,isAudio:!!b,isTypeFile:!!X},T):null)}function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function R({message:e,isOwner:t,msgType:n,dataQuote:a,isQuote:l}){var r;if(!(null===(r=e.attachments)||void 0===r?void 0:r.length))return null;let o=e.attachments;if(l&&a&&(o=o.filter(e=>!e.message_id)),!o&&!o.length)return null;let s=o.filter(e=>e.image_url);return s.length>1?i.createElement(f,{mediaItems:s,isOwner:t}):o.map((e,a)=>i.createElement(P,I({},e,{key:`k${a}`,isOwner:t,msgType:n})))}},35319(e,t,n){n.r(t),n.d(t,{checkIsQuote:()=>F,default:()=>$});var i=n(36338),a=n(3556),l=n(97763),r=n(62193),o=n.n(r),s=n(96540),d=n(78976),c=n(33440),u=n(65121),m=n(91557),p=n(40515),g=n(87773),h=n(8051),v=n(17510),f=n(61341);function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let b="MsgQuote",A=(0,a.Ay)("div",{name:b,slot:"UIMsgAttachment",shouldForwardProp:e=>"isOwner"!==e&&"isAudio"!==e&&"isTypeFile"!==e&&"isOther"!==e&&"msgType"!==e})(({theme:e,isOwner:t,isAudio:n,isTypeFile:i,isOther:a,msgType:l})=>({opacity:"0.8",marginBottom:e.spacing(-2),marginLeft:e.spacing(1),marginRight:0,marginTop:e.spacing(.25),paddingBottom:e.spacing(3),maxWidth:"calc(100% - 8px)",display:"flex",flexDirection:"row",overflow:"hidden",border:e.mixins.border("secondary"),borderRadius:e.spacing(1),minHeight:"70px",cursor:"pointer",...(n||"message_pinned"===l||"message_unpinned"===l||a)&&{"& a":{color:e.palette.text.primary,textDecoration:"underline",cursor:"pointer"},...t&&{color:e.palette.text.secondary,marginRight:e.spacing(1),marginLeft:0}}})),E=(0,a.Ay)("div",{name:b,slot:"uiMsgAttachmentAuthor"})(({theme:e})=>({display:"flex",justifyContent:"flex-start",alignItems:"center","& .MuiAvatar-root":{fontSize:`${e.spacing(1)} !important`}})),x=(0,a.Ay)(g.A)(({theme:e})=>({color:"light"===e.palette.mode?e.palette.grey.A200:e.palette.text.primary})),w=(0,a.Ay)("div",{name:b,slot:"MsgAttachmentFlex",shouldForwardProp:e=>"isAttachment"!==e})(({theme:e,isAttachment:t})=>({textAlign:"start",...t&&{maxWidth:"300px"}})),k=(0,a.Ay)(p.mE,{name:b,slot:"uiMsgAttachmentText"})(({theme:e})=>({color:e.palette.text.secondary})),C=(0,a.Ay)("div",{name:b,slot:"UIMsgAttachmentTextDelete"})(({theme:e})=>({margin:e.spacing(.5),marginLeft:0,fontStyle:"italic"})),_=(0,a.Ay)("div",{name:b,slot:"uiMsgAttachmentInfoWrapper",shouldForwardProp:e=>"msgType"!==e&&"isOther"!==e})(({theme:e,msgType:t,isOther:n})=>({...("message_pinned"===t||"message_unpinned"===t||n)&&{overflow:"hidden",margin:e.spacing(1,1,0,0)}})),M=(0,a.Ay)(p.mE,{name:b,slot:"uiMsgAttachmentLink"})(({theme:e})=>({cursor:"pointer","& .ico":{fontSize:e.mixins.pxToRem(12),marginRight:e.spacing(.5)}})),O=(0,a.Ay)("div")(({theme:e})=>({width:e.spacing(.5),height:"100%",backgroundColor:e.palette.grey["100"]})),P=(0,a.Ay)("div")(({theme:e})=>({width:e.spacing(3),minWidth:e.spacing(3),marginTop:e.spacing(1.5),display:"flex",justifyContent:"center",alignItems:"center"})),I=(0,a.Ay)(p.s4)(({theme:e})=>({marginRight:e.spacing(.5),display:"flex",alignItems:"center"}));function R({dataQuote:e,isOwner:t,rid:n,scrollMessage:a}){let{i18n:l,dispatch:r}=(0,m.PCX)();if(!e)return null;let{mentions:d=[],author_real_name:c,author_name:g,text:b,textRaw:R,audio_url:S,attachments:T,type:B,msgType:z,t:F}=e,$="file"===B,W=R||b,j=W?(0,i.Nj)(W,{mentions:d,onlyShowText:!0}):"",{count:D}=(0,u.Ry)(T),L=()=>{"rm"!==F&&r({type:f.ci,payload:{roomId:n,mid:null==e?void 0:e.message_id,mode:"quote"},meta:{onSuccess:a}})};return s.createElement(A,{isOwner:t,isAudio:!!S,isTypeFile:!!$,isOther:!S&&!$,msgType:z,onClick:L},s.createElement(P,null,s.createElement(O,null)),s.createElement(_,{msgType:z,isOther:!S&&!$},g?s.createElement(E,null,s.createElement(x,{component:"h2",variant:"h5"},c||g)):null,s.createElement(w,{isAttachment:null==T?void 0:T.length},"rm"===F?s.createElement(C,null,l.formatMessage({id:"message_was_deleted"})):null,o()(j)||"rm"===F?null:s.createElement(k,{lines:1,dangerouslySetInnerHTML:{__html:j}}),"rm"!==F&&T&&T.length?s.createElement(h.A,{mt:.5},D>1?s.createElement(k,{lines:1},s.createElement(h.A,{sx:{display:"flex",alignItems:"center"}},s.createElement(I,{icon:"ico-photos-alt-o"}),l.formatMessage({id:"total_photo"},{value:D}))):s.createElement(s.Fragment,null,T.map((e,t)=>s.createElement(s.Fragment,{key:`k${t}`},e.video_url||e.image_url?s.createElement(v.A,y({},e,{key:`k${t}`,msgType:z,isOther:!S&&!$,allowOpenPreview:!1})):e.audio_url?s.createElement(k,{lines:1},(null==e?void 0:e.title)||l.formatMessage({id:"file_attachment"})):s.createElement("div",null,e.title_link?s.createElement(M,{lines:1},s.createElement("div",{style:{display:"inline"}},s.createElement(p.s4,{icon:"ico-paperclip-alt"}),e.title)):null))))):null)))}var S=n(88485);let T="MessageText",B=(0,a.Ay)("div",{name:T,slot:"uiChatMsgItemMsg",shouldForwardProp:e=>"isOwner"!==e&&"isQuote"!==e&&"isMention"!==e&&"activeSearch"!==e&&"isMessageFilter"!==e})(({theme:e,isOwner:t,isQuote:n,isMention:i,activeSearch:a,isMessageFilter:l})=>({zIndex:2,borderRadius:e.spacing(1),fontSize:e.mixins.pxToRem(15),padding:e.spacing(1.25),display:"flex",alignItems:"center","& .mention":{fontWeight:"bold",textDecoration:"none","&:hover":{cursor:"pointer",textDecoration:"underline"}},backgroundColor:e.palette.grey["100"],..."dark"===e.palette.mode&&{backgroundColor:e.palette.grey["600"]},overflowWrap:"break-word",...!i&&{maxWidth:"100%"},"& div:first-of-type":{width:"100%"},"& a":{...!i&&{maxWidth:"100%"},overflowWrap:"break-word",color:e.palette.text.primary,textDecoration:"underline",cursor:"pointer",...i&&{textDecoration:"none","&:hover":{textDecoration:"underline"}}},...t&&!l&&{backgroundColor:e.palette.primary.main,color:"#fff !important","& a":{color:"#fff",textDecoration:"underline"}},...a&&{"& div":{background:"#000",color:"#fff","& a":{color:"#fff"}}}})),z=(0,a.Ay)("div",{name:T,slot:"uiChatMsgItemBodyInnerWrapper",shouldForwardProp:e=>"isOwner"!==e&&"isSearch"!==e&&"isMessageFilter"!==e})(({theme:e,isOwner:t,isSearch:n,isMessageFilter:i})=>({width:"100%",display:"flex",flexDirection:"column",alignItems:"flex-start",...!(n||i)&&t&&{alignItems:"flex-end"}})),F=e=>{var t;let n=e&&e.length&&(null===(t=e[e.length-1])||void 0===t?void 0:t.type)!=="file";if(!n)return{isQuote:n,dataQuote:null};{let i=e.filter(e=>e.message_id);return{isQuote:n,dataQuote:i?i[0]:null}}};function $({message:e,isOwner:t,createdDate:n,tooltipPosition:a,showActiveSearch:r=!0,isMessageFilter:u=!1,scrollMessage:m,isSearch:p=!1}){let[g,h]=s.useState(!1),v=e.msg?(0,i.Ay)(e.msg,{mentions:e.mentions}):null,{isQuote:y,dataQuote:b}=F(null==e?void 0:e.attachments),A=(0,S.nb)(null==e?void 0:e.rid),{msgSearch:E}=A||{},x=s.useMemo(()=>{if(!r||o()(E)||(null==E?void 0:E.mode)===f.Dn)return!1;let t=(null==E?void 0:E.id)===(null==e?void 0:e.id);return(null==E?void 0:E.mQuoteId)===(null==e?void 0:e.id)&&(t=g),t},[r,null==E?void 0:E.mQuoteId,null==E?void 0:E.id,null==E?void 0:E.mode,null==e?void 0:e.id,g]);return s.useEffect(()=>((null==E?void 0:E.mQuoteId)===(null==e?void 0:e.id)&&(h(!0),setTimeout(()=>{h(!1)},f.Uk)),()=>{h(!1)}),[null==e?void 0:e.id,null==E?void 0:E.mQuoteId]),s.createElement(l.A,{title:n,placement:a,PopperProps:{variant:"hidden-partview"}},s.createElement(z,{isOwner:t,isSearch:p,isMessageFilter:u},y?s.createElement(R,{dataQuote:b,isOwner:t,rid:null==e?void 0:e.rid,scrollMessage:m}):null,v?s.createElement(B,{activeSearch:x,isMention:!o()(e.mentions),isQuote:y,isOwner:t,isMessageFilter:u},s.createElement("div",{dangerouslySetInnerHTML:{__html:v}})):null,s.createElement(d.A,{message:e,isOwner:t,isQuote:y,dataQuote:b}),s.createElement(c.A,{message:e})))}},33440(e,t,n){n.d(t,{A:()=>A});var i=n(96540),a=n(65121),l=n(40515),r=n(3556),o=n(62193),s=n.n(o);let d="MsgEmbed",c=(0,r.Ay)("div",{name:d,slot:"uiMsgEmbed"})(({theme:e})=>({marginTop:"4px",marginBottom:"8px",width:"400px",maxWidth:"100%",cursor:"pointer"})),u=(0,r.Ay)("div",{name:d,slot:"uiMsgEmbedOuter"})(({theme:e})=>({display:"flex",flexDirection:"column",borderRadius:"8px",border:e.mixins.border("secondary"),color:"#555555"})),m=(0,r.Ay)("div",{name:d,slot:"ItemMedia"})(({theme:e})=>({width:"100%"})),p=(0,r.Ay)("div",{name:d,slot:"ItemMediaSrc"})(({theme:e})=>({width:"100%",display:"block",position:"relative",backgroundSize:"cover",backgroundPosition:"center center",backgroundRepeat:"no-repeat",backgroundOrigin:"border-box",border:"1px solid rgba(0, 0, 0, 0.1)",borderRadius:"8px 8px 0 0",backgroundColor:"transparent",borderBottom:"1px solid rgba(0, 0, 0, 0.1)","&:before":{content:"''",display:"block",paddingBottom:"56%"}})),g=(0,r.Ay)("div",{name:d,slot:"ItemInner"})(({theme:e})=>({flex:1,minWidth:0,padding:"8px"})),h=(0,r.Ay)(l.mE,{name:d,slot:"ItemTitle"})(({theme:e})=>({marginBottom:"2px",color:"light"===e.palette.mode?e.palette.grey["900"]:e.palette.text.primary})),v=(0,r.Ay)(l.mE,{name:d,slot:"ItemUrl"})(({theme:e})=>({marginBottom:"2px",color:e.palette.text.secondary})),f=(0,r.Ay)(l.mE,{name:d,slot:"ItemDescription"})(({theme:e})=>({color:"light"===e.palette.mode?e.palette.grey["900"]:e.palette.text.primary}));function y({url:e,meta:t,parsedUrl:n,ignoreParse:l}){let r=!l&&(t&&!s()(t)||n&&!s()(n));if(!r)return null;let{ogTitle:o,ogDescription:d,ogImage:y,oembedThumbnailUrl:b,oembedTitle:A,oembedDescription:E}=t,x=n.host,w=o||A,k=d||E;return i.createElement(c,null,i.createElement(u,{onClick:()=>(0,a.NK)(e,!0)},y||b?i.createElement(m,null,i.createElement(p,{style:{backgroundImage:`url(${y||b})`}})):i.createElement(m,null,i.createElement("span",{className:"item-media-src media-default"})),i.createElement(g,null,w?i.createElement(h,{lines:2,variant:"h6"},w):null,i.createElement(v,{lines:2,variant:"body2"},x),k?i.createElement(f,{lines:2,variant:"h6"},k):null)))}function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function A({message:e}){var t;return(null===(t=e.urls)||void 0===t?void 0:t.length)?e.urls.filter(e=>!(null==e?void 0:e.ignoreParse)&&e.meta&&e.parsedUrl).map((e,t)=>i.createElement(y,b({},e,{key:`k${t}`}))):null}},67999(e,t,n){n.d(t,{A:()=>z});var i=n(96540),a=n(3556),l=n(14931),r=n(8051),o=n(97763),s=n(40244),d=n(96327),c=n(8586),u=n(58654),m=n(90590),p=n(64992),g=n(99520),h=n(4634),v=n(91557),f=n(1882),y=n.n(f),b=n(84149);let A="control-video",E=(0,a.Ay)("div",{name:A,slot:"root"})(({theme:e})=>({position:"absolute",bottom:0,right:0,left:0,transition:"all 150ms ease",width:"100%",userSelect:"none"})),x=(0,a.Ay)("div",{name:A,slot:"bottom",shouldForwardProp:e=>"isMinimize"!==e})(({theme:e,isMinimize:t})=>({width:"100%",padding:e.spacing(0,t?1:2),maxHeight:"65%",backgroundImage:"linear-gradient(0deg, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.35) 40%, transparent)",borderRadius:e.shape.borderRadius})),w=(0,s.A)({root:{color:"#fff",width:"10px !important"},thumb:{width:"16px !important",height:"16px !important",boxShadow:"none !important",color:"#fff"},track:{width:"10px !important"},rail:{color:"#fff"}})(l.Ay),k=(0,a.Ay)(r.A,{name:A,slot:"VolumeSliderWrapper",shouldForwardProp:e=>"isHover"!==e&&"isMinimize"!==e})(({theme:e,isHover:t,isMinimize:n})=>({height:70,visibility:"hidden",opacity:0,transition:"all 300ms ease",position:"absolute",bottom:"100%",paddingBottom:e.spacing(2),left:0,...n&&{height:50,paddingBottom:0},...t&&{visibility:"visible",opacity:1}})),C=(0,a.Ay)(r.A,{name:A,slot:"ButtonVolume"})(({theme:e})=>({display:"flex",flexDirection:"column",alignItems:"center",position:"relative",padding:e.spacing(1)})),_=(0,s.A)({root:{padding:0,height:"3px !important",color:"#fff !important",display:"flex",justifyContent:"center",alignItems:"center",flex:1,"& .MuiSlider-thumb:is(:focus, :hover, $active, .Mui-active)":{display:"inline-block !important"}},thumb:{height:"14px !important",width:"14px !important",backgroundColor:"#fff !important",border:"2px solid currentColor",marginTop:0,marginLeft:0,display:"none !important","&:focus, &:hover, &$active":{boxShadow:"inherit !important"}},active:{},valueLabel:{left:"calc(-50% + 4px)"},track:{border:"0 !important",height:"4px !important",borderRadius:4,width:"100%"},rail:{height:"4px !important",borderRadius:4}})(l.Ay),M=(0,a.Ay)("div",{name:A,slot:"slider",shouldForwardProp:e=>"isMinimize"!==e})(({theme:e,isMinimize:t})=>({display:"flex",alignItems:"center",padding:e.spacing(0,2),flex:1,paddingLeft:0,...t&&{paddingRight:e.spacing(.75),paddingLeft:e.spacing(.75)}})),O=(0,a.Ay)("div",{name:A,slot:"ControlBox"})(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"space-between"})),P=(0,a.Ay)("div",{name:A,slot:"InnerControls",shouldForwardProp:e=>!/visible|isMinimize/i.test(e)})(({theme:e,visible:t,isMinimize:n})=>({display:"flex",...!n&&{padding:e.spacing(1.25,0)},alignItems:"center",width:"100%",...!t&&{"& > *":{opacity:0}}})),I=(0,a.Ay)("div",{name:A,slot:"icon-button"})(({theme:e})=>({display:"flex",alignItems:"center",color:"#fff !important",fontSize:e.mixins.pxToRem(15),zIndex:1,"&:hover":{cursor:"pointer"}})),R=(0,a.Ay)(r.A,{name:A,slot:"icon-button"})(({theme:e})=>({padding:e.spacing(1)})),S=(0,a.Ay)("span",{name:A,slot:"TimeSpan"})(({theme:e})=>({color:"#fff",fontSize:e.mixins.pxToRem(12),"& > span":{minWidth:"40px",display:"inline-block","&:nth-of-type(1)":{textAlign:"end"},"&:nth-of-type(2)":{textAlign:"start"}}})),T=(0,a.Ay)(r.A,{name:A,slot:"ProgressWrapper"})(({theme:e})=>({position:"relative",width:"100%",height:"100%",display:"flex",alignItems:"center",flex:1})),B=e=>{var t;let{onPlayPause:n,playing:a,played:l,onSeek:r,onSeekMouseUp:s,onVolumeChangeHandler:f,volume:A,mute:B,onMute:z,formatDuration:F,duration:$,currentTime:W,onMouseSeekDown:j,controlRef:D,loaded:L,onFullScreen:U,showFullScreen:H=!1,isMinimize:N}=e||{},{i18n:X,useIsMobile:V}=(0,v.PCX)(),Q=V(!0),[q,G]=i.useState(!1),[J,K]=i.useState(!0),[Z,Y]=i.useState(""),ee=i.useRef({x:0}),et=i.useRef(null),en=i.useRef(null),ei=()=>{y()(U)&&U()};i.useImperativeHandle(D,()=>({setVisible(e){K(e)},visible:J}));let ea=i.useCallback(e=>{try{let t=e.currentTarget.getBoundingClientRect(),n=e.clientX-e.currentTarget.getBoundingClientRect().left,i=(0,b.f)(Math.max(0,n/t.width*$));Y(i),ee.current={x:e.clientX},null!=et.current&&et.current.update()}catch(a){}},[Y,$]);return i.createElement(E,{ref:D},i.createElement(x,{isMinimize:N},i.createElement(O,null,i.createElement(P,{visible:J,isMinimize:N},i.createElement(I,{onClick:n},1===l?i.createElement(h.A,{fontSize:"medium"}):a?i.createElement(d.A,{fontSize:"medium"}):i.createElement(c.A,{fontSize:"medium"})),i.createElement(M,{isMinimize:N},N?null:i.createElement(S,null,i.createElement("span",null,W)," / ",i.createElement("span",null,F)),i.createElement(T,null,i.createElement(o.A,{title:Z,placement:"top",arrow:!0,PopperProps:{container:null!==(t=document.fullscreenElement)&&void 0!==t?t:document.body,popperRef:et,sx:{pointerEvents:"none",display:J?void 0:"none !important"},anchorEl:{getBoundingClientRect:()=>new DOMRect(ee.current.x,en.current.getBoundingClientRect().y+10,0,0)}}},i.createElement(_,{min:0,max:100,value:100*l,onChange:r,onChangeCommitted:s,onMouseDown:j,onMouseMove:ea,ref:en})),i.createElement(_,{disabled:!0,min:0,max:100,value:100*L,sx:{position:"absolute",top:0,left:0,opacity:.3}}))),N?null:i.createElement(R,null,i.createElement(o.A,{title:X.formatMessage({id:H?"exit_full_screen":"switch_to_full_screen"})},i.createElement(I,{onClick:ei},H?i.createElement(p.A,null):i.createElement(g.A,null)))),i.createElement(C,{sx:{opacity:"1 !important"},onMouseEnter:()=>G(!0),onMouseLeave:()=>G(!1)},Q?null:i.createElement(k,{isHover:q,isMinimize:N},i.createElement(w,{min:0,max:1,step:.1,orientation:"vertical",onChange:f,value:A})),i.createElement(I,{onClick:z},B?i.createElement(u.A,{fontSize:"medium"}):i.createElement(m.A,{fontSize:"medium"})))))))},z=B},27571(e,t,n){n.d(t,{A:()=>c});var i=n(8051),a=n(89481),l=n(3556),r=n(96540);let o="loading-video",s=(0,l.Ay)(i.A,{name:o,slot:"backdrop"})(({theme:e})=>({position:"absolute",left:0,top:0,bottom:0,right:0,zIndex:10})),d=(0,l.Ay)(i.A,{name:o,slot:"conent"})(({theme:e})=>({position:"absolute",left:"50%",top:"50%",marginLeft:-20,marginTop:-20}));function c({size:e=40}){return r.createElement(s,{"data-testid":"loadingIndicator"},r.createElement(d,null,r.createElement(a.A,{color:"primary",size:e})))}},84149(e,t,n){n.d(t,{f:()=>i,h:()=>a});let i=e=>{if(isNaN(e)||0===e)return"00:00";let t=new Date(1e3*e),n=t.getUTCHours(),i=t.getUTCMinutes(),a=t.getUTCSeconds().toString().padStart(2,"0");return n?`${n}:${i.toString().padStart(2,"0")} `:`${i}:${a}`},a=(e,t)=>{let n=e/t;return isNaN(n)||0===n?"56.25%":`${e/t*100}%`}},85376(e,t,n){n.d(t,{A:()=>R});var i=n(91557),a=n(40515),l=n(3556),r=n(8051),o=n(96540),s=n(26287),d=n(47695),c=n(97200),u=n.n(c),m=n(67999),p=n(84149),g=n(27571),h=n(67725);function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}let f=(0,s.Ay)({resolved:{},chunkName:()=>"VideoPlayer",isReady(e){let t=this.resolve(e);return!0===this.resolved[t]&&!!n.m[t]},importAsync:()=>n.e("VideoPlayer").then(n.bind(n,13554)),requireAsync(e){let t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then(e=>(this.resolved[t]=!0,e))},requireSync(e){let t=this.resolve(e);return n(t)},resolve:()=>13554}),y="VideoPlayer",b=(0,l.Ay)(r.A,{name:y,slot:"root"})(({theme:e})=>({width:"100%",height:"100%",display:"flex",alignItems:"center",overflow:"hidden",position:"relative","& .react-player__preview":{position:"relative","&:before":{content:'""',position:"absolute",top:0,bottom:0,left:0,right:0,backgroundColor:"#000",opacity:.4}},"& .ico-play-circle-o":{fontSize:e.mixins.pxToRem(48),color:"#fff",position:"relative"}})),A=(0,l.Ay)("div",{name:y,slot:"playerContainer",shouldForwardProp:e=>!/ratioPercent/i.test(e)})(({theme:e,ratioPercent:t})=>({width:"100%",height:"100%",...t&&{"&:before":{content:'""',paddingTop:null!=t?t:"56.25%",backgroundColor:e.palette.grey.A700,display:"block",width:"100%",borderRadius:e.shape.borderRadius}}})),E=(0,l.Ay)(r.A,{name:y,slot:"playerWrapper"})(({theme:e})=>({width:"100%",height:"100%"})),x=(0,l.Ay)(f,{name:y,slot:"reactPlayer"})(({theme:e})=>({display:"flex",minHeight:"104px",".controls":{width:"10px"},"& video":{maxWidth:"100%",display:"inline-block",borderRadius:e.shape.borderRadius}})),w=(0,l.Ay)("div",{name:y,slot:"ThumbImageWrapper"})(({theme:e})=>({width:"100%",height:"100%",position:"absolute",top:0,zIndex:1,filter:"brightness(0.7)"})),k=(0,l.Ay)(a.s4,{name:y,slot:"CustomPlayButton"})({position:"absolute !important",top:0,bottom:0,left:0,right:0,margin:"auto",width:"fit-content",height:"fit-content",zIndex:2,pointerEvents:"none"}),C=(0,l.Ay)(a._V,{name:y,slot:"imageThumbnail"})(({theme:e})=>({width:"100%",height:"100%","& img":{borderRadius:e.shape.borderRadius}})),_=0,M=e=>Math.min(e/100,.99),O=o.forwardRef((e,t)=>o.createElement(x,v({},e,{ref:t}))),P={},I={};function R(e){var t,n,l,s,c;let{src:v,autoPlay:f=!1,autoplayIntersection:y=!1,idPlaying:x,width:R,height:S,isMinimize:T=!0,currentTime:B,thumb_url:z,allowOpenPreview:F,isDialog:$=!1}=e||{},{dialogBackend:W,useMediaPlaying:j,useSession:D,useIsMobile:L,assetUrl:U,useDialog:H}=(0,i.PCX)(),{dialogProps:N}=H(),X=L(),V=o.useRef(!1),{user:Q}=D(),q=o.useMemo(()=>x||u()("video"),[x]),G=(0,p.h)(S,R),J=(0,h.AE)(z,"500",U("video.no_image")),[K,Z]=j(q),[Y,ee]=o.useState(!1),[et,en]=o.useState(!1),[ei,ea]=(0,d.Wx)({threshold:.5}),[el,er]=o.useState(!0),eo=o.useRef(null),es=o.useRef(null),ed=o.useRef(null),[ec,eu]=o.useState({muted:null===(s=null==I?void 0:I.muted)||void 0===s||s,volume:null!==(c=null==I?void 0:I.volume)&&void 0!==c?c:1,played:0,seeking:!1,buffer:!0,loadedSeconds:0}),em=o.useRef(!1),ep=(0,i.zy2)();o.useLayoutEffect(()=>{f&&er(!0)},[f]),o.useEffect(()=>{eu(e=>({...e,...I}))},[K]),o.useEffect(()=>{if(P[v]||B){var e;null===(e=eo.current)||void 0===e||e.seekTo(P[v]||B,"fraction")}},[null==ep?void 0:ep.pathname,B]),o.useEffect(()=>()=>{P[v]=void 0,Z(!1)},[]);let{muted:eg,volume:eh,played:ev,buffer:ef,loadedSeconds:ey,seeking:eb}=ec||{};o.useEffect(()=>{P[v]=ev},[ev]);let eA=null===(t=eo.current)||void 0===t?void 0:t.getDuration(),eE=eo.current?null===(n=eo.current)||void 0===n?void 0:n.getCurrentTime():0,ex=eo.current?eA:0,ew=null==Q?void 0:null===(l=Q.video_settings)||void 0===l?void 0:l.user_auto_play_videos,ek=ew&&y,eC=e=>{!Y&&(ee(!0),ek||!f||K||Z(!0))},e_=o.useCallback(e=>{Z(!0)},[Z]),eM=o.useCallback(e=>{Z(!1)},[Z]);(0,o.useEffect)(()=>{ek&&Z(ea)},[ea]);let eO=(0,p.f)(eE),eP=(0,p.f)(ex),eI=e=>{F&&(e.stopPropagation(),er(!1),Z(!0))};(0,o.useEffect)(()=>{$&&(er(!1),Z(!0))},[$]);let eR=(e,t=!1)=>{if(e.stopPropagation(),1===ev){var n,i,a,l;null===(n=eo.current)||void 0===n||n.seekTo(0),(null===(i=eo.current)||void 0===i?void 0:i.getInternalPlayer())&&(null===(l=null===(a=eo.current)||void 0===a?void 0:a.getInternalPlayer())||void 0===l||l.play());return}if(K&&!N.open&&!t){W.present({component:"chatplus.dialog.VideoPlayer",props:{src:v,currentTime:ev,thumbUrl:J}});return}Z(!K)},eS=e=>{var t;_>3e3?eU():(null===(t=es.current)||void 0===t?void 0:t.visible)&&(_+=200),eb||eu({...ec,...e})},eT=(e,t)=>{var n;let i=M(t);eu({...ec,played:i}),null===(n=eo.current)||void 0===n||n.seekTo(i,"fraction")},eB=(e,t)=>{var n;em.current&&(Z(!0),em.current=!1);let i=M(t);eu({...ec,seeking:!1}),null===(n=eo.current)||void 0===n||n.seekTo(i,"fraction")},ez=e=>{K&&(em.current=!0),eu({...ec,seeking:!0})},eF=(e,t)=>{e.stopPropagation();let n={muted:0===Number(t),volume:t};I=n,eu(e=>({...e,...n}))},e$=e=>{e.stopPropagation();let t={muted:!ec.muted,volume:0===ec.volume&&ec.muted?1:ec.volume};I=t,eu(e=>({...e,...t}))},eW=()=>{eL(),V.current=!1},ej=e=>{eu({...ec,buffer:!0})},eD=e=>{eu({...ec,buffer:!1})},eL=o.useCallback(()=>{es.current&&(es.current.setVisible(!0),_=0)},[]),eU=()=>{1!==ec.played&&K&&!et&&es.current&&es.current.setVisible(!1)},eH=()=>{var e,t,n,i,a;if(es.current&&ed.current){if(X){let l=null===(e=ed.current)||void 0===e?void 0:e.querySelector("video");if(!l)return;if(l.webkitSupportsFullscreen){l.webkitEnterFullscreen();return}l.requestFullscreen();return}document.fullscreenElement?document.exitFullscreen():(null===(t=ed.current)||void 0===t?void 0:t.requestFullscreen)?null===(i=ed.current)||void 0===i||i.requestFullscreen():(null===(n=ed.current)||void 0===n?void 0:n.webkitRequestFullscreen)&&(null===(a=ed.current)||void 0===a||a.webkitRequestFullscreen())}},[eN,eX]=o.useState(!1);return o.useEffect(()=>{let e=()=>{document.fullscreenElement?eX(!0):eX(!1)};return document.addEventListener("fullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e)}},[]),o.createElement(o.Fragment,null,o.createElement(r.A,{display:el&&z?"inherit":"none !important"},o.createElement(b,{width:`${R}px !important`},o.createElement(A,{ratioPercent:G},o.createElement(w,{onClick:eI},o.createElement(C,{src:J,aspectRatio:"fixed"})),o.createElement(k,{icon:"ico-play-circle-o"})))),o.createElement(b,{display:el&&z?"none !important":"inherit",ref:ei,onMouseLeave:eU,onMouseMove:eL},o.createElement(A,{ref:ed},o.createElement(E,{onClick:eR},ef&&K?o.createElement(g.A,{size:T?26:50}):null,o.createElement(O,{ref:eo,onEnded:eW,onPause:eM,onPlay:e_,onClickPreview:e_,progressInterval:200,url:v,controls:!1,config:{...X&&{file:{attributes:{controlsList:"nofullscreen",disablePictureInPicture:"",playsInline:!0}}}},onReady:eC,className:"player",width:R,height:S,playing:K&&!em.current,volume:eh,muted:eg,playIcon:o.createElement(a.s4,{icon:"ico-play-circle-o"}),onProgress:eS,onBuffer:ej,onBufferEnd:eD})),Y?o.createElement(m.A,{controlRef:es,onPlayPause:e=>eR(e,!0),playing:K,played:ev,loaded:ey/eA,buffer:ef,onSeek:eT,onSeekMouseUp:eB,onMouseSeekDown:ez,volume:eg?0:eh,onVolumeChangeHandler:eF,mute:eg,onMute:e$,duration:ex,formatDuration:eP,currentTime:eO,onFullScreen:eH,showFullScreen:eN,setIsEditControl:en,isMinimize:T}):null)))}},22220(e,t,n){n.d(t,{A:()=>l,h:()=>r});var i=n(71468),a=n(16677);function l(){return(0,i.d4)(e=>(0,a.F6)(e))}function r(){var e;let t=(0,i.d4)(e=>(0,a.M7)(e));return Object.values(t)?null===(e=Object.values(t))||void 0===e?void 0:e.slice(0,4):[]}}}]);