"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-event-blocks-EventBanner-Block"],{59658(e,t,a){a.d(t,{A:()=>o});function o(e){return{}}},67672(e,t,a){a.r(t),a.d(t,{default:()=>m});var o=a(91557),i=a(85191),l=a(84680),r=a(40515),n=a(67725),s=a(8051),d=a(96540),p=a(33357);function c({item:e,blockProps:t,identity:a}){let{assetUrl:i,jsxBackend:c}=(0,o.PCX)(),g=c.get("event.itemView.pendingReviewEventCard");if(!e)return null;let{title:m,image_position:u}=e,v=(0,n.AE)(e.image,"1024",i("event.cover_no_image"));return d.createElement(l.eB,null,d.createElement(l.tD,null,d.createElement(s.A,null,d.createElement(p.A,{identity:a,image:v,alt:m,left:0,top:u||0})),d.createElement(r.mc,{maxWidth:"md",gutter:!0},d.createElement(g,{item:e}))))}c.LoadingSkeleton=()=>null,c.displayName="EventBanner";let g=(0,o.$MH)((0,i.F)(c,i.m)),m=(0,o.WvA)({extendBlock:g,defaults:{placeholder:"Search",blockProps:{variant:"plained",titleComponent:"h2",titleVariant:"subtitle1",titleColor:"textPrimary",noFooter:!0,noHeader:!0,blockStyle:{},contentStyle:{borderRadius:"base",pt:0,pb:0},headerStyle:{},footerStyle:{}}}})},33357(e,t,a){a.d(t,{A:()=>f});var o=a(91557),i=a(40515),l=a(67725),r=a(8051),n=a(60780),s=a(89481),d=a(3556),p=a(20053),c=a(96540),g=a(92440),m=a(54728),u=a(26287);let v=(0,u.Ay)({resolved:{},chunkName:()=>"reactDraggable",isReady(e){let t=this.resolve(e);return!0===this.resolved[t]&&!!a.m[t]},importAsync:()=>a.e("reactDraggable").then(a.t.bind(a,55794,23)),requireAsync(e){let t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then(e=>(this.resolved[t]=!0,e))},requireSync(e){let t=this.resolve(e);return a(t)},resolve:()=>55794}),h=(0,d.Ay)(r.A,{name:"CoverStatic",shouldForwardProp:e=>"position"!==e})(({theme:e,position:t})=>({"& img":{border:"none",height:"100%",objectPosition:"top",...t&&{transform:`translateY(${t})`,height:"auto !important",minHeight:"100%"}}})),b=(0,d.Ay)(n.A,{name:"EditCoverButton"})(({theme:e})=>({textTransform:"capitalize",position:"absolute",top:e.spacing(2),right:e.spacing(2),zIndex:1,"&:hover":{backgroundColor:e.palette.divider}})),y=(0,d.Ay)("div",{name:"ProfileHeaderCoverPhoto",slot:"ImagePositionBox",overridesResolver:(e,t)=>[t.ImagePositionBox]})(({theme:e})=>({overflow:"hidden",position:"relative",borderBottomWidth:"thin",borderBottomStyle:"solid",borderBottomColor:e.palette.border.secondary,zIndex:0}));function f({image:e,identity:t,left:a=0,top:d,alt:u,isUpdateAvatar:f=!1}){let k=(0,m.A)(),{i18n:C,getSetting:E,ItemActionMenu:x,dispatch:_,useIsMobile:F,useCheckFileUpload:A,ParserPreviewPhoto:P}=(0,o.PCX)(),[B,w]=c.useState(!1),I=(0,c.useRef)(),R=F(),S=E("core.file_mime_type_accepts.image")||["image/*"],z=S.join(),[H]=A({accept:z}),M=(0,o.dx2)(t),{can_edit:N}=Object.assign({},null==M?void 0:M.extra),W=c.useRef(),[D,O]=(0,c.useReducer)(g.F,{defaultImage:e,left:a,top:d||0,imgHeight:0,image:e,menuOpen:!1,enable:!0,dragging:!1,position:{x:a,y:d},file:void 0,bounds:{top:0,left:0,right:0,bottom:0}}),$=Boolean(null==M?void 0:M.image),L=(0,c.useCallback)(e=>{if(W.current){let t=W.current.getBoundingClientRect(),a=e.target.height,o=`${null==D?void 0:D.top}`.includes("%")?a*parseFloat(`${null==D?void 0:D.top}`)/100:null==D?void 0:D.top;O({type:"setImgHeight",payload:{wrapHeight:(null==t?void 0:t.height)||0,imgHeight:a,top:o}})}},[null==D?void 0:D.top]),T=(0,c.useCallback)((e,{x:t,y:a})=>{O({type:"dragging",payload:{x:t,y:a}})},[]),j=e=>{e.currentTarget.value=null},U=(0,c.useCallback)(()=>{O({type:"cancel"}),w(!1)},[]);(0,c.useEffect)(()=>{D.dragging||O({type:"defaultImage",payload:{defaultImage:e,position:{x:a,y:d}}})},[e,a,d]);let q=(0,c.useCallback)(()=>{U(),O({type:"loadingParseFile",payload:!1})},[U]),G=(0,c.useCallback)(()=>{w(!0),O({type:"saving"});let e=`${(D.position.y/D.imgHeight*100).toFixed(2)}%`;_({type:"event/updateProfileBanner",payload:{identity:t,position:{y:e},file:D.file,tempFile:D.tempFile},meta:{onSuccess(){O({type:"success",payload:{image:D.image,top:D.position.y.toString()}}),w(!1)},onFailure(){w(!1),O({type:"failed"})}}})},[D]),V=(0,c.useCallback)(()=>{if(!I.current.files.length)return;let e=I.current.files,t=H(e);if(null==t?void 0:t.length){let a=t[0];O({type:"setFile",payload:a})}},[H]),X=(0,c.useCallback)(()=>{setImmediate(()=>{I.current.click()})},[]),Y=(0,c.useCallback)(()=>{_({type:"event/removeBanner",payload:{identity:t},meta:{onSuccess(){O({type:"resetPosition"})},onFailure:()=>O({type:"failed"})}})},[]),J=(0,c.useCallback)(e=>{let{source:t,preUploadFile:a}=e;O({type:"setTempFile",payload:{source:t,tempFile:a}})},[]),K=(0,c.useCallback)(()=>{O({type:"loadingParseFile",payload:!0})},[]),Q=(0,l.Ue)([{icon:"ico-arrows-move",label:C.formatMessage({id:"reposition"}),value:"reposition",testid:"reposition",showWhen:["and",["truthy","hasBanner"],["truthy","can_edit"],["falsy","isMobile"]]},{icon:"ico-photo-up-o",label:C.formatMessage({id:"upload_photo"}),value:"upload_photo",testid:"upload_photo",showWhen:["truthy","can_edit"]},{as:"divider",testid:"divider",showWhen:["and",["truthy","can_edit"],["falsy","isMobile"],["truthy","hasBanner"]]},{icon:"ico-trash-o",label:C.formatMessage({id:"remove"}),value:"remove_photo",testid:"remove_photo",showWhen:["and",["truthy","can_edit"],["truthy","hasBanner"]]}],{can_edit:N,isMobile:R,hasBanner:$}),Z=(e,t,a)=>{switch(e){case"reposition":O({type:"reposition"});break;case"upload_photo":X();break;case"remove_photo":Y()}},ee={source:D.image,file:D.file,type:"photo",item_type:null==M?void 0:M.module_name,file_type:"photo",thumbnail_sizes:null==M?void 0:M.cover_thumbnail_sizes};return c.createElement("div",{className:k.root},c.createElement("input",{type:"file","aria-hidden":!0,className:"srOnly",ref:I,accept:z,onChange:V,onClick:j}),c.createElement(i.mc,{maxWidth:"md",gutter:!0},c.createElement(r.A,{sx:{position:"relative"}},N&&!D.dragging?c.createElement(x,{label:C.formatMessage({id:"edit_cover_photo"}),id:"editCoverPhoto",items:Q,disablePortal:!0,handleAction:Z,control:c.createElement(b,{"aria-label":"Edit cover photo",disableRipple:!0,color:"default",size:"small"},c.createElement(i.s4,{icon:"ico-camera",className:k.iconEditCover}),c.createElement("span",{className:k.textEditCover},C.formatMessage({id:"edit_cover_photo"})))}):null),D.dragging?c.createElement(c.Fragment,null,!B&&!R&&!D.loadingParseFile&&c.createElement("div",{className:k.repositionMessage,draggable:"false"},C.formatMessage({id:"drag_to_reposition_your_cover"})),c.createElement(r.A,{sx:{position:"relative"}},c.createElement("div",{className:k.controlGroup},c.createElement(n.A,{variant:"contained",color:"default",className:(0,p.default)(k.btnControl,k.btnCancel),onClick:U,disabled:B||D.loadingParseFile,size:"small"},C.formatMessage({id:"cancel"})),c.createElement(n.A,{variant:"contained",color:"primary",className:k.btnControl,onClick:G,size:"small",disabled:B||D.loadingParseFile},B?c.createElement(s.A,{color:"inherit",size:"1.5rem"}):C.formatMessage({id:"save"}))))):null),c.createElement(y,null,c.createElement("div",{className:k.bgBlur,style:{backgroundImage:`url(${D.image})`}}),c.createElement(i.mc,{maxWidth:"md",gutter:!f,sx:{height:"100%"}},c.createElement(r.A,{sx:{position:"relative","&:before":{content:'""',display:"block",paddingBottom:"31.25%"}}},c.createElement(r.A,{ref:W,sx:{position:"absolute",left:0,top:0,right:0,bottom:0}},D.dragging?c.createElement(v,{disabled:!D.dragging||B||R||D.loadingParseFile,position:D.position,axis:"y",bounds:D.bounds,onDrag:T},c.createElement("div",{className:(0,p.default)(k.imageDrag,D.dragging&&!R&&k.isReposition)},c.createElement(P,{canParse:!0,item:ee,onParse:J,onStartParseFile:K,onError:q,sx:{height:"100%",paddingBottom:"31.25%"}},c.createElement("img",{src:D.image,alt:u,className:(0,p.default)(k.imageCover,D.dragging&&!R&&k.isReposition),onLoad:L})),c.createElement("div",{className:k.overBg}))):c.createElement(h,{position:d},c.createElement("img",{src:D.image,alt:u,className:(0,p.default)(k.imageCover,D.dragging&&!R&&k.isReposition),onLoad:L})))))))}},92440(e,t,a){a.d(t,{F:()=>i});var o=a(16535);let i=(0,o.Ay)((e,t)=>{var a,o,i,l,r,n;switch(t.type){case"success":e.defaultImage=t.payload.image,e.dragging=!1,e.top=+t.payload.top,e.file=void 0,e.imageDetail=void 0;break;case"defaultImage":e.defaultImage=t.payload.defaultImage,e.image=t.payload.defaultImage,e.position=t.payload.position;break;case"reposition":e.dragging=!0,e.menuOpen=!1;break;case"cancel":e.dragging=!1,e.menuOpen=!1,e.position.x=e.left,e.position.y=e.top,e.image=e.defaultImage,e.file=void 0,e.imageDetail=void 0,e.tempFile=void 0;break;case"dragging":e.position=t.payload;break;case"resetPosition":e.position={x:0,y:0},e.top=0;break;case"setImgHeight":e.imgHeight=null===(a=t.payload)||void 0===a?void 0:a.imgHeight,e.wrapHeight=null===(o=t.payload)||void 0===o?void 0:o.wrapHeight,e.bounds.top=e.wrapHeight-e.imgHeight,e.top=null===(i=t.payload)||void 0===i?void 0:i.top,e.position.y=null===(l=t.payload)||void 0===l?void 0:l.top;break;case"setFile":e.file=t.payload,e.image=URL.createObjectURL(e.file),e.position={x:0,y:0},e.menuOpen=!1,e.dragging=!0;break;case"loadingParseFile":e.loadingParseFile=t.payload;break;case"setTempFile":e.image=null===(r=t.payload)||void 0===r?void 0:r.source,e.tempFile=null===(n=t.payload)||void 0===n?void 0:n.tempFile,e.loadingParseFile=!1;break;case"failed":e.dragging=!1,e.menuOpen=!1,e.position.x=e.left,e.position.y=e.top,e.image=e.defaultImage,e.file=void 0,e.imageDetail=void 0;break;case"saving":e.menuOpen=!1}})},54728(e,t,a){a.d(t,{A:()=>l});var o=a(56525),i=a(85838);let l=(0,o.A)(e=>(0,i.A)({root:{position:"relative",backgroundColor:e.palette.background.paper},imagePositionBox:{height:320,overflow:"hidden",position:"relative",borderBottomWidth:"thin",borderBottomStyle:"solid",borderBottomColor:e.palette.border.secondary,[e.breakpoints.down("sm")]:{height:180}},bgBlur:{backgroundColor:e.palette.background.default,height:320,filter:"blur(60px)",overflow:"hidden",position:"absolute",top:0,bottom:0,left:0,right:0},imageCover:{width:"100%"},editCover:{position:"absolute",top:e.spacing(2),right:e.spacing(2),zIndex:1},imageDrag:{position:"relative",[e.breakpoints.down("sm")]:{textAlign:"center"}},overBg:{backgroundColor:"transparent",top:0,left:0,right:0,bottom:0,position:"absolute"},linkModal:{position:"relative",zIndex:1},btnEditCover:{textTransform:"capitalize"},iconEditCover:{margin:e.spacing(0,.5)},textEditCover:{padding:e.spacing(0,.5),[e.breakpoints.down("sm")]:{display:"none"}},popper:{backgroundColor:e.palette.background.paper,borderRadius:e.shape.borderRadius,width:300,boxShadow:e.shadows[20]},repositionMessage:{position:"absolute",left:"50%",top:160,color:"#fff",transform:"translate(-50%,-50%)",zIndex:1,backgroundColor:"rgba(0,0,0,.4)",borderRadius:e.shape.borderRadius,padding:e.spacing(1),pointerEvents:"none",[e.breakpoints.down("sm")]:{top:90}},controlGroup:{position:"absolute",right:e.spacing(1),top:e.spacing(2),zIndex:2},btnControl:{margin:`${e.spacing(0,.5)} !important`,textTransform:"capitalize"},btnCancel:{"&:hover":{backgroundColor:e.palette.background.paper,color:e.palette.primary.main}},isReposition:{cursor:"move"}}),{name:"MuiUserCoverPhoto"})},85191(e,t,a){a.d(t,{F:()=>o.L2$,m:()=>i.A});var o=a(91557),i=a(59658)}}]);