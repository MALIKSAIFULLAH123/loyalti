"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-story-blocks-ReviewStoryPhoto-Block"],{24099(e,t,o){o.d(t,{A:()=>b});var r=o(98587),n=o(58168),l=o(96540),i=o(89452),a=o(68248),u=o(39599),c=o(73272),s=o(3556),d=o(92353),f=o(74848);let v=["component","direction","spacing","divider","children"],p=e=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[e],h=({ownerState:e,theme:t})=>{let o=(0,n.A)({display:"flex",flexDirection:"column"},(0,i.NI)({theme:t},(0,i.kW)({values:e.direction,breakpoints:t.breakpoints.values}),e=>({flexDirection:e})));if(e.spacing){let r=(0,a.LX)(t),l=Object.keys(t.breakpoints.values).reduce((t,o)=>(("object"==typeof e.spacing&&null!=e.spacing[o]||"object"==typeof e.direction&&null!=e.direction[o])&&(t[o]=!0),t),{}),u=(0,i.kW)({values:e.direction,base:l}),s=(0,i.kW)({values:e.spacing,base:l});"object"==typeof u&&Object.keys(u).forEach((e,t,o)=>{let r=u[e];if(!r){let n=t>0?u[o[t-1]]:"column";u[e]=n}});let d=(t,o)=>({"& > :not(style) + :not(style)":{margin:0,[`margin${p(o?u[o]:e.direction)}`]:(0,a._W)(r,t)}});o=(0,c.A)(o,(0,i.NI)({theme:t},s,d))}return(0,i.iZ)(t.breakpoints,o)},m=(0,s.Ay)("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>[t.root]})(h),g=l.forwardRef(function(e,t){let o=(0,d.A)({props:e,name:"MuiStack"}),i=(0,u.A)(o),{component:a="div",direction:c="column",spacing:s=0,divider:p,children:h}=i,g=(0,r.A)(i,v);return(0,f.jsx)(m,(0,n.A)({as:a,ownerState:{direction:c,spacing:s},ref:t},g,{children:p?function(e,t){let o=l.Children.toArray(e).filter(Boolean);return o.reduce((e,r,n)=>(e.push(r),n<o.length-1&&e.push(l.cloneElement(t,{key:`separator-${n}`})),e),[])}(h,p):h}))}),b=g},60596(e,t,o){o.d(t,{A:()=>M});var r=o(96540),n=o(84535),l=o(2109),i=o(7256),a=o(42421),u=o.n(a),c=o(96435),s=o(48946),d=o(5744),f=o(3556),v=o(8051),p=o(39120),h=o(10454);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e}).apply(this,arguments)}let g={ltr:"ltr",rtl:"rtl",placeholder:"editor-placeholder",paragraph:"editor-paragraph",hashtag:"editor-hashtag"},b="EditorStory",y=(0,f.Ay)(v.A,{name:b,slot:"PlaceHolder"})(({theme:e})=>({position:"absolute",color:e.palette.text.hint,overflow:"hidden",top:0,left:0,bottom:0,display:"flex",alignItems:"center",userSelect:"none",pointerEvents:"none",zIndex:1})),x=(0,f.Ay)(v.A,{name:b,slot:"EditorContainer"})(({theme:e})=>({position:"relative",width:"100%",border:"light"===e.palette.mode?e.mixins.border("secondary"):"solid 1px rgba(73, 73, 73, 0.2)",backgroundColor:e.palette.action.hover,minHeight:e.spacing(4),borderRadius:e.spacing(3),display:"flex",flexFlow:"wrap",transition:"all 200ms ease 0s",overflow:"hidden",[e.breakpoints.down("md")]:{minHeight:e.spacing(5)},padding:"4px 12px","& .editor-input":{width:"100%",outline:"none",position:"relative",zIndex:2,"& p":{margin:0,padding:0},"& .editor-hashtag, & .editor-mention":{color:e.palette.primary.main,".withBackgroundStatus &":{color:"inherit",textDecoration:"underline"}}}})),E=(0,f.Ay)(v.A,{name:b,slot:"EditorCompose"})(({theme:e})=>({position:"relative",width:"100%",display:"flex",alignItems:"center"}));function w(e){let{editorRef:t}=e,o={theme:g,onError(e){throw e},editorState(o){(0,p.le)(o,(null==e?void 0:e.value)||""),t.current.editor=o},...(null==e?void 0:e.initEditorConfig)||{}};return r.createElement(n.LexicalComposer,{initialConfig:o},r.createElement(C,m({},e)))}function C(e){let{onChange:t,value:o,plugins:n,placeholder:a,sx:f,sxInner:v,onFocus:g,onBlur:b,pluginsProps:y,submitting:w}=e,[C,k]=r.useState(!1),_=(0,p.pt)(),R=r.useRef(!1),S=r.useRef(),[M]=(0,d.useLexicalComposerContext)();r.useEffect(()=>{setImmediate(()=>{R.current=!0})},[]),r.useEffect(()=>{M.setEditable(!w)},[w,M]);let P=e=>{t(e)},I=r.useCallback((e,t)=>{e.read(()=>{let e=!(0,p.Un)(t.isComposing(),!0);if(e){var o;P(null===(o=(0,h.$rootTextContent)())||void 0===o?void 0:o.trim())}else P("");k(e)})},[k,P]);r.useEffect(()=>{_?g&&g():b&&b()},[_]),r.useEffect(()=>{R.current&&M.update(()=>{if(_)return;let e=(0,s.$generateHtmlFromNodes)(M,null);e!==o&&(0,p.le)(M,o)})},[o]);let F=()=>{M.focus()};return r.createElement(x,{ref:S,sx:f,onClick:F},r.createElement(E,{sx:v},r.createElement(l.PlainTextPlugin,{contentEditable:r.createElement(i.ContentEditable,{className:"editor-input",spellCheck:!1}),placeholder:r.createElement(A,{placeholder:a}),ErrorBoundary:u()}),r.createElement(c.OnChangePlugin,{onChange:I}),n.map((e,t)=>r.createElement(e,m({key:`plugin${t}`},y)))))}function A({placeholder:e}){return r.createElement(y,{className:"editor-placeholder"},e)}var k=o(53579);function _(){return(_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e}).apply(this,arguments)}function R({handleSubmit:e,isMobile:t}){let[o]=(0,d.useLexicalComposerContext)();return r.useLayoutEffect(()=>o.registerCommand(k.KEY_ENTER_COMMAND,r=>!t&&!!e&&(null!==r&&(r.preventDefault(),r.shiftKey)?o.dispatchCommand(k.INSERT_PARAGRAPH_COMMAND,void 0):(e(),!0)),k.COMMAND_PRIORITY_CRITICAL),[o,e,t]),null}function S({handleCancel:e}){let[t]=(0,d.useLexicalComposerContext)();return r.useLayoutEffect(()=>t.registerCommand(k.KEY_ESCAPE_COMMAND,t=>!!e&&(null!==t&&t.preventDefault(),e(),!0),k.COMMAND_PRIORITY_CRITICAL),[t,e]),null}function M(e){let{pluginsProps:t,initEditorConfig:o={}}=e;return r.createElement(w,_({},e,{initEditorConfig:{...o},pluginsProps:t,plugins:[()=>r.createElement(R,{key:"enter-submit",handleSubmit:e.handleSubmit,isMobile:e.isMobile}),()=>r.createElement(S,{key:"esc",handleCancel:e.handleCancel})]}))}},74257(e,t,o){o.d(t,{A:()=>q,n:()=>j});var r=o(91557),n=o(84680),l=o(3556),i=o(8051),a=o(18799),u=o(96540),c=o(14425),s=o.n(c),d=o(58156),f=o.n(d),v=o(62193),p=o.n(v),h=o(2404),m=o.n(h),g=o(69843),b=o.n(g),y=o(90179),x=o.n(y),E=o(44562),w=o(40515),C=o(85332),A=o(26287),k=o(60710),_=o(67725),R=o(88316),S=o(81925),M=o(5605),P=o(60596),I=o(49913);let F=(0,A.Ay)({resolved:{},chunkName:()=>"reactDraggable",isReady(e){let t=this.resolve(e);return!0===this.resolved[t]&&!!o.m[t]},importAsync:()=>o.e("reactDraggable").then(o.t.bind(o,55794,23)),requireAsync(e){let t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then(e=>(this.resolved[t]=!0,e))},requireSync(e){let t=this.resolve(e);return o(t)},resolve:()=>55794}),N="StoryReview",O=(0,l.Ay)("div",{name:N,slot:"root"})(({theme:e})=>({position:"relative",margin:"auto",height:"100%",borderRadius:e.shape.borderRadius,overflow:"hidden",display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center"})),z=(0,l.Ay)("div",{name:N,slot:"StoryImageContainer",shouldForwardProp:e=>"width"!==e&&"height"!==e&&"init"!==e})(({theme:e,height:t,width:o,init:r})=>({height:"100%",width:o||"390px",position:"relative",overflow:"hidden",border:e.mixins.border("secondary"),borderColor:"#fff",borderRadius:e.shape.borderRadius,...r&&{opacity:.1,borderWidth:0}})),D=(0,l.Ay)("div",{name:N,slot:"StoryImage"})(({theme:e})=>({height:"100%",width:"100%"})),B=(0,l.Ay)("div",{name:N,slot:"BackgroundBlur",shouldForwardProp:e=>"type"!==e})(({theme:e,type:t})=>({filter:"blur(30px)",WebkitFilter:"blur(30px)",overflow:"hidden",padding:e.spacing(1.5),height:"100%",width:"100%",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center",transform:`scale(${"video"===t?4:2})`})),L=(0,l.Ay)("div",{name:N,slot:"EditorBlockStyled"})(({theme:e})=>({position:"absolute",left:0,top:"50px",right:0})),T=(0,l.Ay)("div",{name:N,slot:"InputContent",shouldForwardProp:e=>"fontFamily"!==e&&"fontSize"!==e})(({theme:e,fontFamily:t,fontSize:o})=>({height:"100%",overflow:"hidden",padding:e.spacing(3),position:"absolute",left:0,top:0,right:0,display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",zIndex:1,fontWeight:e.typography.fontWeightRegular,fontSize:o?`${o}px !important`:"22px !important",wordBreak:"break-word",wordWrap:"break-word",color:"#fff","& a":{color:"#fff"},...t&&{fontFamily:t}})),j=(0,l.Ay)("div",{name:N,slot:"TextContent",shouldForwardProp:e=>"fontFamily"!==e&&"position"!==e&&"fontSize"!==e})(({theme:e,fontFamily:t,position:o,fontSize:r})=>({maxHeight:"100%",position:"absolute",left:0,top:0,bottom:0,right:0,textAlign:"center",zIndex:1,fontWeight:e.typography.fontWeightRegular,fontSize:r?`${r}px !important`:"22px !important",wordBreak:"break-word",wordWrap:"break-word",color:"#fff","& a":{color:"#fff"},...t&&{fontFamily:t},width:"fit-content",height:"fit-content",boxSizing:"border-box",border:e.mixins.border("primary"),borderColor:"transparent",cursor:"move",lineHeight:"normal","&:hover":{borderColor:"#fff","& button":{opacity:1}}})),W=(0,l.Ay)(i.A,{name:N})(({theme:e})=>({position:"absolute",top:0,cursor:"move"})),H=(0,l.Ay)("img",{name:"PreviewDv",slot:"Root"})(({theme:e})=>({pointerEvents:"none",objectFit:"contain",maxWidth:"unset"})),$=(0,l.Ay)(w.ND,{name:"PopperWrapper"})(({theme:e})=>({minWidth:"180px",width:"auto",maxHeight:"70vh",maxWidth:300})),V=(0,l.Ay)(a.A,{name:"MuiActionMenu-menu"})(({theme:e})=>({padding:e.spacing(2)}));function q(e){var t,o,l,a,c,d,v;let{i18n:h,eventCenter:g,useTheme:y,dispatch:A}=(0,r.PCX)(),N=y(),[q,U]=u.useState({}),[K,X]=u.useState(),[Y,Z]=u.useState(),[G,J]=u.useState(null),Q=u.useRef(null),[ee,et]=u.useState(""),[eo,er]=u.useState([]),en=u.useRef(),el=u.useRef(),ei=u.useRef(),ea=u.useRef(),eu=u.useRef(),ec=u.useRef(),es=u.useRef(),[ed,ef]=u.useState([]),[ev,ep]=u.useState(!1),[eh,em]=u.useState({width:0,height:0}),[eg,eb]=u.useState(),[ey,ex]=u.useState(!1),[eE,ew]=u.useState(0);R.EW.imageSrc=K;let[eC,eA]=u.useReducer(R.hC,{...R.EW}),[ek,e_,eR]=(0,C.Uf)(ei),eS=null==ei?void 0:null===(t=ei.current)||void 0===t?void 0:t.getBoundingClientRect();u.useEffect(()=>{eR()},[eR,eS]);let{position:eM,rotation:eP,zoom:eI,bound:eF,isDirty:eN}=eC,eO=null===(o=el.current)||void 0===o?void 0:o.getBoundingClientRect(),ez=(null==eO?void 0:eO.height)/E.S1,[eD,eB]=u.useState(""),eL=u.useRef({}),eT=u.useRef();u.useEffect(()=>{if(eu.current&&(eu.current.defaultMuted=!0,ev)){var e;null===(e=eu.current)||void 0===e||e.pause()}},[ev]);let ej=()=>{ex(!0)},eW=()=>{var e,t,o,r,n,l;if(!eu.current&&!ec.current)return;let i=(null===(e=ec.current)||void 0===e?void 0:e.naturalWidth)||(null===(t=eu.current)||void 0===t?void 0:t.videoWidth)||0,a=(null===(o=ec.current)||void 0===o?void 0:o.naturalHeight)||(null===(r=eu.current)||void 0===r?void 0:r.videoHeight)||0,u=i/ek,c={width:parseInt(i/u),height:parseInt(a/u)};"video"===Y&&eu.current&&(null===(n=eT.current)||void 0===n||n.setFieldValue("duration",parseInt(null===(l=eu.current)||void 0===l?void 0:l.duration)));let s={x:0,y:(e_-c.height)/2};eb({width:i,height:a}),em(c),eA({type:"setInitImage",payload:{width:null==c?void 0:c.width,height:null==c?void 0:c.height,widthContainer:ek,heightContainer:e_,position:s}})};u.useEffect(()=>{ek&&ey&&eW()},[ek,ey]);let eH=eo.find(e=>e.id===G),e$=(0,C.Ay)(),{uploading:eV,setInit:eq}=e$||{},eU=u.useCallback(()=>{setImmediate(()=>{var e,t;return null===(e=eL.current)||void 0===e?void 0:null===(t=e.editor)||void 0===t?void 0:t.focus()})},[]);u.useEffect(()=>{eV||b()(K)||eq(!0)},[eV,K]),u.useEffect(()=>{if(!eV&&(null==e$?void 0:e$.filePhoto)){var e,t,o;let r=(null==e$?void 0:null===(e=e$.filePhoto)||void 0===e?void 0:e.temp_file)?null==e$?void 0:null===(t=e$.filePhoto)||void 0===t?void 0:t.url:URL.createObjectURL(e$.filePhoto),n=(0,_.EL)(null===(o=e$.filePhoto)||void 0===o?void 0:o.type)?"video":"photo";Z(n),X(r)}},[null==e$?void 0:e$.filePhoto,eV]),u.useEffect(()=>{if(eV){let e=async()=>{let e=await (0,S.TA)(null==e$?void 0:e$.filePhoto);A({type:r.F7S,payload:{item:{source:e,file:null==e$?void 0:e$.filePhoto,type:"photo",file_type:"photo"}},meta:{onUploadProgress(e){let t=Math.round(100*e.loaded/e.total);t>99||ew(t)},onParseFile(e){let{preUploadFile:t}=e;e$.setFilePhoto(t),e$.setUploading(!1)},onError(){e$.setUploading(!1)}}})};e()}},[null==e$?void 0:e$.filePhoto,eV]);let eK=(e,t=!1)=>{var o;if(p()(e))return{x:0,y:0};let r=null==e?void 0:e.x,n=null==es?void 0:null===(o=es.current)||void 0===o?void 0:o.getBoundingClientRect();t&&(null==es?void 0:es.current)&&(r-=(null==n?void 0:n.width)/2);let l=100*r/ek,i=(null==e?void 0:e.y)*100/e_;return{top:`${parseFloat(null==i?void 0:i.toFixed(2))}%`||0,left:`${parseFloat(null==l?void 0:l.toFixed(2))}%`||0}};u.useEffect(()=>{let e=g.on(E.ck,e=>{let t=f()(e,"form");eT.current=t});if(eT.current){var t,o,r;let n=eo.map(e=>x()({...e,transform:{rotation:0,scale:1,position:eK(null==e?void 0:e.position,null==e?void 0:e.isNew)}},E.cn));null===(t=eT.current)||void 0===t||t.setFieldValue("file",e$.filePhoto),null===(o=eT.current)||void 0===o||o.setFieldValue("type",Y),null===(r=eT.current)||void 0===r||r.setFieldValue("extra",{transform:{position:eK(eM),rotation:eP,scale:(null==eh?void 0:eh.width)*eI/(null==eg?void 0:eg.width)},storyHeight:e_,texts:n,size:{width:null==eg?void 0:eg.width,height:null==eg?void 0:eg.height}})}return()=>g.off(E.ck,e)},[e$.filePhoto,eM,eP,eI,ek,e_,Y,eo,eg]),u.useEffect(()=>{let e=g.on(E.ck,e=>{let t=f()(e,"values"),o=f()(e,"form");ep((null==o?void 0:o.isSubmitting)||!1);let r=f()(e,"schema.elements.content.elements.basic.elements.AddTextStyle.options");if(ef(null!=r?r:[]),!p()(t)){if(!b()(t.add_text)&&!m()(Q.current,t.add_text)){Q.current=t.add_text,J(t.add_text);let n=eo.find(e=>e.id===t.add_text);if(!n){var l,i;let a=null==el?void 0:null===(l=el.current)||void 0===l?void 0:l.getBoundingClientRect(),u=a.width/2,c=[...eo,{id:t.add_text,text:"",visible:!1,fontFamily:(null==r?void 0:null===(i=r[0])||void 0===i?void 0:i.value)||E.fm,fontSize:E.FV,textAlign:"center",color:E.OT,width:"100%",isNew:!0,position:{x:u,y:100},rotation:0,scale:1}];er(c),eU()}}U(t)}});return()=>g.off(E.ck,e)},[eo]);let eX=e=>{et(e.text),er(t=>t.map(t=>(null==t?void 0:t.id)===(null==e?void 0:e.id)?{...t,visible:!1}:t)),J(e.id),eB(s()(e.text))},eY=()=>{J(null),et(""),er(e=>e.filter(e=>e.text).map(e=>{var t;let o=null==es?void 0:null===(t=es.current)||void 0===t?void 0:t.getBoundingClientRect();if(null==e?void 0:e.isNew){let r=e.position.x-(null==o?void 0:o.width)/2;return{...e,position:{x:r,y:100},visible:!0,isNew:!1}}return{...e,visible:!0}})),eB("")},eZ=e=>{eY()},eG=e=>{er(t=>t.map(t=>(null==t?void 0:t.id)===G?{...t,...e}:t)),eU()},eJ=e=>{eB(e),et(e)};if(u.useEffect(()=>{G&&er(e=>e.map(e=>{if((null==e?void 0:e.id)===G){var t;let o=null==es?void 0:null===(t=es.current)||void 0===t?void 0:t.getBoundingClientRect(),r=(null==o?void 0:o.width)?`${o.width/(ek-2)*100}%`:"100%";return{...e,width:r,text:ee,visible:!1}}return e}))},[G,ee,ek,null==eH?void 0:eH.fontSize,null==eH?void 0:eH.fontFamily]),b()(K)&&!eV||p()(q))return null;let eQ=(null==eh?void 0:eh.width)?eh.width*eI:0,e0=(null==eh?void 0:eh.height)?eh.height*eI:0,e1=(e0-eQ)/2,e5=!ek&&!e_;return u.createElement(n.eB,{testid:`preview ${null==q?void 0:q.resource_name}`},u.createElement(R.bQ,null),e5||ev?u.createElement(R.Cj,null):null,eV?u.createElement(R.ZJ,{progressFile:eE}):null,u.createElement(n.Tw,null,u.createElement(n.E9,null,h.formatMessage({id:"preview"}))),u.createElement(n.tD,null,u.createElement(O,null,u.createElement(z,{init:e5,height:e_,width:ek,ref:ei},u.createElement(D,{ref:el,id:E.Yo},"photo"===Y?u.createElement(B,{style:{backgroundImage:`url(${K})`}}):u.createElement(B,{type:Y},u.createElement("video",{src:K,draggable:!1,controls:!1,autoPlay:!1,muted:!0,playsInline:!0,style:{borderRadius:N.shape.borderRadius,width:"100%",height:"100%",border:0}})),u.createElement(F,{bounds:eP%4==0?eF:{top:eF.top-e1,left:eF.left+e1,right:eF.right+e1,bottom:eF.bottom-e1},key:`${K}${eI}${eP}`,position:eM,positionOffset:eP%4==0?void 0:{x:0-e1,y:e1},onDrag(e,t){eA({type:"setDrag",payload:{position:t}})}},u.createElement(W,{sx:{width:eP%4==0?eQ:e0,height:eP%4==0?e0:eQ}},"photo"===Y?u.createElement(H,{key:`${K}${eI}`,src:K,ref:ec,onLoad:ej,style:{transform:S.U[eP],transformOrigin:"0 0",width:eQ,height:e0,position:"absolute",left:0,top:0}}):u.createElement("video",{autoPlay:!ev,loop:!ev,playsInline:!0,src:K,ref:eu,onLoadedMetadata:ej,style:{transform:S.U[eP],transformOrigin:"0 0",width:eQ,height:e0,position:"absolute",left:0,top:0},controls:!1}))),u.createElement(T,{style:{display:G?"inline-block":"none",color:null!==(c=null==eH?void 0:eH.color)&&void 0!==c?c:E.OT},fontFamily:null==eH?void 0:eH.fontFamily,fontSize:(null!==(d=null==eH?void 0:eH.fontSize)&&void 0!==d?d:E.FV)*ez},u.createElement(L,{ref:en},u.createElement(P.A,{onChange:eJ,value:eD,editorRef:eL,placeholder:h.formatMessage({id:"start_typing"}),sx:{border:0,padding:"6px 12px",background:"none",overflow:"visible",minHeight:"32px"},sxInner:{"& .editor-placeholder":{overflow:"inherit",left:0,right:0,justifyContent:"center",color:"#fff"}}}))),ee?u.createElement(F,{bounds:"parent",position:{x:0,y:0}},u.createElement(j,{ref:es,fontFamily:null==eH?void 0:eH.fontFamily,fontSize:(null!==(v=null==eH?void 0:eH.fontSize)&&void 0!==v?v:E.FV)*ez,style:{visibility:"hidden",border:"none"}},u.createElement(i.A,{sx:{whiteSpace:"pre-line"}},ee))):null,(null==eo?void 0:eo.length)?u.createElement(u.Fragment,null,eo.filter(e=>e.visible).map(e=>u.createElement(I.A,{key:null==e?void 0:e.id,item:e,setListText:er,widthContainer:ek,heightContainer:e_,ratio:ez,onSelectItemText:eX}))):null,G?u.createElement(w.qB,{excludeRef:en,onClickAway:eZ,mouseEvent:"onMouseUp"},u.createElement($,{id:"menu-text-item","data-testid":"menu-text-item",open:Boolean(G),anchorEl:el.current,placement:"right"},u.createElement(V,{ref:ea},u.createElement(k.A,{optionFontStyle:ed,item:eH,updateItem:eG})))):null),!(null===(l=eT.current)||void 0===l?void 0:null===(a=l.errors)||void 0===a?void 0:a.expand_link)&&(null==q?void 0:q.expand_link)&&u.createElement(M.A,{link:null==q?void 0:q.expand_link})),u.createElement(R.q2,{open:eN,fire:eA,state:eC}))))}},53955(e,t,o){o.r(t),o.d(t,{default:()=>l});var r=o(91557),n=o(74257);let l=(0,r.WvA)({name:"StoryReview",extendBlock:n.A,defaults:{blockLayout:"Review Story"}})},60710(e,t,o){o.d(t,{A:()=>w});var r=o(91557),n=o(3556),l=o(8051),i=o(54358),a=o(63009),u=o(84058),c=o.n(u),s=o(96540),d=o(64596);let f=(0,n.Ay)(l.A,{name:"MuiButton",slot:"ColorPickerAdornment"})(({color:e})=>({width:28,height:28,border:"1px solid rgba(0,0,0,0.1)",backgroundColor:e,cursor:"pointer"})),v=e=>{var t,o,n;let{i18n:l}=(0,r.PCX)(),[u,v]=s.useState(!1),p=s.useRef(),{defaultValue:h="#fff",picker:m="chrome",item:g,updateItem:b}=e,y=e=>{},x=e=>{b&&b({color:e})};return s.createElement(s.Fragment,null,s.createElement(i.A,{ref:p,value:null!==(t=null==g?void 0:g.color)&&void 0!==t?t:h,onChange:e=>x(e.currentTarget.value),size:"medium",onBlur:y,onClick:()=>v(!0),InputProps:{readOnly:!0,endAdornment:s.createElement(f,{color:null!==(o=null==g?void 0:g.color)&&void 0!==o?o:h,onClick:()=>v(!0)})},inputProps:{"data-testid":c()("input color-picker")},label:l.formatMessage({id:"color"}),placeholder:l.formatMessage({id:"select_color"}),sx:{width:"100%"}}),s.createElement(a.Ay,{disablePortal:!1,open:u,anchorEl:p.current,onClose:()=>v(!1),style:{zIndex:9999},anchorOrigin:{vertical:"bottom"}},s.createElement(d.A,{color:null!==(n=null==g?void 0:g.color)&&void 0!==n?n:h,onChange:x,picker:m})))};var p=o(97763),h=o(87773),m=o(24099),g=o(14931),b=o(50203),y=o(57660);let x=(0,n.Ay)(l.A)(({theme:e})=>({}));function E(e){let{children:t,value:o}=e;return s.createElement(p.A,{enterTouchDelay:0,placement:"top",title:o},t)}let w=function({optionFontStyle:e,item:t,updateItem:o}){var n;let{i18n:i}=(0,r.PCX)();if(!t)return null;let a=()=>{},u=e=>{o&&o({fontFamily:e.target.value})},c=e=>{o&&o({fontSize:e.target.value})};return s.createElement(x,null,s.createElement(l.A,null,s.createElement(h.A,{gutterBottom:!0},i.formatMessage({id:"text_size"})),s.createElement(m.A,{spacing:1.5,direction:"row",sx:{mb:1},alignItems:"center"},s.createElement(g.Ay,{valueLabelDisplay:"auto",slots:{valueLabel:E},"aria-label":"custom thumb label",defaultValue:12,value:null==t?void 0:t.fontSize,onChange:c,min:12,max:80}),s.createElement("span",null,null==t?void 0:t.fontSize))),e?s.createElement(b.A,{onBlur:a,value:null==t?void 0:t.fontFamily,displayEmpty:!0,defaultValue:null===(n=e[0])||void 0===n?void 0:n.value,onChange:u,id:"select-font-style",inputProps:{size:"medium",fullWidth:1},"data-testid":"select-font-style",sx:{width:"100%",mb:2}},e.map((e,t)=>s.createElement(y.A,{value:e.value,key:t},e.label))):null,s.createElement(v,{defaultValue:t.color,item:t,updateItem:o}))}},49913(e,t,o){o.d(t,{A:()=>p});var r=o(96540),n=o(26287),l=o(40515),i=o(91557),a=o(74257),u=o(44562),c=o(3556),s=o(63461),d=o(8051);let f=(0,n.Ay)({resolved:{},chunkName:()=>"reactDraggable",isReady(e){let t=this.resolve(e);return!0===this.resolved[t]&&!!o.m[t]},importAsync:()=>o.e("reactDraggable").then(o.t.bind(o,55794,23)),requireAsync(e){let t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then(e=>(this.resolved[t]=!0,e))},requireSync(e){let t=this.resolve(e);return o(t)},resolve:()=>55794}),v=(0,c.Ay)(s.A,{name:"TextItemDraggable"})(({theme:e})=>({position:"absolute",top:"-12px",left:"-12px",opacity:0,background:e.palette.background.paper,..."dark"===e.palette.mode&&{color:"#fff"},fontSize:e.mixins.pxToRem(12),width:"24px",height:"24px","&:hover":{opacity:"0.7 !important",background:e.palette.background.paper}})),p=function({item:e,setListText:t,widthContainer:o,heightContainer:n,ratio:c,onSelectItemText:s}){var p,h;let{i18n:m}=(0,i.PCX)(),g=r.useRef(),b=r.useRef(),[y,x]=r.useState(!1),E=r.useCallback(()=>x(!1),[]),w=r.useCallback(()=>x(!0),[]),C=r.useMemo(()=>{var e;let t=null===(e=b.current)||void 0===e?void 0:e.getBoundingClientRect(),r=null==t?void 0:t.width,l=null==t?void 0:t.height;return r||l?{top:0,left:0,right:o-(r+2||0),bottom:n-(l+2||0)}:"parent"},[o,n,b]),A=e=>{t(t=>t.filter(t=>t.id!==e.id))},k=(e,{x:o,y:r},n)=>{n&&t(e=>e.map(e=>(null==e?void 0:e.id)===(null==n?void 0:n.id)?{...e,position:{x:o,y:r}}:e))},_=e=>{s(e)};return r.createElement(f,{ref:b,disabled:y,bounds:C,key:e.id,position:null==e?void 0:e.position,onStop(t,o){k(t,o,e),g.current&&_(e)},onDrag(){g.current&&(g.current=!1)},onMouseDown(){g.current=!0}},r.createElement(a.n,{fontFamily:null==e?void 0:e.fontFamily,style:{color:null!==(p=null==e?void 0:e.color)&&void 0!==p?p:u.OT},fontSize:(null!==(h=null==e?void 0:e.fontSize)&&void 0!==h?h:u.FV)*c},r.createElement(d.A,{sx:{whiteSpace:"pre-line"}},(null==e?void 0:e.text)||m.formatMessage({id:"start_typing"})),r.createElement(v,{onMouseLeave:E,onMouseEnter:w,onClick(){A(e),E()}},r.createElement(l.s4,{icon:"ico-close"}))))}},64596(e,t,o){o.d(t,{A:()=>d});var r=o(3556),n=o(8051),l=o(771),i=o(96540),a=o(7612);let u=(0,r.Ay)(n.A,{name:"MuiButton",slot:"ColorPickerAdornment"})(({theme:e,color:t})=>({width:26,height:26,border:"1px solid rgba(0,0,0,0.1)",borderRadius:e.shape.borderRadius,backgroundColor:t,cursor:"pointer",margin:e.spacing(.4)})),c=(0,r.Ay)(n.A)(({theme:e})=>({display:"flex",flexWrap:"wrap",marginTop:e.spacing(2)})),s=["#fff","#000","#2a86ae","#702928","#f6724a","#f1c43a","#8e939c","#89be4c","#2b457c","#f83d3c","#dcd3ef","#fb3ea0"],d=function({color:e="#000",onChange:t}){try{e=/#/i.test(e)?e:(0,l.Ob)(e)}catch(o){}let[r,d]=i.useState(e);return i.useEffect(()=>{try{(0,l.E2)(r),t(r)}catch(e){}},[r]),i.createElement(n.A,{sx:{p:2,maxWidth:"230px"}},i.createElement(a.jI,{color:r,onChange:d,style:{height:"150px"}}),i.createElement(c,null,s.map(e=>i.createElement(u,{key:e,color:null!=e?e:r,onClick:()=>d(e)}))))}},5605(e,t,o){o.d(t,{A:()=>c});var r=o(91557),n=o(3556),l=o(96540),i=o(91262);let a=(0,n.Ay)(r.vxq,{name:"seeMoreLinkStory",slot:"SeeMoreLink",shouldForwardProp:e=>"isPreview"!==e})(({theme:e,isPreview:t})=>({...t&&{position:"absolute",left:"50%",bottom:16,transform:"translate(-50%, 0)"},color:"#fff",borderColor:"#fff",borderRadius:e.spacing(3),zIndex:3})),u=({link:e,sx:t,variant:o="outlined",fire:n,isPreview:u=!0})=>{let{i18n:c}=(0,r.PCX)();if(!e)return;let s=()=>{n&&n({type:"setForcePause",payload:i.ZR.No})},d=()=>{n&&n({type:"setForcePause",payload:i.ZR.Pause})};return l.createElement(a,{isPreview:u,to:e,variant:o,sx:t,onClick:d,onCancel:s},c.formatMessage({id:"visit_link"}))},c=u},7612(e,t,o){o.d(t,{dp:()=>q,jI:()=>W});var r=o(96540);function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e}).apply(this,arguments)}function l(e,t){if(null==e)return{};var o,r,n={},l=Object.keys(e);for(r=0;r<l.length;r++)t.indexOf(o=l[r])>=0||(n[o]=e[o]);return n}function i(e){var t=(0,r.useRef)(e),o=(0,r.useRef)(function(e){t.current&&t.current(e)});return t.current=e,o.current}var a=function(e,t,o){return void 0===t&&(t=0),void 0===o&&(o=1),e>o?o:e<t?t:e},u=function(e){return"touches"in e},c=function(e){return e&&e.ownerDocument.defaultView||self},s=function(e,t,o){var r=e.getBoundingClientRect(),n=u(t)?function(e,t){for(var o=0;o<e.length;o++)if(e[o].identifier===t)return e[o];return e[0]}(t.touches,o):t;return{left:a((n.pageX-(r.left+c(e).pageXOffset))/r.width),top:a((n.pageY-(r.top+c(e).pageYOffset))/r.height)}},d=function(e){u(e)||e.preventDefault()},f=r.memo(function(e){var t=e.onMove,o=e.onKey,a=l(e,["onMove","onKey"]),f=(0,r.useRef)(null),v=i(t),p=i(o),h=(0,r.useRef)(null),m=(0,r.useRef)(!1),g=(0,r.useMemo)(function(){var e=function(e){d(e),(u(e)?e.touches.length>0:e.buttons>0)&&f.current?v(s(f.current,e,h.current)):o(!1)},t=function(){return o(!1)};function o(o){var r=m.current,n=c(f.current),l=o?n.addEventListener:n.removeEventListener;l(r?"touchmove":"mousemove",e),l(r?"touchend":"mouseup",t)}return[function(e){var t=e.nativeEvent,r=f.current;if(r&&(d(t),(!m.current||u(t))&&r)){if(u(t)){m.current=!0;var n=t.changedTouches||[];n.length&&(h.current=n[0].identifier)}r.focus(),v(s(r,t,h.current)),o(!0)}},function(e){var t=e.which||e.keyCode;t<37||t>40||(e.preventDefault(),p({left:39===t?.05:37===t?-.05:0,top:40===t?.05:38===t?-.05:0}))},o]},[p,v]),b=g[0],y=g[1],x=g[2];return(0,r.useEffect)(function(){return x},[x]),r.createElement("div",n({},a,{onTouchStart:b,onMouseDown:b,className:"react-colorful__interactive",ref:f,onKeyDown:y,tabIndex:0,role:"slider"}))}),v=function(e){return e.filter(Boolean).join(" ")},p=function(e){var t=e.color,o=e.left,n=e.top,l=v(["react-colorful__pointer",e.className]);return r.createElement("div",{className:l,style:{top:100*(void 0===n?.5:n)+"%",left:100*o+"%"}},r.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:t}}))},h=function(e,t,o){return void 0===t&&(t=0),void 0===o&&(o=Math.pow(10,t)),Math.round(o*e)/o},m={grad:.9,turn:360,rad:360/(2*Math.PI)},g=function(e){return S(b(e))},b=function(e){return"#"===e[0]&&(e=e.substring(1)),e.length<6?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?h(parseInt(e[3]+e[3],16)/255,2):1}:{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4,6),16),a:8===e.length?h(parseInt(e.substring(6,8),16)/255,2):1}},y=function(e,t){return void 0===t&&(t="deg"),Number(e)*(m[t]||1)},x=function(e){var t=e.s,o=e.l;return{h:e.h,s:(t*=(o<50?o:100-o)/100)>0?2*t/(o+t)*100:0,v:o+t,a:e.a}},E=function(e){return R(k(e))},w=function(e){var t=e.s,o=e.v,r=e.a,n=(200-t)*o/100;return{h:h(e.h),s:h(n>0&&n<200?t*o/100/(n<=100?n:200-n)*100:0),l:h(n/2),a:h(r,2)}},C=function(e){var t=w(e);return"hsl("+t.h+", "+t.s+"%, "+t.l+"%)"},A=function(e){var t=w(e);return"hsla("+t.h+", "+t.s+"%, "+t.l+"%, "+t.a+")"},k=function(e){var t=e.h,o=e.s,r=e.v,n=e.a;t=t/360*6,o/=100,r/=100;var l=Math.floor(t),i=r*(1-o),a=r*(1-(t-l)*o),u=r*(1-(1-t+l)*o),c=l%6;return{r:h(255*[r,a,i,i,u,r][c]),g:h(255*[u,r,r,a,i,i][c]),b:h(255*[i,i,u,r,r,a][c]),a:h(n,2)}},_=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},R=function(e){var t=e.r,o=e.g,r=e.b,n=e.a,l=n<1?_(h(255*n)):"";return"#"+_(t)+_(o)+_(r)+l},S=function(e){var t=e.r,o=e.g,r=e.b,n=e.a,l=Math.max(t,o,r),i=l-Math.min(t,o,r),a=i?l===t?(o-r)/i:l===o?2+(r-t)/i:4+(t-o)/i:0;return{h:h(60*(a<0?a+6:a)),s:h(l?i/l*100:0),v:h(l/255*100),a:n}},M=function(e){return{h:h(e.h),s:h(e.s),v:h(e.v),a:h(e.a,2)}},P=r.memo(function(e){var t=e.hue,o=e.onChange,n=v(["react-colorful__hue",e.className]);return r.createElement("div",{className:n},r.createElement(f,{onMove:function(e){o({h:360*e.left})},onKey:function(e){o({h:a(t+360*e.left,0,360)})},"aria-label":"Hue","aria-valuenow":h(t),"aria-valuemax":"360","aria-valuemin":"0"},r.createElement(p,{className:"react-colorful__hue-pointer",left:t/360,color:C({h:t,s:100,v:100,a:1})})))}),I=r.memo(function(e){var t=e.hsva,o=e.onChange,n={backgroundColor:C({h:t.h,s:100,v:100,a:1})};return r.createElement("div",{className:"react-colorful__saturation",style:n},r.createElement(f,{onMove:function(e){o({s:100*e.left,v:100-100*e.top})},onKey:function(e){o({s:a(t.s+100*e.left,0,100),v:a(t.v-100*e.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+h(t.s)+"%, Brightness "+h(t.v)+"%"},r.createElement(p,{className:"react-colorful__saturation-pointer",top:1-t.v/100,left:t.s/100,color:C(t)})))}),F=function(e,t){if(e===t)return!0;for(var o in e)if(e[o]!==t[o])return!1;return!0},N=function(e,t){return e.toLowerCase()===t.toLowerCase()||F(b(e),b(t))};function O(e,t,o){var n=i(o),l=(0,r.useState)(function(){return e.toHsva(t)}),a=l[0],u=l[1],c=(0,r.useRef)({color:t,hsva:a});return(0,r.useEffect)(function(){if(!e.equal(t,c.current.color)){var o=e.toHsva(t);c.current={hsva:o,color:t},u(o)}},[t,e]),(0,r.useEffect)(function(){var t;F(a,c.current.hsva)||e.equal(t=e.fromHsva(a),c.current.color)||(c.current={hsva:a,color:t},n(t))},[a,e,n]),[a,(0,r.useCallback)(function(e){u(function(t){return Object.assign({},t,e)})},[])]}var z,D="undefined"!=typeof window?r.useLayoutEffect:r.useEffect,B=new Map,L=function(e){D(function(){var t=e.current?e.current.ownerDocument:document;if(void 0!==t&&!B.has(t)){var r=t.createElement("style");r.innerHTML='.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>\')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}',B.set(t,r);var n=z||o.nc;n&&r.setAttribute("nonce",n),t.head.appendChild(r)}},[])},T=function(e){var t=e.className,o=e.colorModel,i=e.color,a=void 0===i?o.defaultColor:i,u=e.onChange,c=l(e,["className","colorModel","color","onChange"]),s=(0,r.useRef)(null);L(s);var d=O(o,a,u),f=d[0],p=d[1],h=v(["react-colorful",t]);return r.createElement("div",n({},c,{ref:s,className:h}),r.createElement(I,{hsva:f,onChange:p}),r.createElement(P,{hue:f.h,onChange:p,className:"react-colorful__last-control"}))},j={defaultColor:"000",toHsva:g,fromHsva:function(e){return E({h:e.h,s:e.s,v:e.v,a:1})},equal:N},W=function(e){return r.createElement(T,n({},e,{colorModel:j}))},H=function(e){var t=e.className,o=e.hsva,n=e.onChange,l={backgroundImage:"linear-gradient(90deg, "+A(Object.assign({},o,{a:0}))+", "+A(Object.assign({},o,{a:1}))+")"},i=v(["react-colorful__alpha",t]),u=h(100*o.a);return r.createElement("div",{className:i},r.createElement("div",{className:"react-colorful__alpha-gradient",style:l}),r.createElement(f,{onMove:function(e){n({a:e.left})},onKey:function(e){n({a:a(o.a+e.left)})},"aria-label":"Alpha","aria-valuetext":u+"%","aria-valuenow":u,"aria-valuemin":"0","aria-valuemax":"100"},r.createElement(p,{className:"react-colorful__alpha-pointer",left:o.a,color:A(o)})))},$=function(e){var t=e.className,o=e.colorModel,i=e.color,a=void 0===i?o.defaultColor:i,u=e.onChange,c=l(e,["className","colorModel","color","onChange"]),s=(0,r.useRef)(null);L(s);var d=O(o,a,u),f=d[0],p=d[1],h=v(["react-colorful",t]);return r.createElement("div",n({},c,{ref:s,className:h}),r.createElement(I,{hsva:f,onChange:p}),r.createElement(P,{hue:f.h,onChange:p}),r.createElement(H,{hsva:f,onChange:p,className:"react-colorful__last-control"}))},V={defaultColor:"0001",toHsva:g,fromHsva:E,equal:N},q=function(e){return r.createElement($,n({},e,{colorModel:V}))}}}]);