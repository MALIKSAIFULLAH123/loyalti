(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-chatplus-components-CallApp-CallView-Block","metafox-chatplus-components-Avatar"],{72761(e,t,r){"use strict";r.d(t,{A:()=>S});var n=r(98587),i=r(58168),o=r(96540),a=r(20053),s=r(5004),l=r(75659),c=r(38413),d=r(31609);function u(e){return(0,d.A)("MuiBadge",e)}(0,c.A)("MuiBadge",["root","badge","invisible"]);var h=r(99977),p=r(74848);let g=["badgeContent","component","children","invisible","max","slotProps","slots","showZero"],f=e=>{let{invisible:t}=e;return(0,l.A)({root:["root"],badge:["badge",t&&"invisible"]},u,void 0)},m=o.forwardRef(function(e,t){let{component:r,children:o,max:a=99,slotProps:l={},slots:c={},showZero:d=!1}=e,u=(0,n.A)(e,g),{badgeContent:m,max:v,displayValue:b,invisible:y}=function(e){let{badgeContent:t,invisible:r=!1,max:n=99,showZero:i=!1}=e,o=(0,s.A)({badgeContent:t,max:n}),a=r;!1!==r||0!==t||i||(a=!0);let{badgeContent:l,max:c=n}=a?o:e,d=l&&Number(l)>c?`${c}+`:l;return{badgeContent:l,invisible:a,max:c,displayValue:d}}((0,i.A)({},e,{max:a})),_=(0,i.A)({},e,{badgeContent:m,invisible:y,max:v,showZero:d}),w=f(_),O=r||c.root||"span",C=(0,h.A)({elementType:O,externalSlotProps:l.root,externalForwardedProps:u,additionalProps:{ref:t},ownerState:_,className:w.root}),x=c.badge||"span",E=(0,h.A)({elementType:x,externalSlotProps:l.badge,ownerState:_,className:w.badge});return(0,p.jsxs)(O,(0,i.A)({},C,{children:[o,(0,p.jsx)(x,(0,i.A)({},E,{children:b}))]}))});var v=r(3556),b=r(92353),y=r(87447),_=r(75630);function w(e){return(0,d.A)("MuiBadge",e)}let O=(0,c.A)("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),C=["anchorOrigin","className","component","components","componentsProps","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],x=e=>{let{color:t,anchorOrigin:r,invisible:n,overlap:i,variant:o,classes:a={}}=e,s={root:["root"],badge:["badge",o,n&&"invisible",`anchorOrigin${(0,_.A)(r.vertical)}${(0,_.A)(r.horizontal)}`,`anchorOrigin${(0,_.A)(r.vertical)}${(0,_.A)(r.horizontal)}${(0,_.A)(i)}`,`overlap${(0,_.A)(i)}`,"default"!==t&&`color${(0,_.A)(t)}`]};return(0,l.A)(s,w,a)},E=(0,v.Ay)("span",{name:"MuiBadge",slot:"Root",overridesResolver:(e,t)=>t.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),L=(0,v.Ay)("span",{name:"MuiBadge",slot:"Badge",overridesResolver(e,t){let{ownerState:r}=e;return[t.badge,t[r.variant],t[`anchorOrigin${(0,_.A)(r.anchorOrigin.vertical)}${(0,_.A)(r.anchorOrigin.horizontal)}${(0,_.A)(r.overlap)}`],"default"!==r.color&&t[`color${(0,_.A)(r.color)}`],r.invisible&&t.invisible]}})(({theme:e,ownerState:t})=>(0,i.A)({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(12),minWidth:20,lineHeight:1,padding:"0 6px",height:20,borderRadius:10,zIndex:1,transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.enteringScreen})},"default"!==t.color&&{backgroundColor:(e.vars||e).palette[t.color].main,color:(e.vars||e).palette[t.color].contrastText},"dot"===t.variant&&{borderRadius:4,height:8,minWidth:8,padding:0},"top"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap&&{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${O.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}},"bottom"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap&&{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${O.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}},"top"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap&&{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${O.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}},"bottom"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap&&{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${O.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}},"top"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"circular"===t.overlap&&{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${O.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}},"bottom"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"circular"===t.overlap&&{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${O.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}},"top"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"circular"===t.overlap&&{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${O.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}},"bottom"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"circular"===t.overlap&&{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${O.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}},t.invisible&&{transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.leavingScreen})})),A=o.forwardRef(function(e,t){var r,o,l,c,d,u;let h;let g=(0,b.A)({props:e,name:"MuiBadge"}),{anchorOrigin:f={vertical:"top",horizontal:"right"},className:v,component:_="span",components:w={},componentsProps:O={},overlap:A="rectangular",color:S="default",invisible:I=!1,max:R,badgeContent:k,slots:j,slotProps:P,showZero:N=!1,variant:T="standard"}=g,D=(0,n.A)(g,C),M=(0,s.A)({anchorOrigin:f,color:S,overlap:A,variant:T}),z=I;!1!==I||(0!==k||N)&&(null!=k||"dot"===T)||(z=!0);let{color:B=S,overlap:W=A,anchorOrigin:$=f,variant:V=T}=z?M:g,q=(0,i.A)({},g,{anchorOrigin:$,invisible:z,color:B,overlap:W,variant:V}),U=x(q);"dot"!==V&&(h=k&&Number(k)>R?`${R}+`:k);let F=null!=(r=null!=(o=null==j?void 0:j.root)?o:w.Root)?r:E,J=null!=(l=null!=(c=null==j?void 0:j.badge)?c:w.Badge)?l:L,G=null!=(d=null==P?void 0:P.root)?d:O.root,K=null!=(u=null==P?void 0:P.badge)?u:O.badge;return(0,p.jsx)(m,(0,i.A)({invisible:I,badgeContent:h,showZero:N,max:R},D,{slots:{root:F,badge:J},className:(0,a.default)(null==G?void 0:G.className,U.root,v),slotProps:{root:(0,i.A)({},G,(0,y.A)(F)&&{as:_,ownerState:(0,i.A)({},null==G?void 0:G.ownerState,{anchorOrigin:$,color:B,overlap:W,variant:V})}),badge:(0,i.A)({},K,{className:(0,a.default)(U.badge,null==K?void 0:K.className)},(0,y.A)(J)&&{ownerState:(0,i.A)({},null==K?void 0:K.ownerState,{anchorOrigin:$,color:B,overlap:W,variant:V})})},ref:t}))}),S=A},13586(e,t,r){"use strict";r.r(t),r.d(t,{default:()=>C});var n=r(91557),i=r(67725),o=r(3556),a=r(12789),s=r(72761),l=r(8051),c=r(30719),d=r(96540),u=r(97837),h=r(65121),p=r(86663),g=r(84058),f=r.n(g);let m=(0,o.Ay)(a.A,{name:"AvatarWrapper"})(({theme:e})=>({borderWidth:"thin",borderStyle:"solid",borderColor:e.palette.border.secondary})),v=(0,o.Ay)(n.N_E,{name:"Link"})(({theme:e})=>({"&:hover":{textDecoration:"none"}})),b=(0,o.Ay)(s.A,{shouldForwardProp:e=>"status"!==e})(({theme:e,status:t})=>({"& .MuiBadge-badge":{...t===u.O2.Offline&&{display:"none"},...t===u.O2.Online&&{color:e.palette.success.main,backgroundColor:e.palette.success.main},...t===u.O2.Away&&{color:e.palette.warning.main,backgroundColor:e.palette.warning.main},...t===u.O2.Busy&&{color:e.palette.error.main,backgroundColor:e.palette.error.main},boxShadow:"dark"===e.palette.mode?"none":`0 0 0 2px ${e.palette.background.paper}`,"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}}})),y=(0,o.Ay)("div",{shouldForwardProp:e=>"sizeProps"!==e})(({theme:e,sizeProps:t})=>({position:"relative",width:"32px",height:"32px",...t&&{width:t,height:t}})),_=(0,o.Ay)(a.A,{shouldForwardProp:e=>"sizeProps"!==e})(({theme:e,sizeProps:t})=>({position:"absolute",bottom:0,left:0,width:"26px",height:"26px",backgroundColor:"dark"===e.palette.mode?e.palette.grey["600"]:e.palette.grey["300"],borderWidth:1,borderStyle:"solid",borderColor:"light"===e.palette.mode?e.palette.grey["50"]:e.palette.grey["800"],zIndex:2,...t&&{width:.7*t,height:.7*t}})),w=(0,o.Ay)(l.A,{shouldForwardProp:e=>"sizeProps"!==e})(({theme:e,sizeProps:t})=>({position:"relative",width:"100%",height:"100%"})),O=(0,o.Ay)(a.A,{shouldForwardProp:e=>"sizeProps"!==e})(({theme:e,sizeProps:t})=>({position:"absolute",top:"50%",right:0,transform:"translate(0%, -50%)",width:"26px",height:"26px",...t&&{width:`${.7*t}px !important`,height:`${.7*t}px !important`}})),C=(0,d.memo)(function({username:e="Name",name:t="Name",src:r,size:o,to:s,onClick:l,status:g=0,room:C,uploadLocal:x=!1,roomType:E=null,avatarETag:L,component:A="span",target:S="_self",noLink:I}){var R,k;let{getSetting:j}=(0,n.PCX)(),P=(0,c.A)(),N=I,T=s,D=E||(null==C?void 0:C.t),M=(0,i.cb)(t),z={width:o,height:o,color:P.palette.grey["50"],fontSize:o/3},B=j("chatplus"),W=null==B?void 0:null===(R=B.server)||void 0===R?void 0:R.replace(/\/$/,""),$=r;if($||($=L?`${W}/avatar/${e}?${p.stringify({etag:L})}`:""),M&&(z.backgroundColor=i.m6.hex(M)),(null==C?void 0:C.isBotRoom)&&(T=null,N=!0),T)return d.createElement(v,{target:S,to:T||`/${e}`},d.createElement(m,{"data-testid":f()("chatplus avatar"),src:$,alt:t,style:z,component:A,children:M}));if([u.CJ.Private,u.CJ.Public].includes(D)){if(x)return d.createElement(m,{"data-testid":f()("chatplus avatar"),src:$,alt:t,style:z,component:A,children:M});if(null==C?void 0:C.avatarETag)return $=`${W}/avatar/room/${null==C?void 0:C.id}?${p.stringify({etag:null==C?void 0:C.avatarETag})}`,d.createElement(m,{"data-testid":f()("chatplus avatar"),src:$,alt:t,style:z,component:A,children:M});{let V=`${W}/avatar/${null==C?void 0:null===(k=C.u)||void 0===k?void 0:k.username}`;return d.createElement(y,{"data-testid":f()("chatplus avatar"),sizeProps:o},d.createElement(_,{sizeProps:o,src:V,alt:t,component:A,children:M}),d.createElement(w,null,d.createElement(O,{sizeProps:o,src:$,alt:t,style:z,component:A,children:M})))}}if(D===u.CJ.Direct&&g){let q=(0,h.cR)(g);return d.createElement(b,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot",status:q},d.createElement(a.A,{"data-testid":f()("chatplus avatar"),src:$,alt:t,style:z,component:A,children:M}))}return d.createElement(m,{"data-testid":f()("chatplus avatar"),src:$,alt:t,style:z,component:A,children:M,onClick:l,to:N?null:e})})},34224(e,t,r){"use strict";r.r(t),r.d(t,{default:()=>T});var n=r(91557),i=r(61341),o=r(88485),a=r(65121),s=r(3556),l=r(8051),c=r(62193),d=r.n(c),u=r(96540);let h=(0,s.Ay)("div",{slot:"uiCallView"})(({theme:e})=>({display:"flex",justifyContent:"space-around",alignItems:"center",flexDirection:"column",maxWidth:"100%",overflowX:"hidden",boxSizing:"border-box",position:"fixed",left:0,right:0,top:0,bottom:0,backgroundColor:e.palette.grey["800"],"& h1, h2, h3,h4, h5, h6":{color:"white"}})),p=()=>{let{i18n:e}=(0,n.PCX)();return u.createElement(h,null,u.createElement("h1",null,e.formatMessage({id:"connecting_dots"})))},g=(0,s.Ay)("div",{slot:"uiCallView"})(({theme:e})=>({display:"flex",justifyContent:"center",alignItems:"center",maxWidth:"100%",overflowX:"hidden",boxSizing:"border-box",position:"fixed",left:0,right:0,top:0,bottom:0,backgroundColor:e.palette.grey["800"],"& h1, h2, h3,h4, h5, h6":{color:"white"}}));function f({callId:e}){let{i18n:t}=(0,n.PCX)();return(0,u.useEffect)(()=>{(0,a.a2)(e,"end")},[e]),(0,u.useEffect)(()=>{setTimeout(window.close,i.NW)},[]),u.createElement(g,null,u.createElement("h1",null,t.formatMessage({id:"the_call_is_ended"})))}var m=r(97837),v=r(40515),b=r(13586);let y=(0,s.Ay)("div",{slot:"uiCallView"})(({theme:e})=>({display:"flex",justifyContent:"space-around",alignItems:"center",flexDirection:"column",maxWidth:"100%",overflowX:"hidden",boxSizing:"border-box",position:"fixed",left:0,right:0,top:0,bottom:0,backgroundColor:e.palette.grey["800"],"& h1, h2, h3,h4, h5, h6":{color:"white"},"& h1":{fontSize:e.spacing(2)},"& h4":{fontSize:e.spacing(3.75),margin:e.spacing(1)}})),_=(0,s.Ay)("div")(({theme:e})=>({display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"})),w=(0,s.Ay)(v.Bj)(({theme:e})=>({width:"48px",height:"48px",borderRadius:"100%",padding:0,margin:"30px 0",color:"#ffffff",cursor:"pointer",backgroundColor:"#bf2117","&:hover":{backgroundColor:"#bf2117"}}));function O({callId:e,callInfo:t,cancelCall:r}){let{i18n:i}=(0,n.PCX)();(0,u.useEffect)(()=>{(0,a.a2)(e,"ringing")},[e]);let{displayName:o,avatar:s,callType:l}=t,c=l&&l.split("_")[2]||m.CJ.Direct;return u.createElement(y,null,u.createElement("h1",null,i.formatMessage({id:"incoming_call_dots"})),u.createElement(_,null,u.createElement(b.default,{src:s,size:100,name:o,username:o,roomType:c}),u.createElement("h4",null,o)),u.createElement(w,{size:"small",color:"primary",icon:"ico-phone-off",title:i.formatMessage({id:"end_call"}),onClick:r}))}var C=r(49229),x=r.n(C);function E({callId:e,callInfo:t,user:r,readyToClose:i}){let{dispatch:o,i18n:s}=(0,n.PCX)(),l=()=>o({type:"chatplus/room/pingVoIpCall",payload:{callId:e}});return(0,u.useEffect)(()=>{(0,a.a2)(e,"start"),window.setInterval(l,5e3),o({type:"chatplus/room/joinCall",payload:{callId:e}})},[]),(0,u.useEffect)(()=>{t&&r&&i&&function(e,t,r){let{callId:n,group:i,audioOnly:o,canEnableVideo:a=!0,localDisplayName:s,localAvatar:l,url:c,jwt:d,subjectTitle:u}=e,h=["recording","microphone","hangup","fullscreen","videoquality","filmstrip","tileview","download","desktop","sharedvideo",...a?["camera"]:[]].filter(Boolean),p=new URL(c),g=new(x())(p.host,{roomName:p.pathname,noSSL:!/https/i.test(p.protocol),parentNode:document.querySelector("#meet"),jwt:d,configOverwrite:{startAudioOnly:!a,startVideoMuted:o,startWithVideoMuted:o,prejoinPageEnabled:!1,enableClosePage:!1,enableWelcomePage:!1,hideConferenceSubject:!0},interfaceConfigOverwrite:{SHOW_PROMOTIONAL_CLOSE_PAGE:!1,SHOW_WATERMARK_FOR_GUESTS:!1,SHOW_BRAND_WATERMARK:!1,BRAND_WATERMARK_LINK:"",SHOW_POWERED_BY:!1,DEFAULT_REMOTE_DISPLAY_NAME:s,DEFAULT_LOCAL_DISPLAY_NAME:s,SHOW_JITSI_WATERMARK:!1,DEFAULT_BACKGROUND:"#1B2638",DISABLE_VIDEO_BACKGROUND:!0,DISABLE_RINGING:!1,VIDEO_QUALITY_LABEL_DISABLED:!0,RECENT_LIST_ENABLED:!1,AUTO_PIN_LATEST_SCREEN_SHARE:!1,DISABLE_JOIN_LEAVE_NOTIFICATIONS:!0,TOOLBAR_BUTTONS:h,SETTINGS_SECTIONS:[]}});setTimeout(()=>{g.executeCommand("avatarUrl",l),g.executeCommand("displayName",s)},2e3),g.addListener("videoConferenceJoined",()=>{g.executeCommand("avatarUrl",l)}),g.executeCommand("subject",u),i||g.addEventListener("videoConferenceLeft",r),window.addEventListener("message",e=>{e&&e.data&&e.data===`hangup/${n}`&&g.executeCommand("hangup")}),g.addEventListener("readyToClose",r),g.addEventListener("feedbackSubmitted",()=>{setTimeout(r,3e3)})}({...t,subjectTitle:(null==t?void 0:t.group)?null==t?void 0:t.subject:s.formatMessage({id:"calling"})},0,i)},[]),u.createElement("div",null)}let L=(0,s.Ay)("div",{slot:"uiCallView"})(({theme:e})=>({display:"flex",justifyContent:"space-around",alignItems:"center",flexDirection:"column",maxWidth:"100%",overflowX:"hidden",boxSizing:"border-box",position:"fixed",left:0,right:0,top:0,bottom:0,backgroundColor:e.palette.grey["800"],"& h1, h2, h3,h4, h5, h6":{color:"white"},"& h4":{fontSize:e.spacing(3.75),margin:e.spacing(1)}})),A=(0,s.Ay)("div")(({theme:e})=>({color:"white",fontSize:e.spacing(2)})),S=(0,s.Ay)("div")(({theme:e})=>({display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"})),I=(0,s.Ay)(v.Bj)(({theme:e})=>({width:"48px",height:"48px",borderRadius:"100%",padding:0,margin:"30px 0",color:"#ffffff",cursor:"pointer",backgroundColor:"#bf2117 !important","&:hover":{backgroundColor:"#bf2117 !important"}}));function R({callId:e,callInfo:t,cancelCall:r}){let{i18n:i}=(0,n.PCX)(),s=(0,o.sz)(),{Website:l,Metafox_Ringtone_Sound_Url:c}=s,d=`${l}${c}`;(0,u.useEffect)(()=>{(0,a.a2)(e,"invite")},[e]);let{displayName:h,avatar:p,callType:g}=t,f=g&&g.split("_")[2]||m.CJ.Direct;return u.createElement("div",null,u.createElement(L,null,u.createElement(A,null,i.formatMessage({id:"calling_dots"})),u.createElement(S,null,u.createElement(b.default,{src:p,size:100,name:h,username:h,roomType:f}),u.createElement("h4",null,h)),u.createElement(I,{size:"small",color:"primary",icon:"ico-phone-off",title:i.formatMessage({id:"end_call"}),onClick:r}),d&&u.createElement("audio",{style:{display:"none"},src:d,loop:!0,autoPlay:!0,type:"audio/mpeg"})))}let k="CallViewBlock",j=(0,s.Ay)(l.A,{name:k,slot:"root"})(({theme:e})=>({display:"block",maxWidth:"100%",overflowX:"hidden",boxSizing:"border-box",position:"fixed",left:0,right:0,top:0,bottom:0})),P=(0,s.Ay)(l.A,{name:k,slot:"WrapperViewCall"})(({theme:e})=>({})),N=(0,n.WvA)({name:"CallViewBlock",extendBlock:function(e){let{dispatch:t,usePageParams:r,i18n:s}=(0,n.PCX)(),{callId:l}=r(),[c,h]=(0,u.useState)(!1),[g,m]=(0,u.useState)(!1),v=(0,o.vY)(l),b=(0,o.hB)();(0,u.useEffect)(()=>{!d()(v)&&(m(!0),window&&(window.document.title=s.formatMessage({id:(null==v?void 0:v.subject)||"calling"})))},[l,v]);let y=()=>{t({type:"chatplus/room/cancelCall",payload:{callId:l}}),t({type:"chatplus/callInfo",payload:{callId:l,callStatus:"end"}})},_=()=>setTimeout(window.close,i.NW),w=()=>{document.querySelector("#meet").innerHTML="",h(!0),t({type:"chatplus/room/leaveCall",payload:{callId:l},meta:{onSuccess:()=>_()}})};window.onunload=()=>{alert("is unloaded"),localStorage.removeItem("chatplus/callId"),localStorage.removeItem(l)};let C=(0,a.BA)(l,null==v?void 0:v.callStatus);return g?u.createElement(j,{id:"meet"},u.createElement(P,null,c||"invite"!==C?null:u.createElement(R,{callId:l,callInfo:v,cancelCall:y}),c||"ringing"!==C?null:u.createElement(O,{callId:l,callInfo:v,cancelCall:y}),c||"end"===C?u.createElement(f,{callId:l}):null,c||"start"!==C?null:u.createElement(E,{callId:l,callInfo:v,user:b,readyToClose:w}),c||"nothing"!==C?null:u.createElement(p,null))):u.createElement(p,null)}}),T=N},49229(e){window,e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t||4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,(function(t){return e[t]}).bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/libs/",r(r.s=6)}([function(e,t,r){"use strict";(function(e){r.d(t,"a",function(){return o}),r.d(t,"b",function(){return a}),r.d(t,"c",function(){return s}),r.d(t,"d",function(){return l}),r.d(t,"e",function(){return c}),r.d(t,"f",function(){return d}),r.d(t,"g",function(){return u}),r.d(t,"h",function(){return p});var n=r(5);let i=r.n(n).a.getLogger(e);function o(e){return e.sendRequest({type:"devices",name:"getAvailableDevices"}).catch(e=>(i.error(e),{}))}function a(e){return e.sendRequest({type:"devices",name:"getCurrentDevices"}).catch(e=>(i.error(e),{}))}function s(e,t){return e.sendRequest({deviceType:t,type:"devices",name:"isDeviceChangeAvailable"})}function l(e){return e.sendRequest({type:"devices",name:"isDeviceListAvailable"})}function c(e){return e.sendRequest({type:"devices",name:"isMultipleAudioInputSupported"})}function d(e,t,r){return h(e,{id:r,kind:"audioinput",label:t})}function u(e,t,r){return h(e,{id:r,kind:"audiooutput",label:t})}function h(e,t){return e.sendRequest({type:"devices",name:"setDevice",device:t})}function p(e,t,r){return h(e,{id:r,kind:"videoinput",label:t})}}).call(this,"modules/API/external/functions.js")},function(e,t,r){"use strict";var n,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};n=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function c(e){if("function"!=typeof e)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function d(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var i,o,a;if(c(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),a=o[t]),void 0===a)a=o[t]=r,++e._eventsCount;else if("function"==typeof a?a=o[t]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),(i=d(e))>0&&a.length>i&&!a.warned){a.warned=!0;var s=Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=a.length,console&&console.warn&&console.warn(s)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=h.bind(n);return i.listener=r,n.wrapFn=i,i}function g(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):m(i,i.length)}function f(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function m(e,t){for(var r=Array(t),n=0;n<t;++n)r[n]=e[n];return r}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||a(e))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return d(this)},s.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var a,s=Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var l=i[e];if(void 0===l)return!1;if("function"==typeof l)o(l,this,t);else{var c=l.length,d=m(l,c);for(r=0;r<c;++r)o(d[r],this,t)}return!0},s.prototype.addListener=function(e,t){return u(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return u(this,e,t,!0)},s.prototype.once=function(e,t){return c(t),this.on(e,p(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,p(this,e,t)),this},s.prototype.removeListener=function(e,t){var r,n,i,o,a;if(c(t),void 0===(n=this._events)||void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){a=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0==arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},s.prototype.listeners=function(e){return g(this,e,!0)},s.prototype.rawListeners=function(e){return g(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},s.prototype.listenerCount=f,s.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(e,t){var r={trace:0,debug:1,info:2,log:3,warn:4,error:5};a.consoleTransport=console;var n=[a.consoleTransport];a.addGlobalTransport=function(e){-1===n.indexOf(e)&&n.push(e)},a.removeGlobalTransport=function(e){var t=n.indexOf(e);-1!==t&&n.splice(t,1)};var i={};function o(){var e=arguments[0],t=arguments[1],o=Array.prototype.slice.call(arguments,2);if(!(r[t]<e.level))for(var a=!(e.options.disableCallerInfo||i.disableCallerInfo)&&function(){var e={methodName:"",fileLocation:"",line:null,column:null},t=Error(),r=t.stack?t.stack.split("\n"):[];if(!r||r.length<3)return e;var n=null;return r[3]&&(n=r[3].match(/\s*at\s*(.+?)\s*\((\S*)\s*:(\d*)\s*:(\d*)\)/)),!n||n.length<=4?(0===r[2].indexOf("log@")?e.methodName=r[3].substr(0,r[3].indexOf("@")):e.methodName=r[2].substr(0,r[2].indexOf("@")),e):(e.methodName=n[1],e.fileLocation=n[2],e.line=n[3],e.column=n[4],e)}(),s=n.concat(e.transports),l=0;l<s.length;l++){var c=s[l],d=c[t];if(d&&"function"==typeof d){var u=[];u.push(new Date().toISOString()),e.id&&u.push("["+e.id+"]"),a&&a.methodName.length>1&&u.push("<"+a.methodName+">: ");var h=u.concat(o);d.bind(c).apply(c,h)}}}function a(e,t,n,i){this.id=t,this.options=i||{},this.transports=n,this.transports||(this.transports=[]),this.level=r[e];for(var a=Object.keys(r),s=0;s<a.length;s++)this[a[s]]=o.bind(null,this,a[s])}a.setGlobalOptions=function(e){i=e||{}},a.prototype.setLevel=function(e){this.level=r[e]},e.exports=a,a.levels={TRACE:"trace",DEBUG:"debug",INFO:"info",LOG:"log",WARN:"warn",ERROR:"error"}},function(e,t){function r(){return new DOMException("The request is not allowed","NotAllowedError")}e.exports=async function(e){try{await async function(e){if(!navigator.clipboard)throw r();return navigator.clipboard.writeText(e)}(e)}catch(n){try{await async function(e){let t=document.createElement("span");t.textContent=e,t.style.whiteSpace="pre",t.style.webkitUserSelect="auto",t.style.userSelect="all",document.body.appendChild(t);let n=window.getSelection(),i=window.document.createRange();n.removeAllRanges(),i.selectNode(t),n.addRange(i);let o=!1;try{o=window.document.execCommand("copy")}finally{n.removeAllRanges(),window.document.body.removeChild(t)}if(!o)throw r()}(e)}catch(t){throw t||n||r()}}}},function(e,t){e.exports=function(e){var t,r=e.scope,n=e.window,i=e.windowForEventListening||window,o=e.allowedOrigin,a={},s=[],l={},c=!1,d=function(e){var t;try{t=JSON.parse(e.data)}catch(n){return}if((!o||e.origin===o)&&t&&t.postis&&t.scope===r){var i=a[t.method];if(i)for(var s=0;s<i.length;s++)i[s].call(null,t.params);else l[t.method]=l[t.method]||[],l[t.method].push(t.params)}};i.addEventListener("message",d,!1);var u={listen:function(e,t){a[e]=a[e]||[],a[e].push(t);var r=l[e];if(r)for(var n=a[e],i=0;i<n.length;i++)for(var o=0;o<r.length;o++)n[i].call(null,r[o]);delete l[e]},send:function(e){var t=e.method;(c||"__ready__"===e.method)&&n&&"function"==typeof n.postMessage?n.postMessage(JSON.stringify({postis:!0,scope:r,method:t,params:e.params}),"*"):s.push(e)},ready:function(e){c?e():setTimeout(function(){u.ready(e)},50)},destroy:function(e){clearInterval(t),c=!1,i&&"function"==typeof i.removeEventListener&&i.removeEventListener("message",d),e&&e()}},h=+new Date+Math.random()+"";return t=setInterval(function(){u.send({method:"__ready__",params:h})},50),u.listen("__ready__",function(e){if(e===h){clearInterval(t),c=!0;for(var r=0;r<s.length;r++)u.send(s[r]);s=[]}else u.send({method:"__ready__",params:e})}),u}},function(e,t,r){var n=r(2),i=r(7),o={},a=[],s=n.levels.TRACE;e.exports={addGlobalTransport:function(e){n.addGlobalTransport(e)},removeGlobalTransport:function(e){n.removeGlobalTransport(e)},setGlobalOptions:function(e){n.setGlobalOptions(e)},getLogger:function(e,t,r){var i=new n(s,e,t,r);return e?(o[e]=o[e]||[],o[e].push(i)):a.push(i),i},setLogLevelById:function(e,t){for(var r=t?o[t]||[]:a,n=0;n<r.length;n++)r[n].setLevel(e)},setLogLevel:function(e){s=e;for(var t=0;t<a.length;t++)a[t].setLevel(e);for(var r in o){var n=o[r]||[];for(t=0;t<n.length;t++)n[t].setLevel(e)}},levels:n.levels,LogCollector:i}},function(e,t,r){e.exports=r(8).default},function(e,t,r){var n=r(2);function i(e,t){this.logStorage=e,this.stringifyObjects=!(!t||!t.stringifyObjects)&&t.stringifyObjects,this.storeInterval=t&&t.storeInterval?t.storeInterval:3e4,this.maxEntryLength=t&&t.maxEntryLength?t.maxEntryLength:1e4,Object.keys(n.levels).forEach((function(e){this[n.levels[e]]=(function(){this._log.apply(this,arguments)}).bind(this,e)}).bind(this)),this.storeLogsIntervalID=null,this.queue=[],this.totalLen=0,this.outputCache=[]}i.prototype.stringify=function(e){try{return JSON.stringify(e)}catch(t){return"[object with circular refs?]"}},i.prototype.formatLogMessage=function(e){for(var t="",r=1,i=arguments.length;r<i;r++){var o=arguments[r];(this.stringifyObjects||e===n.levels.ERROR)&&"object"==typeof o&&(o=this.stringify(o)),t+=o,r!==i-1&&(t+=" ")}return t.length?t:null},i.prototype._log=function(){var e=arguments[1],t=this.formatLogMessage.apply(this,arguments);if(t){var r=this.queue[this.queue.length-1];(r&&r.text)===t?r.count+=1:(this.queue.push({text:t,timestamp:e,count:1}),this.totalLen+=t.length)}this.totalLen>=this.maxEntryLength&&this._flush(!0,!0)},i.prototype.start=function(){this._reschedulePublishInterval()},i.prototype._reschedulePublishInterval=function(){this.storeLogsIntervalID&&(window.clearTimeout(this.storeLogsIntervalID),this.storeLogsIntervalID=null),this.storeLogsIntervalID=window.setTimeout(this._flush.bind(this,!1,!0),this.storeInterval)},i.prototype.flush=function(){this._flush(!1,!0)},i.prototype._flush=function(e,t){this.totalLen>0&&(this.logStorage.isReady()||e)&&(this.logStorage.isReady()?(this.outputCache.length&&(this.outputCache.forEach((function(e){this.logStorage.storeLogs(e)}).bind(this)),this.outputCache=[]),this.logStorage.storeLogs(this.queue)):this.outputCache.push(this.queue),this.queue=[],this.totalLen=0),t&&this._reschedulePublishInterval()},i.prototype.stop=function(){this._flush(!1,!1)},e.exports=i},function(e,t,r){"use strict";let n;r.r(t),r.d(t,"default",function(){return L});var i=r(1),o=r.n(i);class a extends o.a{clear(){this._storage={}}get length(){return Object.keys(this._storage).length}getItem(e){return this._storage[e]}setItem(e,t){this._storage[e]=t}removeItem(e){delete this._storage[e]}key(e){let t=Object.keys(this._storage);if(!(t.length<=e))return t[e]}serialize(){return JSON.stringify(this._storage)}constructor(...e){var t,r,n;super(...e),n={},(r="_storage")in(t=this)?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n}}class s extends o.a{isLocalStorageDisabled(){return this._localStorageDisabled}clear(){this._storage.clear(),this.emit("changed")}get length(){return this._storage.length}getItem(e){return this._storage.getItem(e)}setItem(e,t,r=!1){this._storage.setItem(e,t),r||this.emit("changed")}removeItem(e){this._storage.removeItem(e),this.emit("changed")}key(e){return this._storage.key(e)}serialize(){if(this.isLocalStorageDisabled())return this._storage.serialize();let e=this._storage.length,t={};for(let r=0;r<e;r++){let n=this._storage.key(r);t[n]=this._storage.getItem(n)}return JSON.stringify(t)}constructor(){super();try{this._storage=window.localStorage,this._localStorageDisabled=!1}catch(e){}this._storage||(console.warn("Local storage is disabled."),this._storage=new a,this._localStorageDisabled=!0)}}let l=new s;function c(e){let t=RegExp("^([a-z][a-z0-9\\.\\+-]*:)+","gi"),r=t.exec(e);if(r){let n=r[r.length-1].toLowerCase();"http:"!==n&&"https:"!==n&&(n="https:"),(e=e.substring(t.lastIndex)).startsWith("//")&&(e=n+e)}return e}function d(e){let t,r,n;let i={toString:u};if(e=e.replace(/\s/g,""),(r=(t=RegExp("^([a-z][a-z0-9\\.\\+-]*:)","gi")).exec(e))&&(i.protocol=r[1].toLowerCase(),e=e.substring(t.lastIndex)),r=(t=RegExp("^(//[^/?#]+)","gi")).exec(e)){let o=r[1].substring(2);e=e.substring(t.lastIndex);let a=o.indexOf("@");-1!==a&&(o=o.substring(a+1)),i.host=o;let s=o.lastIndexOf(":");-1!==s&&(i.port=o.substring(s+1),o=o.substring(0,s)),i.hostname=o}if((r=(t=RegExp("^([^?#]*)","gi")).exec(e))&&(n=r[1],e=e.substring(t.lastIndex)),n?n.startsWith("/")||(n="/"+n):n="/",i.pathname=n,e.startsWith("?")){let l=e.indexOf("#",1);-1===l&&(l=e.length),i.search=e.substring(0,l),e=e.substring(l)}else i.search="";return i.hash=e.startsWith("#")?e:"",i}function u(e){let{hash:t,host:r,pathname:n,protocol:i,search:o}=e||this,a="";return i&&(a+=i),r&&(a+="//"+r),a+=n||"/",o&&(a+=o),t&&(a+=t),a}r(3);var h=r(4),p=r.n(h);let g={window:window.opener||window.parent};class f{dispose(){this.postis.destroy()}send(e){this.postis.send({method:"message",params:e})}setReceiveCallback(e){this._receiveCallback=e}constructor({postisOptions:e}={}){this.postis=p()(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n,i;n=e,i=r[t],t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i})}return e}({},g,e)),this._receiveCallback=()=>{},this.postis.listen("message",e=>this._receiveCallback(e))}}class m{_disposeBackend(){this._backend&&(this._backend.dispose(),this._backend=null)}_onMessageReceived(e){if("response"===e.type){let t=this._responseHandlers.get(e.id);t&&(t(e),this._responseHandlers.delete(e.id))}else"request"===e.type?this.emit("request",e.data,(t,r)=>{this._backend.send({type:"response",error:r,id:e.id,result:t})}):this.emit("event",e.data)}dispose(){this._responseHandlers.clear(),this._unprocessedMessages.clear(),this.removeAllListeners(),this._disposeBackend()}emit(e,...t){let r=this._listeners.get(e),n=!1;return r&&r.size&&r.forEach(e=>{n=e(...t)||n}),n||this._unprocessedMessages.add(t),n}on(e,t){let r=this._listeners.get(e);return r||(r=new Set,this._listeners.set(e,r)),r.add(t),this._unprocessedMessages.forEach(e=>{t(...e)&&this._unprocessedMessages.delete(e)}),this}removeAllListeners(e){return e?this._listeners.delete(e):this._listeners.clear(),this}removeListener(e,t){let r=this._listeners.get(e);return r&&r.delete(t),this}sendEvent(e={}){this._backend&&this._backend.send({type:"event",data:e})}sendRequest(e){if(!this._backend)return Promise.reject(Error("No transport backend defined!"));this._requestID++;let t=this._requestID;return new Promise((r,n)=>{this._responseHandlers.set(t,({error:e,result:t})=>{void 0!==t?r(t):n(void 0!==e?e:Error("Unexpected response format!"))}),this._backend.send({type:"request",data:e,id:t})})}setBackend(e){this._disposeBackend(),this._backend=e,this._backend.setReceiveCallback(this._onMessageReceived.bind(this))}constructor({backend:e}={}){this._listeners=new Map,this._requestID=0,this._responseHandlers=new Map,this._unprocessedMessages=new Set,this.addListener=this.on,e&&this.setBackend(e)}}let v=function(e,t=!1,r="hash"){let n="search"===r?e.search:e.hash,i={},o=n&&n.substr(1).split("&")||[];if("hash"===r&&1===o.length){let a=o[0];if(a.startsWith("/")&&1===a.split("&").length)return i}return o.forEach(e=>{let r;let n=e.split("="),o=n[0];if(o){try{if(r=n[1],!t){let a=decodeURIComponent(r).replace(/\\&/,"&");r="undefined"===a?void 0:JSON.parse(a)}}catch(s){return void function(e,t=""){console.error(t,e),window.onerror&&window.onerror(t,null,null,null,e)}(s,"Failed to parse URL parameter value: "+String(r))}i[o]=r}}),i}(window.location).jitsi_meet_external_api_id,b={};"number"==typeof v&&(b.scope="jitsi_meet_external_api_"+v),(window.JitsiMeetJS||(window.JitsiMeetJS={}),window.JitsiMeetJS.app||(window.JitsiMeetJS.app={}),window.JitsiMeetJS.app).setExternalTransportBackend=e=>n.setBackend(e);var y=r(0);let _=["css/all.css","libs/alwaysontop.min.js"],w={avatarUrl:"avatar-url",cancelPrivateChat:"cancel-private-chat",displayName:"display-name",e2eeKey:"e2ee-key",email:"email",toggleLobby:"toggle-lobby",hangup:"video-hangup",intiatePrivateChat:"initiate-private-chat",kickParticipant:"kick-participant",muteEveryone:"mute-everyone",overwriteConfig:"overwrite-config",password:"password",pinParticipant:"pin-participant",resizeLargeVideo:"resize-large-video",sendEndpointTextMessage:"send-endpoint-text-message",sendTones:"send-tones",setLargeVideoParticipant:"set-large-video-participant",setTileView:"set-tile-view",setVideoQuality:"set-video-quality",startRecording:"start-recording",stopRecording:"stop-recording",subject:"subject",submitFeedback:"submit-feedback",toggleAudio:"toggle-audio",toggleCamera:"toggle-camera",toggleCameraMirror:"toggle-camera-mirror",toggleChat:"toggle-chat",toggleFilmStrip:"toggle-film-strip",toggleRaiseHand:"toggle-raise-hand",toggleShareScreen:"toggle-share-screen",toggleTileView:"toggle-tile-view",toggleVideo:"toggle-video"},O={"avatar-changed":"avatarChanged","audio-availability-changed":"audioAvailabilityChanged","audio-mute-status-changed":"audioMuteStatusChanged","camera-error":"cameraError","chat-updated":"chatUpdated","content-sharing-participants-changed":"contentSharingParticipantsChanged","device-list-changed":"deviceListChanged","display-name-change":"displayNameChange","email-change":"emailChange","endpoint-text-message-received":"endpointTextMessageReceived","feedback-submitted":"feedbackSubmitted","feedback-prompt-displayed":"feedbackPromptDisplayed","filmstrip-display-changed":"filmstripDisplayChanged","incoming-message":"incomingMessage",log:"log","mic-error":"micError","outgoing-message":"outgoingMessage","participant-joined":"participantJoined","participant-kicked-out":"participantKickedOut","participant-left":"participantLeft","participant-role-changed":"participantRoleChanged","password-required":"passwordRequired","proxy-connection-event":"proxyConnectionEvent","raise-hand-updated":"raiseHandUpdated","recording-status-changed":"recordingStatusChanged","video-ready-to-close":"readyToClose","video-conference-joined":"videoConferenceJoined","video-conference-left":"videoConferenceLeft","video-availability-changed":"videoAvailabilityChanged","video-mute-status-changed":"videoMuteStatusChanged","video-quality-changed":"videoQualityChanged","screen-sharing-status-changed":"screenSharingStatusChanged","dominant-speaker-changed":"dominantSpeakerChanged","subject-change":"subjectChange","suspend-detected":"suspendDetected","tile-view-changed":"tileViewChanged"},C=0;function x(e,t){e._numberOfParticipants+=t}function E(e){let t;return"string"==typeof e&&null!==String(e).match(/([0-9]*\.?[0-9]+)(em|pt|px|%)$/)?t=e:"number"==typeof e&&(t=e+"px"),t}class L extends o.a{_createIFrame(e,t,r){let n="jitsiConferenceFrame"+C;this._frame=document.createElement("iframe"),this._frame.allow="camera; microphone; display-capture; autoplay; clipboard-write",this._frame.src=this._url,this._frame.name=n,this._frame.id=n,this._setSize(e,t),this._frame.setAttribute("allowFullScreen","true"),this._frame.style.border=0,r&&(this._frame.onload=r),this._frame=this._parentNode.appendChild(this._frame)}_getAlwaysOnTopResources(){let e=this._frame.contentWindow,t=e.document,r="",n=t.querySelector("base");if(n&&n.href)r=n.href;else{let{protocol:i,host:o}=e.location;r=`${i}//${o}`}return _.map(e=>new URL(e,r).href)}_getFormattedDisplayName(e){let{formattedDisplayName:t}=this._participants[e]||{};return t}_getOnStageParticipant(){return this._onStageParticipant}_getLargeVideo(){let e=this.getIFrame();if(this._isLargeVideoVisible&&e&&e.contentWindow&&e.contentWindow.document)return e.contentWindow.document.getElementById("largeVideo")}_getParticipantVideo(e){let t=this.getIFrame();if(t&&t.contentWindow&&t.contentWindow.document)return void 0===e||e===this._myUserID?t.contentWindow.document.getElementById("localVideo_container"):t.contentWindow.document.querySelector(`#participant_${e} video`)}_setSize(e,t){let r=E(e),n=E(t);void 0!==r&&(this._height=e,this._frame.style.height=r),void 0!==n&&(this._width=t,this._frame.style.width=n)}_setupListeners(){this._transport.on("event",e=>{let{name:t}=e,r=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["name"]),n=r.id;switch(t){case"video-conference-joined":void 0!==this._tmpE2EEKey&&(this.executeCommand(w.e2eeKey,this._tmpE2EEKey),this._tmpE2EEKey=void 0),this._myUserID=n,this._participants[n]={avatarURL:r.avatarURL};case"participant-joined":this._participants[n]=this._participants[n]||{},this._participants[n].displayName=r.displayName,this._participants[n].formattedDisplayName=r.formattedDisplayName,x(this,1);break;case"participant-left":x(this,-1),delete this._participants[n];break;case"display-name-change":{let i=this._participants[n];i&&(i.displayName=r.displayname,i.formattedDisplayName=r.formattedDisplayName);break}case"email-change":{let o=this._participants[n];o&&(o.email=r.email);break}case"avatar-changed":{let a=this._participants[n];a&&(a.avatarURL=r.avatarURL);break}case"on-stage-participant-changed":this._onStageParticipant=n,this.emit("largeVideoChanged");break;case"large-video-visibility-changed":this._isLargeVideoVisible=r.isVisible,this.emit("largeVideoChanged");break;case"video-conference-left":x(this,-1),delete this._participants[this._myUserID];break;case"video-quality-changed":this._videoQuality=r.videoQuality;break;case"local-storage-changed":return l.setItem("jitsiLocalStorage",r.localStorageContent),!0}let s=O[t];return!!s&&(this.emit(s,r),!0)})}addEventListener(e,t){this.on(e,t)}addEventListeners(e){for(let t in e)this.addEventListener(t,e[t])}captureLargeVideoScreenshot(){return this._transport.sendRequest({name:"capture-largevideo-screenshot"})}dispose(){this.emit("_willDispose"),this._transport.dispose(),this.removeAllListeners(),this._frame&&this._frame.parentNode&&this._frame.parentNode.removeChild(this._frame)}executeCommand(e,...t){e in w?this._transport.sendEvent({data:t,name:w[e]}):console.error("Not supported command name.")}executeCommands(e){for(let t in e)this.executeCommand(t,e[t])}getAvailableDevices(){return Object(y.a)(this._transport)}getContentSharingParticipants(){return this._transport.sendRequest({name:"get-content-sharing-participants"})}getCurrentDevices(){return Object(y.b)(this._transport)}getLivestreamUrl(){return this._transport.sendRequest({name:"get-livestream-url"})}getParticipantsInfo(){let e=Object.keys(this._participants),t=Object.values(this._participants);return t.forEach((t,r)=>{t.participantId=e[r]}),t}getVideoQuality(){return this._videoQuality}isAudioAvailable(){return this._transport.sendRequest({name:"is-audio-available"})}isDeviceChangeAvailable(e){return Object(y.c)(this._transport,e)}isDeviceListAvailable(){return Object(y.d)(this._transport)}isMultipleAudioInputSupported(){return Object(y.e)(this._transport)}invite(e){return Array.isArray(e)&&0!==e.length?this._transport.sendRequest({name:"invite",invitees:e}):Promise.reject(TypeError("Invalid Argument"))}isAudioMuted(){return this._transport.sendRequest({name:"is-audio-muted"})}isSharingScreen(){return this._transport.sendRequest({name:"is-sharing-screen"})}getAvatarURL(e){let{avatarURL:t}=this._participants[e]||{};return t}getDisplayName(e){let{displayName:t}=this._participants[e]||{};return t}getEmail(e){let{email:t}=this._participants[e]||{};return t}getIFrame(){return this._frame}getNumberOfParticipants(){return this._numberOfParticipants}isVideoAvailable(){return this._transport.sendRequest({name:"is-video-available"})}isVideoMuted(){return this._transport.sendRequest({name:"is-video-muted"})}pinParticipant(e){this.executeCommand("pinParticipant",e)}removeEventListener(e){this.removeAllListeners(e)}removeEventListeners(e){e.forEach(e=>this.removeEventListener(e))}resizeLargeVideo(e,t){e<=this._width&&t<=this._height&&this.executeCommand("resizeLargeVideo",e,t)}sendProxyConnectionEvent(e){this._transport.sendEvent({data:[e],name:"proxy-connection-event"})}setAudioInputDevice(e,t){return Object(y.f)(this._transport,e,t)}setAudioOutputDevice(e,t){return Object(y.g)(this._transport,e,t)}setLargeVideoParticipant(e){this.executeCommand("setLargeVideoParticipant",e)}setVideoInputDevice(e,t){return Object(y.h)(this._transport,e,t)}startRecording(e){this.executeCommand("startRecording",e)}stopRecording(e){this.executeCommand("startRecording",e)}constructor(e,...t){super();let{roomName:r="",width:n="100%",height:i="100%",parentNode:o=document.body,configOverwrite:a={},interfaceConfigOverwrite:s={},jwt:u,onload:h,invitees:p,devices:g,userInfo:v,e2eeKey:b}=function(e){if(!e.length)return{};switch(typeof e[0]){case"string":case void 0:{let[t,r,n,i,o,a,s,l]=e;return{roomName:t,width:r,height:n,parentNode:i,configOverwrite:o,interfaceConfigOverwrite:a,jwt:s,onload:l}}case"object":return e[0];default:throw Error("Can't parse the arguments!")}}(t),y=l.getItem("jitsiLocalStorage");this._parentNode=o,this._url=function(e,t={}){return function(e){let t;t=e.serverURL&&e.room?new URL(e.room,e.serverURL).toString():e.room?e.room:e.url||"";let r=d(c(t));if(!r.protocol){let n=e.protocol||e.scheme;n&&(n.endsWith(":")||(n+=":"),r.protocol=n)}let{pathname:i}=r;if(!r.host){let o=e.domain||e.host||e.hostname;if(o){let{host:a,hostname:s,pathname:l,port:u}=d(c("org.jitsi.meet://"+o));a&&(r.host=a,r.hostname=s,r.port=u),"/"===i&&"/"!==l&&(i=l)}}let h=e.roomName||e.room;!h||!r.pathname.endsWith("/")&&r.pathname.endsWith("/"+h)||(i.endsWith("/")||(i+="/"),i+=h),r.pathname=i;let{jwt:p}=e;if(p){let{search:g}=r;-1===g.indexOf("?jwt=")&&-1===g.indexOf("&jwt=")&&(g.startsWith("?")||(g="?"+g),1===g.length||(g+="&"),g+="jwt="+p,r.search=g)}let{hash:f}=r;for(let m of["config","interfaceConfig","devices","userInfo","appData"]){let v=function(e={}){let t=[];for(let r in e)try{t.push(`${r}=${encodeURIComponent(JSON.stringify(e[r]))}`)}catch(n){console.warn(`Error encoding ${r}: ${n}`)}return t}(e[m+"Overwrite"]||e[m]||e[m+"Override"]);if(v.length){let b=`${m}.${v.join(`&${m}.`)}`;f.length?b="&"+b:f="#",f+=b}}return r.hash=f,r.toString()||void 0}(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n,i;n=e,i=r[t],t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i})}return e}({},t,{url:`https://${e}/#jitsi_meet_external_api_id=${C}`}))}(e,{configOverwrite:a,interfaceConfigOverwrite:s,jwt:u,roomName:r,devices:g,userInfo:v,appData:{localStorageContent:y}}),this._createIFrame(i,n,h),this._transport=new m({backend:new f({postisOptions:{allowedOrigin:new URL(this._url).origin,scope:"jitsi_meet_external_api_"+C,window:this._frame.contentWindow}})}),Array.isArray(p)&&p.length>0&&this.invite(p),this._tmpE2EEKey=b,this._isLargeVideoVisible=!0,this._numberOfParticipants=0,this._participants={},this._myUserID=void 0,this._onStageParticipant=void 0,this._setupListeners(),C++}}}])}}]);