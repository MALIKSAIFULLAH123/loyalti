"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-livestreaming-components-WatchingUsers"],{43498(e,t,i){i.d(t,{Ui:()=>p,ET:()=>d}),i(96602);var r=i(96540),s=i(91557),n=i(70223),a=i(11497),l=i(656),o=i(78292);let u=new class{bootstrap(e,t){this.manager=e,this.settingApp=this.manager.getSetting("firebase"),this.settingApp&&this.init(this.settingApp,t)}checkActive(){return this.isActive}init(e,t){if(this.mounted)return this.firebaseApp;this.mounted=!0;let i={apiKey:s.z0J,authDomain:s.wRL,projectId:s.wWR,storageBucket:s.npo,messagingSenderId:s.AfL,appId:s.Kou};this.config=e;try{let r=(0,n.Wp)(i),a=(0,l.xI)(r),{user_firebase_email:o,user_firebase_password:u,requiredSignin:c}=this.settingApp||{};return c&&(0,l.x9)(a,o,u).then(e=>{}).catch(e=>{console.log("Live Video - Firebase signInWithEmailAndPassword error",e),"auth/user-not-found"===e.code&&(0,l.eJ)(a,o,u)}),t(!0),this.firebaseApp=r,this.isActive=!0,r}catch(f){this.isActive=!1}}getFirebaseApp(){return this.firebaseApp}getFirestore(){if(!this.firebaseApp)return null;if(!this.firestore){let e=(0,a.aU)(this.firebaseApp);e&&(this.firestore=e)}return this.firestore}getMessaging(){if(!this.firebaseApp)return null;if(!this.cloudMessage){let e=(0,o.dG)(this.firebaseApp);e&&(this.cloudMessage=e)}return this.cloudMessage}},c=!1,f=!1;function p(){let[e,t]=function(){let e=(0,s.PCX)(),[t,i]=r.useState(!1);return t||c||(c=!0,u.bootstrap(e,()=>{f=!0,i(!0)})),[t||f,u]}();if(!e)return!1;let i=t.getFirestore();return i}let h=(e,t)=>{let[i,s]=(0,r.useState)();return(0,r.useEffect)(()=>{let i;if(e&&(null==t?void 0:t.collection)&&(null==t?void 0:t.docID)){try{let r=(0,a.H9)(e,t.collection,t.docID);i=(0,a.aQ)(r,async e=>{s(e.data())})}catch(n){}return()=>{null==i||i()}}},[]),i},d=h},82318(e,t,i){i.r(t),i.d(t,{default:()=>g});var r=i(96540),s=i(3556),n=i(8051),a=i(87773),l=i(91557),o=i(40515),u=i(88980),c=i(43498);let f=(0,u.i7)`
    0% {transform: translateY(100%);}
    100% {transform: translateY(0);}
`,p="WatchingViewer",h=(0,s.Ay)(n.A,{name:p,slot:"animationWrapper",shouldForwardProp:e=>"isOwner"!==e})(({theme:e,spinner:t})=>({display:"inline-flex",animation:`${f} 1s forwards`})),d=(0,s.Ay)(n.A,{name:p,slot:"Wrapper"})(({theme:e})=>({display:"block",overflow:"hidden"})),g=(0,l.G5k)(function({streamKey:e,identity:t}){let{i18n:i,usePrevious:s}=(0,l.PCX)(),[u,f]=r.useState(0),[p,g]=r.useState(!1),m=(0,c.Ui)(),A=r.useRef(),v=(0,c.ET)(m,{collection:"live_video_view",docID:e}),b=(null==v?void 0:v.view)||[],w=s(b.length),E=b.length;if(r.useEffect(()=>{if(E&&u+1>=E){A.current=setTimeout(()=>{g(!0)},2e3);return}g(!1),clearTimeout(A.current),A.current=setTimeout(()=>{f(e=>e+1)},2e3)},[u]),r.useEffect(()=>{p&&E!==w&&(E>w&&g(!1),f(b.length-1))},[null==b?void 0:b.length]),p||!e||!(null==b?void 0:b.length))return null;let y=b[u];return y?r.createElement(d,{pt:1},r.createElement(h,{key:`${null==y?void 0:y.id}`,sx:{display:"flex"}},r.createElement(n.A,{mr:1},r.createElement(o.H8,{user:y,size:24})),r.createElement(n.A,null,r.createElement(a.A,{component:"span",variant:"body1"},i.formatMessage({id:"user_joined"},{user_name:null==y?void 0:y.full_name}))))):null})}}]);