"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-story-blocks-MainViewHome-Block"],{48068(e,t,i){i.r(t),i.d(t,{default:()=>Y});var n=i(91557),o=i(36249),r=i(85332),a=i(67725),l=i(3556),s=i(8051),d=i(2491),c=i(89481),u=i(96540),m=i(44562),p=i(88316),y=i(91262),g=i(71468),f=i(52705);let h="MainViewHomeSkeleton",v=(0,l.Ay)(s.A,{name:h})(({theme:e})=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",userSelect:"none",backgroundColor:"#000",paddingTop:e.spacing(1.5),flexDirection:"column","& .MuiSkeleton-root":{..."light"===e.palette.mode&&{backgroundColor:e.palette.grey.A200}}})),A=(0,l.Ay)(s.A,{name:h,slot:"root",shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,width:t})=>({position:"relative",margin:"auto",height:"100%",display:"flex",justifyContent:"center",flexDirection:"column",width:t})),b=(0,l.Ay)(s.A,{name:h})(({theme:e})=>({position:"absolute",top:0,left:0,right:0,zIndex:9999,width:"100%",display:"flex",alignItems:"center",padding:e.spacing(1.5),paddingTop:e.spacing(2),justifyContent:"space-between"})),x=(0,l.Ay)("div")(({theme:e})=>({display:"flex",alignItems:"center",overflow:"hidden"})),E=(0,l.Ay)(s.A)(({theme:e})=>({minHeight:64})),w=(0,l.Ay)(s.A,{shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,height:t,width:i})=>({backgroundColor:e.palette.grey["900"],borderRadius:e.shape.borderRadius,height:t,width:i}));function C({isMinHeight:e=!1,isSmallHeight:t=!1}){let i=u.useRef(),[n,o]=(0,r.Uf)(i);return u.createElement(v,null,u.createElement(A,{ref:i,width:n},u.createElement(b,null,u.createElement(x,null,u.createElement(f.A,{variant:"circular",width:e||t?36:48,height:e||t?36:48}),u.createElement(s.A,{ml:1},u.createElement(f.A,{variant:"text",sx:{fontSize:"1rem"},width:120}),u.createElement(f.A,{variant:"text",sx:{fontSize:"1rem"},width:90})))),u.createElement(w,{height:o,width:n})),u.createElement(E,null))}var S=i(62193),R=i.n(S),k=i(40515);let I="EmptyDataStory",P=(0,l.Ay)(s.A,{name:I,slot:"root"})(({theme:e})=>({display:"flex",flexDirection:"column",justifyContent:"center",padding:e.spacing(0,2),alignItems:"center"})),F=(0,l.Ay)(k.s4,{name:I,slot:"LineIconStyled"})(({theme:e})=>({fontSize:e.mixins.pxToRem(72),color:"#cecece",marginBottom:e.spacing(4)})),M=(0,l.Ay)(s.A,{name:I,slot:"TitleStyled"})(({theme:e})=>({color:"#fff",fontSize:e.mixins.pxToRem(24),fontWeight:e.typography.fontWeightBold,marginBottom:e.spacing(1.5),textAlign:"center",[e.breakpoints.down("xs")]:{fontSize:e.mixins.pxToRem(18)}})),_=(0,l.Ay)(s.A,{name:I,slot:"DescriptionStyled"})(({theme:e})=>({fontSize:e.mixins.pxToRem(18),color:e.palette.text.secondary,textAlign:"center",[e.breakpoints.down("xs")]:{fontSize:e.mixins.pxToRem(15)}}));function z({icon:e,title:t="no_content",description:i}){let{i18n:o}=(0,n.PCX)();return u.createElement(P,null,u.createElement(F,{icon:e}),u.createElement(M,null,u.createElement("span",null,o.formatMessage({id:t}))),i?u.createElement(_,null,o.formatMessage({id:i})):null)}var T=i(58859),j=i(24774),W=i(74050),B=i(5605);function D(){return(D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}let Z="MainViewHome",H=(0,l.Ay)(s.A,{name:Z,slot:"RootStyled"})(({theme:e})=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",userSelect:"none",backgroundColor:"#000",paddingTop:e.spacing(1.5),flexDirection:"column"})),L=(0,l.Ay)(s.A,{name:Z,slot:"ContentWrapper"})(({theme:e})=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flex:1,minHeight:0})),N=(0,l.Ay)(s.A,{name:Z})(({theme:e})=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",userSelect:"none",backgroundColor:"#000"})),O=(0,l.Ay)(s.A,{name:Z,slot:"HeaderContainer"})(({theme:e})=>({position:"absolute",top:0,left:0,right:0,zIndex:2,"&::before":{content:"''",position:"absolute",top:0,left:0,right:0,width:"100%",height:"100%",backgroundImage:"linear-gradient(180deg, rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.25), rgba(0, 0, 0, 0.08), transparent)",zIndex:-1,pointerEvents:"none"}})),V=(0,l.Ay)(s.A,{name:Z,slot:"ItemWrapper"})(({theme:e})=>({position:"relative",margin:"auto",backgroundColor:"#000",display:"flex",justifyContent:"center",borderRadius:e.shape.borderRadius,height:"100%"})),X=(0,l.Ay)("div",{name:Z,slot:"StoryImage",shouldForwardProp:e=>"width"!==e})(({theme:e,width:t})=>({height:"100%",width:t,position:"relative"})),U=(0,l.Ay)("div",{name:"Image",slot:"ImageWrapper",shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,height:t,width:i})=>({position:"relative",display:"flex",alignItems:"center",height:t,width:i,borderRadius:e.shape.borderRadius,overflow:"hidden"})),q=(0,l.Ay)("img",{name:Z,slot:"ImageThumbUrl",shouldForwardProp:e=>"width"!==e&&"height"!==e&&"type"!==e})(({theme:e,height:t,width:i,type:n})=>({borderRadius:e.shape.borderRadius,objectFit:"contain",position:"absolute",inset:0,width:"100%",height:"100%",filter:"blur(30px)",WebkitFilter:"blur(30px)",transform:"scale(2)"})),Q=(0,l.Ay)(s.A,{name:Z,slot:"StatisticItem"})(({theme:e})=>({position:"absolute",bottom:0,left:0,zIndex:2,padding:e.spacing(1.5,0),width:"100%",overflow:"hidden"})),$=(0,l.Ay)(s.A,{name:Z,slot:"StatisticComment",shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,width:t})=>({padding:e.spacing(0,1.5),overflow:"hidden",...t&&{width:t}})),G=(0,l.Ay)(s.A,{name:Z,slot:"StatisticComment",shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,width:t})=>({padding:e.spacing(0,1.5),overflow:"hidden",...t&&{width:t}})),K=(0,l.Ay)(s.A,{name:Z,slot:"MoreLinkWrapper"})(({theme:e})=>({display:"block",textAlign:"center",paddingTop:e.spacing(2),width:"100%"})),Y=(0,n.WvA)({extendBlock:function(){var e,t,i;let{assetUrl:l,jsxBackend:f,i18n:h,useGetItem:v}=(0,n.PCX)(),A=u.useRef(),b=(0,d.A)("(max-height:667px)"),x=(0,d.A)("(max-height:580px)"),[E,w]=(0,r.Uf)(A),S=(0,r.vC)(),{identityStoryActive:k,identityUserStoryActive:I,reactions:P,openStoryDetail:F,openViewComment:M,readyStateFile:_,fire:Z,isLastStory:Y,isReady:J,buffer:ee}=S||{},{hasPrev:et,hasNext:ei,handlePrev:en,handleNext:eo}=(0,r.P3)(),er=u.useRef(!1),ea=v(k),{reactions:el,related_comments:es,type:ed,background:ec,expand_link:eu}=ea||{},em=v(ec),ep=(0,g.d4)(e=>(0,n.qRQ)(e,m.Qz))||(0,n.KCW)(),ey=null==ep?void 0:ep.ids,eg=(0,a.AE)((null==em?void 0:em.image)||(null==ea?void 0:ea.thumbs)||(null==ea?void 0:ea.image),"50x50,50",l("story.no_image")),ef=f.get("story.ui.flyReaction"),eh=f.get("story.ui.statisticSendReaction"),ev=f.get("story.ui.commentStatisticStory");return(u.useEffect(()=>{if(F||M){Z({type:"setForcePause",payload:y.ZR.Force});return}Z({type:"setForcePause",payload:y.ZR.No})},[F,M,k]),u.useEffect(()=>{Z({type:"setOpenStoryDetail",payload:!1})},[I]),u.useEffect(()=>{var e;!er.current&&(null==ea?void 0:ea.in_process)&&!J&&(null===(e=window.navigator)||void 0===e?void 0:e.userActivation)&&!window.navigator.userActivation.hasBeenActive&&(er.current=!0)},[null==ea?void 0:ea.in_process,J]),null==ep?void 0:ep.initialized)?R()(ey)?u.createElement(N,null,u.createElement(z,{title:"no_stories_found",icon:"ico-story"})):Y?u.createElement(T.A,null):(null==ea?void 0:ea.in_process)||J||null===(e=window.navigator)||void 0===e||!e.userActivation||(null===(t=window.navigator)||void 0===t?void 0:null===(i=t.userActivation)||void 0===i?void 0:i.hasBeenActive)||er.current?u.createElement(H,null,u.createElement(p.bQ,null),u.createElement(L,null,u.createElement(W.A,{position:"left",show:et,onClick:en}),u.createElement(V,{style:{width:b?m.G9:"auto"}},u.createElement(X,{ref:A,width:E},u.createElement(O,null,u.createElement(o.A,{identity:k,isMinHeight:b,isSmallHeight:x})),u.createElement(U,{"data-testid":"imageWrapperStory",height:w,width:E},!_||ee?u.createElement(s.A,{sx:{position:"absolute",left:0,right:0,top:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255,255,255,0.5)",zIndex:2,...ee&&{background:"transparent"}}},u.createElement(c.A,{size:16,style:{color:"#fff"}})):null,u.createElement(q,{key:eg,src:eg,type:ed}),u.createElement(p.iq,{story:ea,height:w,width:E})),u.createElement(Q,{"data-testid":"statisticItem"},ev&&!R()(es)?u.createElement($,{width:E/2},u.createElement(ev,{identity:k,isMinHeight:b})):null,eh&&!R()(el)?u.createElement(G,{width:E},u.createElement(eh,{identity:k,isMinHeight:b})):null,eu&&u.createElement(K,null,u.createElement(B.A,{link:eu,isPreview:!1}))),ef&&u.createElement(ef,{identity:k,data:P})),u.createElement(p.ef,{item:ea,isMinHeight:b,open:F,setOpen:e=>Z({type:"setOpenStoryDetail",payload:e}),hideSlider:x}),u.createElement(p.Y5,{isMinHeight:b,setOpen:e=>Z({type:"setOpenViewComment",payload:e}),open:M,identity:k})),u.createElement(W.A,{position:"right",show:ei,onClick:eo})),u.createElement(p.CT,D({isMinHeight:b,width:E,identity:k},S))):u.createElement(j.A,null):C?u.createElement(C,{isMinHeight:b,isSmallHeight:x}):u.createElement("div",null,h.formatMessage({id:"loading_dots"}))},defaults:{}})},58859(e,t,i){i.d(t,{A:()=>E});var n=i(85332),o=i(3556),r=i(8051),a=i(60780),l=i(87773),s=i(81502),d=i(96540),c=i(43338),u=i(91557);let m="EndStoryView",p=(0,o.Ay)(r.A,{name:m})(({theme:e})=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",userSelect:"none",backgroundColor:"#000",paddingTop:e.spacing(1.5),flexDirection:"column","& .MuiSkeleton-root":{..."light"===e.palette.mode&&{backgroundColor:e.palette.grey.A200}}})),y=(0,o.Ay)(r.A,{name:m,slot:"root",shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,width:t,height:i})=>({position:"relative",margin:"auto",height:i||"100%",display:"flex",justifyContent:"center",flexDirection:"column",width:t})),g=(0,o.Ay)(r.A,{name:m})(({theme:e})=>({position:"absolute",top:0,left:0,right:0,zIndex:9999,width:"100%",display:"flex",alignItems:"center",padding:e.spacing(1.5),paddingTop:e.spacing(2),justifyContent:"space-between"})),f=(0,o.Ay)(r.A)(({theme:e})=>({minHeight:64})),h=(0,o.Ay)(r.A,{shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,height:t,width:i})=>({backgroundColor:e.palette.grey["900"],borderRadius:e.shape.borderRadius,height:t,width:i,display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",minWidth:"120px"})),v=(0,o.Ay)(a.A)(({theme:e})=>({width:"80%"})),A=(0,o.Ay)(l.A)(({theme:e})=>({color:"#fff",paddingTop:e.spacing(1.5),paddingBottom:e.spacing(1),fontSize:e.mixins.pxToRem(18),fontWeight:e.typography.fontWeightSemiBold})),b=(0,o.Ay)(l.A)(({theme:e})=>({color:"#fff",fontSize:e.mixins.pxToRem(14),paddingBottom:e.spacing(1.5),textAlign:"center",width:"80%"})),x=(0,o.Ay)(s.A,{name:m})(({theme:e})=>({width:"100%",borderRadius:e.shape.borderRadius/4,backgroundColor:"rgba(255, 255, 255, 0.5)","& .MuiLinearProgress-bar":{borderRadius:e.shape.borderRadius/2,backgroundColor:"rgba(255, 255, 255, 0.9)",transition:"transform .3s linear",transformOrigin:"left",willChange:"transform"}}));function E(){let{i18n:e,navigate:t}=(0,u.PCX)(),i=d.useRef(),o=d.useRef(0),[r,a]=d.useState(0);d.useEffect(()=>{let e=setInterval(()=>{o.current=o.current+.1,a(e=>e+.1),o.current>=10&&t("/")},100);return()=>{clearInterval(e)}},[]);let[l,s]=(0,n.Uf)(i),m=()=>{t("/story/add")},E=d.useCallback(()=>r>=10?100:Math.round(r/10*100)||0,[r,10]);return d.createElement(p,null,d.createElement(y,{ref:i,width:l,height:s},d.createElement(g,null,d.createElement(x,{variant:"determinate",value:E()})),d.createElement(h,{height:s,width:l},d.createElement(c.A,{title:"create_story",preventShowAvatar:!0}),d.createElement(A,{component:"h4"},e.formatMessage({id:"continue_story"})),d.createElement(b,{component:"span"},e.formatMessage({id:"create_story_description"})),d.createElement(v,{variant:"contained",size:"medium",color:"primary",onClick:m},e.formatMessage({id:"create_story"})))),d.createElement(f,null))}},24774(e,t,i){i.d(t,{A:()=>g});var n=i(91557),o=i(85332),r=i(3556),a=i(8051),l=i(87773),s=i(96540);let d="PenddingView",c=(0,r.Ay)(a.A,{name:d,slot:"root",shouldForwardProp:e=>"isDetailPage"!==e})(({theme:e,isDetailPage:t})=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",userSelect:"none",backgroundColor:"#000",paddingTop:e.spacing(1.5),flexDirection:"column",cursor:"pointer","& .MuiSkeleton-root":{..."light"===e.palette.mode&&{backgroundColor:e.palette.grey.A200}},...t&&{paddingTop:0}})),u=(0,r.Ay)(a.A,{name:d,slot:"ItemWrapper",shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,width:t})=>({position:"relative",margin:"auto",height:"100%",display:"flex",justifyContent:"center",flexDirection:"column",width:t})),m=(0,r.Ay)(l.A)(({theme:e})=>({color:"#fff",fontSize:e.mixins.pxToRem(14),paddingBottom:e.spacing(1.5),textAlign:"center",width:"80%"})),p=(0,r.Ay)(a.A,{name:d,slot:"ItemInteractionStyled",shouldForwardProp:e=>"isDetailPage"!==e&&"isOwner"!==e&&"isMobile"!==e})(({theme:e,isDetailPage:t,isOwner:i,isMobile:n})=>({minHeight:t?54:64,...(i||t&&n)&&{display:"none"}})),y=(0,r.Ay)(a.A,{name:d,slot:"ContentStyled",shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,height:t,width:i})=>({backgroundColor:e.palette.grey["900"],borderRadius:e.shape.borderRadius,height:t,width:i,display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",minWidth:"120px"}));function g({isDetailPage:e=!1,isOwner:t=!1}){let{i18n:i,useIsMobile:r,dispatch:a}=(0,n.PCX)(),{fire:l}=(0,o.vC)(),d=r(!0),g=s.useRef(),[f,h]=(0,o.Uf)(g),v=s.useCallback(()=>{l({type:"setReady",payload:!0}),l({type:"setMuted",payload:!1}),a({type:"story/updateMutedStatus",payload:!1})},[l]);return s.createElement(c,{isDetailPage:e},s.createElement(u,{ref:g,width:f},s.createElement(y,{height:h,width:f,onClick:v},s.createElement(m,{component:"span"},i.formatMessage({id:"click_to_view_story"})))),s.createElement(p,{isDetailPage:e,isOwner:t,isMobile:d}))}},43338(e,t,i){i.d(t,{A:()=>C});var n=i(91557),o=i(44562),r=i(91262),a=i(40515),l=i(67725),s=i(3556),d=i(8051),c=i(84058),u=i.n(c),m=i(96540);let p="AddItemCard",y=(0,s.Ay)(d.A,{name:p,slot:"root",shouldForwardProp:e=>"isMobile"!==e})(({theme:e,isMobile:t})=>({width:"140px",height:"250px",marginRight:e.spacing(1),borderRadius:e.shape.borderRadius,overflow:"hidden",position:"relative",background:e.palette.background.paper,cursor:"pointer",border:e.mixins.border("secondary")})),g=(0,s.Ay)(d.A,{name:p,slot:"RootAvatar"})(({theme:e})=>({marginRight:e.spacing(2),borderRadius:e.shape.borderRadius,overflow:"hidden",position:"relative",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"flex-start"})),f=(0,s.Ay)(d.A,{name:p,slot:"WrapperAvatar",shouldForwardProp:e=>"hasLiveVideo"!==e})(({theme:e,hasLiveVideo:t})=>({marginBottom:e.spacing(1),position:"relative",...t&&{marginBottom:0}})),h=(0,s.Ay)("img",{name:p,slot:"img"})(({theme:e})=>({width:"100%",height:"calc(100% - 50px)",objectFit:"cover"})),v=(0,s.Ay)("div",{name:p,slot:"background"})(({theme:e})=>({width:"100%",height:"calc(100% - 50px)",color:"#fff",fontSize:e.mixins.pxToRem(28),display:"flex",justifyContent:"center",alignItems:"center"})),A=(0,s.Ay)(d.A,{name:p,slot:"NewStory"})(({theme:e})=>({position:"absolute",bottom:0,height:"50px",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",fontWeight:e.typography.fontWeightSemiBold})),b=(0,s.Ay)(d.A,{name:p,slot:"ButtonAdd-mobile"})(({theme:e})=>({position:"absolute",bottom:0,right:0,width:"26px",height:"26px",backgroundColor:e.palette.primary.main,borderRadius:"50%",cursor:"pointer",borderStyle:"solid",borderColor:e.palette.background.paper,borderWidth:"1.5px",zIndex:99})),x=(0,s.Ay)(d.A,{name:p,slot:"ButtonAdd"})(({theme:e})=>({position:"absolute",top:0,left:"50%",transform:"translate(-50%, -50%)",width:"40px",height:"40px",backgroundColor:e.palette.primary.main,borderRadius:"50%",marginBottom:e.spacing(1.5),cursor:"pointer",borderStyle:"solid",borderColor:e.palette.background.paper,borderWidth:e.spacing(.5)})),E=(0,s.Ay)(a.s4,{shouldForwardProp:e=>"isMobile"!==e})(({theme:e,isMobile:t})=>({fontSize:e.mixins.pxToRem(16),color:"#fff",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",...t&&{fontSize:e.mixins.pxToRem(12)}})),w=(0,s.Ay)(d.A)(({theme:e})=>({fontSize:e.mixins.pxToRem(13),width:"100%",textAlign:"center",color:e.palette.primary.main})),C=function({title:e="create_story",preventShowAvatar:t=!1,canCreate:i=!0}){var s;let{useSession:c,i18n:p,navigate:C,getSetting:S}=(0,n.PCX)(),R=(0,n.alo)(!0),{user:k}=c(),{has_live_story:I}=k||{},P=S("story.home_page_style"),F=(0,l.cb)((null==k?void 0:k.full_name)||(null==k?void 0:k.title)),M=null!==(s=null==k?void 0:k.title)&&void 0!==s?s:(null==k?void 0:k.full_name)||"NaN",_=(0,l.AE)(null==k?void 0:k.avatar,"200x200"),z={};_||(z.backgroundColor=l.m6.hex(F||""));let T=null==k?void 0:k.can_view_story,j=()=>{C("/story/add")},W=()=>{if(T){C(`/story/${null==k?void 0:k.id}`);return}j()},B=e=>{e.stopPropagation(),j()};return(T||!T&&i)&&!t&&P===r.gw.Avatar?m.createElement(g,{"data-testid":u()("storyAddItemCard"),onClick:W,maxWidth:o.Zw},m.createElement(f,{hasLiveVideo:I},m.createElement(a.H8,{user:k,size:o.Zw,hoverCard:!1,noStory:!T,sx:{pointerEvents:"none"},showLiveStream:!0,showStatus:!1}),i?m.createElement(b,{"data-testid":u()("storyAddIconCard"),onClick:B},m.createElement(E,{icon:"ico-plus",isMobile:R})):null),m.createElement(w,{onClick:W},p.formatMessage({id:e}))):i?m.createElement(y,{"data-testid":u()("storyAddItemCard"),onClick:j,isMobile:R},_?m.createElement(h,{src:_,"data-testid":"storyImageAdd",alt:M,style:z}):m.createElement(v,{"data-testid":"storyImageAdd",style:z},m.createElement("span",null,F)),m.createElement(A,null,m.createElement(x,null,m.createElement(E,{icon:"ico-plus"})),m.createElement(d.A,{mt:2},p.formatMessage({id:e})))):null}},36249(e,t,i){i.d(t,{A:()=>D});var n=i(91557),o=i(85332),r=i(91262),a=i(40515),l=i(3556),s=i(8051),d=i(63461),c=i(60780),u=i(97763),m=i(96540),p=i(71149);let y=(0,l.Ay)(d.A)(({theme:e})=>({color:"#fff"})),g=m.memo(({identity:e,contextStory:t,onDeleteSuccess:i})=>{let{i18n:l,dispatch:d}=(0,n.PCX)(),{pauseStatus:c,openStoryDetail:p,openViewComment:g,openActionItem:f,fire:h}=t,{handleNext:v,handlePrev:A,hasNext:b}=(0,o.P3)(),[x]=(0,n.Vd3)(e,{}),E=(t,n,o)=>{if(/deleteItem|mute/.test(t)){d({type:t,payload:{identity:e},meta:{onSuccess:()=>i({nextStory:!!/mute/.test(t)})}});return}x(t,n,o)},[w,C]=m.useState(!1),S=e=>{C(e)};return m.useEffect(()=>{c===r.ZR.Force||f||h({type:"setForcePause",payload:w?r.ZR.Pause:r.ZR.No})},[w,f]),m.useEffect(()=>{h({type:"setForcePause",payload:r.ZR.No})},[e]),m.useEffect(()=>{if(f||w||p||g)return;let e=e=>{let{keyCode:t}=e;if(37===t){A();return}b&&39===t&&v(),32===t&&h({type:"setForcePause",payload:c===r.ZR.No?r.ZR.Pause:r.ZR.No})};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[b,A,v,c,p,g,w,f]),m.createElement(m.Fragment,null,m.createElement(s.A,{sx:w?{position:"fixed",top:0,left:0,right:0,bottom:0}:{}}),m.createElement(a.pN,{triggerOpen:S,identity:e,handleAction:E,tabIndex:1,control:m.createElement(u.A,{title:l.formatMessage({id:"more_options"}),placement:"bottom"},m.createElement(y,{size:"medium",disableRipple:!0,disableFocusRipple:!0},m.createElement(a.s4,{icon:"ico-dottedmore"})))}))},(e,t)=>{var i,n;return(null==e?void 0:e.identity)===(null==t?void 0:t.identity)&&(null==e?void 0:null===(i=e.contextStory)||void 0===i?void 0:i.pauseStatus)===(null==t?void 0:null===(n=t.contextStory)||void 0===n?void 0:n.pauseStatus)&&(null==e?void 0:e.contextStory)===(null==t?void 0:t.contextStory)});var f=i(44562),h=i(81502),v=i(62193),A=i.n(v),b=i(2404),x=i.n(b);let E="progress-story",w=(0,l.Ay)("div")(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"})),C=(0,l.Ay)(s.A,{name:E})(({theme:e})=>({width:"100%",marginRight:e.spacing(.5),"&:last-child":{marginRight:e.spacing(0)}})),S=(0,l.Ay)(h.A,{name:E})(({theme:e})=>({borderRadius:e.shape.borderRadius/4,backgroundColor:"rgba(255, 255, 255, 0.5)","& .MuiLinearProgress-bar":{borderRadius:e.shape.borderRadius/2,backgroundColor:"rgba(255, 255, 255, 0.9)",transition:"transform .3s linear",transformOrigin:"left",willChange:"transform"}})),R=function({identity:e}){let{useGetItem:t,useGetItems:i,getAcl:a,navigate:l}=(0,n.PCX)(),s=a("story.story.create"),{hasNext:d}=(0,o.P3)(),c=m.useRef(0),[u,p]=m.useState(0),y=m.useRef(),g=m.useRef(0),h=(0,o.vC)(),{identityUserStoryActive:v,identityStoryActive:b,pauseStatus:E,indexStoryActive:R,listUserStories:k,readyStateFile:I,progressVideoPlay:P,fire:F,durationVideo:M}=h||{},_=t(e||b),{duration:z,type:T,in_process:j}=_||{},W=M||z||f.oL,B=("video"!==T||!j)&&"photo"!==T&&"text"!==T,D=t(v),Z=i(null==D?void 0:D.stories),H=m.useRef(0);m.useEffect(()=>{B&&(g.current=P)},[B,P]);let L=()=>{if(!A()(_)){if(clearInterval(y.current),B){y.current=setInterval(()=>{if(!(0===g.current||x()(g.current,H.current))&&(H.current=g.current,p(e=>e+.1),parseFloat(parseFloat(g.current).toFixed(1))>=parseFloat(parseFloat(W).toFixed(1)))){var e;c.current=R+1,F({type:"setIdentityStoryActive",payload:null==Z?void 0:null===(e=Z[c.current])||void 0===e?void 0:e._identity})}},100);return}y.current=setInterval(()=>{if(g.current=g.current+.1,p(e=>e+.1),g.current>=W){var e;c.current=R+1,F({type:"setIdentityStoryActive",payload:null==Z?void 0:null===(e=Z[c.current])||void 0===e?void 0:e._identity})}},100)}},N=()=>{g.current=0,p(0),clearInterval(y.current),E!==r.ZR.Force&&(F({type:"setForcePause",payload:r.ZR.No}),L())},O=()=>{clearInterval(y.current)},V=()=>{L()},X=()=>{g.current=0,p(0),F({type:"setProgressVideoPlay",payload:0}),F({type:"setForcePause",payload:r.ZR.No}),clearInterval(y.current)};m.useEffect(()=>{if(E!==r.ZR.No){O();return}V()},[E]),m.useEffect(()=>{let e=B?parseFloat(parseFloat(g.current).toFixed(1))>=parseFloat(parseFloat(W).toFixed(1)):u>=W-.1;if(R===Z.length-1&&e){if(!d){if(s){F({type:"setLastStory",payload:!0});return}l("/");return}let t=null==k?void 0:k.findIndex(e=>(null==D?void 0:D.id)===(null==e?void 0:e.id));if(k[t+1]){var i;F({type:"setIdentityUserS_Active",payload:null===(i=k[t+1])||void 0===i?void 0:i._identity})}c.current=0;return}},[u,R,null==_?void 0:_.id,Z,k,null==D?void 0:D.id,d,B,W]),m.useEffect(()=>{(null==Z?void 0:Z.length)&&X()},[null==D?void 0:D.id]),m.useEffect(()=>{if(I&&_)return N(),()=>{X()}},[null==_?void 0:_.id,I]);let U=m.useCallback(e=>{if(e<R)return 100;if(e===R){if(u>=W)return;return Math.round(u/W*100)||0}if(e>R)return 0},[u,R]);return m.createElement(w,{"data-testid":"progressStoryBlock"},Z.map((e,t)=>m.createElement(C,{key:null==e?void 0:e.id},m.createElement(S,{variant:"determinate",value:U(t)}))))};var k=i(84058),I=i.n(k);let P="HeaderStory",F=(0,l.Ay)(s.A,{name:P})(({theme:e})=>({width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",flexDirection:"column",padding:e.spacing(1.5)})),M=(0,l.Ay)(s.A,{name:P,shouldForwardProp:e=>"isTypeLiveVideo"!==e})(({theme:e,isTypeLiveVideo:t})=>({width:"100%",height:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",padding:e.spacing(1.5,0),...t&&{paddingBottom:e.spacing(1)}})),_=(0,l.Ay)("div")(({theme:e})=>({display:"flex",alignItems:"center",maxWidth:"70%",overflow:"hidden"})),z=(0,l.Ay)("div")(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"center"})),T=(0,l.Ay)(d.A)(({theme:e})=>({color:"#fff"})),j=(0,l.Ay)("div",{name:P,slot:"PrivacyBlockStyled"})(({theme:e})=>({display:"flex",flexDirection:"row",alignItems:"center",fontSize:e.mixins.pxToRem(13),paddingTop:"0.25em"})),W=(0,l.Ay)(c.A,{name:P,slot:"ButtonStyled"})(({theme:e})=>({alignSelf:"flex-start",color:"#fff",fontWeight:e.typography.fontWeightMedium,borderColor:"#fff","&:hover":{borderColor:e.palette.border.secondary}})),B=(0,l.Ay)("div",{name:P,slot:"SeparateSpanStyled"})(({theme:e})=>({color:"rgba(255, 255, 255, 0.9)",display:"flex",alignItems:"center","& span + span:before":{content:'"\xb7"',display:"inline-block",padding:`${e.spacing(0,.5)}`}})),D=(0,m.memo)(function({identity:e,isMinHeight:t=!1,isSmallHeight:i=!1}){let{navigate:l,i18n:d,useIsMobile:c,goSmartBack:y,useGetItem:h,useGetItems:v,useTheme:A,dispatch:b}=(0,n.PCX)(),x=A(),E=c(!0),w=()=>{y()},C=(0,o.vC)(),{identityUserStoryActive:S,identityStoryActive:k,pauseStatus:P,mutedStatus:D=!0,indexStoryActive:Z,listUserStories:H,fire:L}=C||{},N=h(S),O=v(null==N?void 0:N.stories),V=h(e||k),{_identity:X,privacy:U,modification_date:q,type:Q,extra_params:$,in_process:G}=V||{},{is_streaming:K}=$||{},Y=Q===f.UZ,J=()=>{if(P!==r.ZR.No){L({type:"setForcePause",payload:r.ZR.No});return}L({type:"setForcePause",payload:r.ZR.Force})},ee=()=>{L({type:"setMuted",payload:!D}),b({type:"story/updateMutedStatus",payload:!D})},et=m.useCallback(({nextStory:e})=>{var t,i;let n=(null==N?void 0:N.stories.length)-1===Z||e,o=null==H?void 0:H.findIndex(e=>(null==e?void 0:e.id)===(null==N?void 0:N.id)),r=(null==H?void 0:H.length)-1===o&&n;if(r){l("/");return}if(n){L({type:"setIdentityUserS_Active",payload:null===(i=H[o+1])||void 0===i?void 0:i._identity});return}L({type:"setIdentityStoryActive",payload:null==O?void 0:null===(t=O[Z+1])||void 0===t?void 0:t._identity})},[null==N?void 0:N.stories,null==N?void 0:N.id,Z,H,O]),ei=()=>{Y&&(null==V?void 0:V.item_id)&&l(`/live-video/${null==V?void 0:V.item_id}`)};return m.createElement(F,{"data-testid":"headerStoryBlock"},m.createElement(R,{identity:e}),m.createElement(M,{isTypeLiveVideo:Y},m.createElement(_,null,m.createElement(a.H8,{user:N,size:t||i?36:48,noStory:!0,showLiveStream:!0,showStatus:!1}),i?null:m.createElement(s.A,{ml:1,overflow:"hidden"},m.createElement(a.mE,{lines:1,style:{color:"#fff"},variant:"h5"},m.createElement(a.xE,{user:N})),Y?m.createElement(a.mE,{lines:1,variant:"body1",style:{color:"rgba(255, 255, 255, 0.9)",fontSize:x.mixins.pxToRem(13),paddingTop:"0.25em"}},d.formatMessage({id:K?"live_now":"recorded_live"})):null,m.createElement(j,null,m.createElement(B,null,m.createElement(p.A,{value:q,shorten:!0}),m.createElement(a.g6,{value:U}))))),m.createElement(z,{"data-testid":"actionStoryBlock"},m.createElement(T,{"data-testid":I()("icon button"),size:"smaller",onClick:J},P===r.ZR.No?m.createElement(u.A,{title:d.formatMessage({id:"pause"}),placement:"bottom"},m.createElement(a.s4,{icon:"ico-pause"})):m.createElement(u.A,{title:d.formatMessage({id:"play"}),placement:"bottom"},m.createElement(a.s4,{icon:"ico-play"}))),"video"===Q&&G||"photo"===Q||"text"===Q||G?null:m.createElement(T,{size:"medium",onClick:ee},D?m.createElement(u.A,{title:d.formatMessage({id:"unmute"}),placement:"bottom"},m.createElement(a.s4,{icon:"ico-volume-del"})):m.createElement(u.A,{title:d.formatMessage({id:"mute"}),placement:"bottom"},m.createElement(a.s4,{icon:"ico-volume-increase"}))),m.createElement(g,{identity:X,contextStory:C,onDeleteSuccess:et}),E?m.createElement(T,{onClick:w,size:"medium"},m.createElement(a.s4,{icon:"ico-close"})):null)),Y?m.createElement(W,{role:"button","data-testid":"buttonWatchVideo",variant:"outlined",size:"small",disableRipple:!0,onClick:ei},d.formatMessage({id:K?"watch_live_video":"watch_video"})):null)},(e,t)=>e.identity===t.identity)},5605(e,t,i){i.d(t,{A:()=>d});var n=i(91557),o=i(3556),r=i(96540),a=i(91262);let l=(0,o.Ay)(n.vxq,{name:"seeMoreLinkStory",slot:"SeeMoreLink",shouldForwardProp:e=>"isPreview"!==e})(({theme:e,isPreview:t})=>({...t&&{position:"absolute",left:"50%",bottom:16,transform:"translate(-50%, 0)"},color:"#fff",borderColor:"#fff",borderRadius:e.spacing(3),zIndex:3})),s=({link:e,sx:t,variant:i="outlined",fire:o,isPreview:s=!0})=>{let{i18n:d}=(0,n.PCX)();if(!e)return;let c=()=>{o&&o({type:"setForcePause",payload:a.ZR.No})},u=()=>{o&&o({type:"setForcePause",payload:a.ZR.Pause})};return r.createElement(l,{isPreview:s,to:e,variant:i,sx:t,onClick:u,onCancel:c},d.formatMessage({id:"visit_link"}))},d=s}}]);