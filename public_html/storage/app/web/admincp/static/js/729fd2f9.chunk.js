"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-story-blocks-MainViewHomeMobile-Block"],{58859(e,t,i){i.d(t,{A:()=>w});var o=i(85332),n=i(3556),r=i(8051),l=i(60780),a=i(87773),s=i(81502),d=i(96540),c=i(43338),u=i(91557);let m="EndStoryView",p=(0,n.Ay)(r.A,{name:m})(({theme:e})=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",userSelect:"none",backgroundColor:"#000",paddingTop:e.spacing(1.5),flexDirection:"column","& .MuiSkeleton-root":{..."light"===e.palette.mode&&{backgroundColor:e.palette.grey.A200}}})),y=(0,n.Ay)(r.A,{name:m,slot:"root",shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,width:t,height:i})=>({position:"relative",margin:"auto",height:i||"100%",display:"flex",justifyContent:"center",flexDirection:"column",width:t})),g=(0,n.Ay)(r.A,{name:m})(({theme:e})=>({position:"absolute",top:0,left:0,right:0,zIndex:9999,width:"100%",display:"flex",alignItems:"center",padding:e.spacing(1.5),paddingTop:e.spacing(2),justifyContent:"space-between"})),f=(0,n.Ay)(r.A)(({theme:e})=>({minHeight:64})),h=(0,n.Ay)(r.A,{shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,height:t,width:i})=>({backgroundColor:e.palette.grey["900"],borderRadius:e.shape.borderRadius,height:t,width:i,display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",minWidth:"120px"})),v=(0,n.Ay)(l.A)(({theme:e})=>({width:"80%"})),A=(0,n.Ay)(a.A)(({theme:e})=>({color:"#fff",paddingTop:e.spacing(1.5),paddingBottom:e.spacing(1),fontSize:e.mixins.pxToRem(18),fontWeight:e.typography.fontWeightSemiBold})),b=(0,n.Ay)(a.A)(({theme:e})=>({color:"#fff",fontSize:e.mixins.pxToRem(14),paddingBottom:e.spacing(1.5),textAlign:"center",width:"80%"})),x=(0,n.Ay)(s.A,{name:m})(({theme:e})=>({width:"100%",borderRadius:e.shape.borderRadius/4,backgroundColor:"rgba(255, 255, 255, 0.5)","& .MuiLinearProgress-bar":{borderRadius:e.shape.borderRadius/2,backgroundColor:"rgba(255, 255, 255, 0.9)",transition:"transform .3s linear",transformOrigin:"left",willChange:"transform"}}));function w(){let{i18n:e,navigate:t}=(0,u.PCX)(),i=d.useRef(),n=d.useRef(0),[r,l]=d.useState(0);d.useEffect(()=>{let e=setInterval(()=>{n.current=n.current+.1,l(e=>e+.1),n.current>=10&&t("/")},100);return()=>{clearInterval(e)}},[]);let[a,s]=(0,o.Uf)(i),m=()=>{t("/story/add")},w=d.useCallback(()=>r>=10?100:Math.round(r/10*100)||0,[r,10]);return d.createElement(p,null,d.createElement(y,{ref:i,width:a,height:s},d.createElement(g,null,d.createElement(x,{variant:"determinate",value:w()})),d.createElement(h,{height:s,width:a},d.createElement(c.A,{title:"create_story",preventShowAvatar:!0}),d.createElement(A,{component:"h4"},e.formatMessage({id:"continue_story"})),d.createElement(b,{component:"span"},e.formatMessage({id:"create_story_description"})),d.createElement(v,{variant:"contained",size:"medium",color:"primary",onClick:m},e.formatMessage({id:"create_story"})))),d.createElement(f,null))}},24774(e,t,i){i.d(t,{A:()=>g});var o=i(91557),n=i(85332),r=i(3556),l=i(8051),a=i(87773),s=i(96540);let d="PenddingView",c=(0,r.Ay)(l.A,{name:d,slot:"root",shouldForwardProp:e=>"isDetailPage"!==e})(({theme:e,isDetailPage:t})=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",userSelect:"none",backgroundColor:"#000",paddingTop:e.spacing(1.5),flexDirection:"column",cursor:"pointer","& .MuiSkeleton-root":{..."light"===e.palette.mode&&{backgroundColor:e.palette.grey.A200}},...t&&{paddingTop:0}})),u=(0,r.Ay)(l.A,{name:d,slot:"ItemWrapper",shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,width:t})=>({position:"relative",margin:"auto",height:"100%",display:"flex",justifyContent:"center",flexDirection:"column",width:t})),m=(0,r.Ay)(a.A)(({theme:e})=>({color:"#fff",fontSize:e.mixins.pxToRem(14),paddingBottom:e.spacing(1.5),textAlign:"center",width:"80%"})),p=(0,r.Ay)(l.A,{name:d,slot:"ItemInteractionStyled",shouldForwardProp:e=>"isDetailPage"!==e&&"isOwner"!==e&&"isMobile"!==e})(({theme:e,isDetailPage:t,isOwner:i,isMobile:o})=>({minHeight:t?54:64,...(i||t&&o)&&{display:"none"}})),y=(0,r.Ay)(l.A,{name:d,slot:"ContentStyled",shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,height:t,width:i})=>({backgroundColor:e.palette.grey["900"],borderRadius:e.shape.borderRadius,height:t,width:i,display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",minWidth:"120px"}));function g({isDetailPage:e=!1,isOwner:t=!1}){let{i18n:i,useIsMobile:r,dispatch:l}=(0,o.PCX)(),{fire:a}=(0,n.vC)(),d=r(!0),g=s.useRef(),[f,h]=(0,n.Uf)(g),v=s.useCallback(()=>{a({type:"setReady",payload:!0}),a({type:"setMuted",payload:!1}),l({type:"story/updateMutedStatus",payload:!1})},[a]);return s.createElement(c,{isDetailPage:e},s.createElement(u,{ref:g,width:f},s.createElement(y,{height:h,width:f,onClick:v},s.createElement(m,{component:"span"},i.formatMessage({id:"click_to_view_story"})))),s.createElement(p,{isDetailPage:e,isOwner:t,isMobile:d}))}},90864(e,t,i){i.r(t),i.d(t,{default:()=>N});var o=i(91557),n=i(36249),r=i(85332),l=i(67725),a=i(8051),s=i(2491),d=i(3556),c=i(96540),u=i(44562),m=i(88316),p=i(91262),y=i(71468),g=i(48603),f=i(62193),h=i.n(f),v=i(40515);let A="EmptyDataStory",b=(0,d.Ay)(a.A,{name:A,slot:"root"})(({theme:e})=>({display:"flex",flexDirection:"column",justifyContent:"center",padding:e.spacing(0,2),alignItems:"center"})),x=(0,d.Ay)(v.s4,{name:A,slot:"LineIconStyled"})(({theme:e})=>({fontSize:e.mixins.pxToRem(72),color:"#cecece",marginBottom:e.spacing(4)})),w=(0,d.Ay)(a.A,{name:A,slot:"TitleStyled"})(({theme:e})=>({color:"#fff",fontSize:e.mixins.pxToRem(24),fontWeight:e.typography.fontWeightBold,marginBottom:e.spacing(1.5),textAlign:"center",[e.breakpoints.down("xs")]:{fontSize:e.mixins.pxToRem(18)}})),E=(0,d.Ay)(a.A,{name:A,slot:"DescriptionStyled"})(({theme:e})=>({fontSize:e.mixins.pxToRem(18),color:e.palette.text.secondary,textAlign:"center",[e.breakpoints.down("xs")]:{fontSize:e.mixins.pxToRem(15)}}));function C({icon:e,title:t="no_content",description:i}){let{i18n:n}=(0,o.PCX)();return c.createElement(b,null,c.createElement(x,{icon:e}),c.createElement(w,null,c.createElement("span",null,n.formatMessage({id:t}))),i?c.createElement(E,null,n.formatMessage({id:i})):null)}var S=i(58859),R=i(24774),k=i(5605);function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e}).apply(this,arguments)}let P="MainViewHomeMobile",F=(0,d.Ay)(a.A,{name:P,slot:"RootStyled"})(({theme:e})=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",userSelect:"none",backgroundColor:"#000",paddingTop:e.spacing(1.5),flexDirection:"column"})),M=(0,d.Ay)(a.A,{name:P,slot:"ContentWrapper"})(({theme:e})=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flex:1,minHeight:0})),_=(0,d.Ay)(a.A,{name:P})(({theme:e})=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",userSelect:"none",backgroundColor:"#000"})),z=(0,d.Ay)(a.A,{name:P,slot:"HeaderContainer"})(({theme:e})=>({position:"absolute",top:0,left:0,right:0,zIndex:2,"&::before":{content:"''",position:"absolute",top:0,left:0,right:0,width:"100%",height:"100%",backgroundImage:"linear-gradient(180deg, rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.25), rgba(0, 0, 0, 0.08), transparent)",zIndex:-1,pointerEvents:"none"}})),T=(0,d.Ay)(a.A,{name:P,slot:"ItemWrapper"})(({theme:e})=>({position:"relative",margin:"auto",backgroundColor:"#000",display:"flex",justifyContent:"center",borderRadius:e.shape.borderRadius,height:"100%"})),j=(0,d.Ay)("div",{name:P,slot:"StoryImage",shouldForwardProp:e=>"width"!==e})(({theme:e,width:t})=>({height:"100%",width:t,position:"relative"})),W=(0,d.Ay)("div",{name:"Image",slot:"ImageWrapper",shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,height:t,width:i})=>({position:"relative",display:"flex",alignItems:"center",height:t,width:i,borderRadius:e.shape.borderRadius,overflow:"hidden"})),B=(0,d.Ay)("img",{name:P,slot:"ImageThumbUrl",shouldForwardProp:e=>"width"!==e&&"height"!==e&&"type"!==e})(({theme:e,height:t,width:i,type:o})=>({borderRadius:e.shape.borderRadius,objectFit:"contain",position:"absolute",inset:0,width:"100%",height:"100%",filter:"blur(30px)",WebkitFilter:"blur(30px)",transform:"scale(2)"})),D=(0,d.Ay)(a.A,{name:P,slot:"StatisticItem"})(({theme:e})=>({position:"absolute",bottom:0,left:0,zIndex:2,padding:e.spacing(1.5,0),width:"100%",overflow:"hidden"})),Z=(0,d.Ay)(a.A,{name:P,slot:"StatisticComment",shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,width:t})=>({padding:e.spacing(0,1.5),overflow:"hidden",...t&&{width:t}})),H=(0,d.Ay)(a.A,{name:P,slot:"StatisticComment",shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,width:t})=>({padding:e.spacing(0,1.5),overflow:"hidden",...t&&{width:t}})),L=(0,d.Ay)(a.A,{name:P,slot:"MoreLinkWrapper"})(({theme:e})=>({display:"block",textAlign:"center",paddingTop:e.spacing(2),width:"100%"})),N=(0,o.WvA)({extendBlock:function(){var e,t,i;let{assetUrl:d,jsxBackend:f,useGetItem:v}=(0,o.PCX)(),A=c.useRef(),b=c.useRef(!1),x=(0,s.A)("(max-height:667px)"),w=(0,s.A)("(max-height:580px)"),[E,P]=(0,r.Uf)(A),N=(0,r.vC)(),{identityStoryActive:O,identityUserStoryActive:V,reactions:X,openStoryDetail:U,openViewComment:q,readyStateFile:$,fire:G,isLastStory:K,isReady:Q,buffer:Y}=N||{},{hasPrev:J,hasNext:ee,handlePrev:et,handleNext:ei}=(0,r.P3)(),eo=v(O),{reactions:en,related_comments:er,background:el,expand_link:ea}=eo||{},es=v(el),ed=(0,y.d4)(e=>(0,o.qRQ)(e,u.Qz))||(0,o.KCW)(),{initialized:ec}=null!=ed?ed:{},eu=null==ed?void 0:ed.ids,em=f.get("story.ui.flyReaction"),ep=f.get("story.ui.statisticSendReaction"),ey=f.get("story.ui.commentStatisticStory"),eg=c.useMemo(()=>ey&&!h()(er)&&!w,[ey,er,w]),ef=(0,l.AE)((null==es?void 0:es.image)||(null==eo?void 0:eo.thumbs)||(null==eo?void 0:eo.image),"50x50,50",d("story.no_image"));return(c.useEffect(()=>{if(U||q){G({type:"setForcePause",payload:p.ZR.Force});return}G({type:"setForcePause",payload:p.ZR.No})},[U,q,O]),c.useEffect(()=>{G({type:"setOpenStoryDetail",payload:!1})},[V]),c.useEffect(()=>{var e;!b.current&&(null==eo?void 0:eo.in_process)&&!Q&&(null===(e=window.navigator)||void 0===e?void 0:e.userActivation)&&!window.navigator.userActivation.hasBeenActive&&(b.current=!0)},[null==eo?void 0:eo.in_process,Q]),ec)?h()(eu)?c.createElement(_,null,c.createElement(C,{title:"no_stories_found",icon:"ico-story"})):K?c.createElement(S.A,null):(null==eo?void 0:eo.in_process)||Q||null===(e=window.navigator)||void 0===e||!e.userActivation||(null===(t=window.navigator)||void 0===t?void 0:null===(i=t.userActivation)||void 0===i?void 0:i.hasBeenActive)||b.current?c.createElement(F,null,c.createElement(M,null,c.createElement(m.j7,{position:"left",show:J,onClick:et}),c.createElement(T,{style:{width:x?u.G9:"auto",height:P||"100%"}},c.createElement(j,{ref:A,width:E},c.createElement(z,null,c.createElement(n.A,{identity:O,isMinHeight:x,isSmallHeight:w})),c.createElement(W,{height:P,width:E},!$||Y?c.createElement(m.wK,null):null,c.createElement(B,{key:ef,src:ef}),c.createElement(m.iq,{story:eo,height:P,width:E})),c.createElement(D,null,eg?c.createElement(Z,{width:E/2},c.createElement(ey,{identity:O})):null,ep&&!h()(en)?c.createElement(H,{width:E},c.createElement(ep,{identity:O})):null,ea&&c.createElement(L,null,c.createElement(k.A,{link:ea,fire:G,isPreview:!1}))),em&&c.createElement(em,{identity:O,data:X}))),c.createElement(m.j7,{position:"right",show:ee,onClick:ei})),c.createElement(m.ef,{item:eo,isMinHeight:x,open:U,setOpen:e=>G({type:"setOpenStoryDetail",payload:e}),hideSlider:w}),c.createElement(m.Y5,{isMinHeight:x,setOpen:e=>G({type:"setOpenViewComment",payload:e}),open:q,identity:O}),U||q?c.createElement(a.A,{minHeight:64}):c.createElement(m.CT,I({isMinHeight:x,width:x?u.G9:E,identity:O},N))):c.createElement(R.A,null):c.createElement(g.default,{isMinHeight:x,isSmallHeight:w})},defaults:{}})},48603(e,t,i){i.r(t),i.d(t,{default:()=>g});var o=i(85332),n=i(3556),r=i(8051),l=i(52705),a=i(96540);let s="MainViewHomeMobileSkeleton",d=(0,n.Ay)(r.A,{name:s})(({theme:e})=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",userSelect:"none",backgroundColor:"#000",paddingTop:e.spacing(1.5),flexDirection:"column","& .MuiSkeleton-root":{..."light"===e.palette.mode&&{backgroundColor:e.palette.grey.A200}}})),c=(0,n.Ay)(r.A,{name:s,slot:"root",shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,width:t,height:i})=>({position:"relative",margin:"auto",height:i||"100%",display:"flex",justifyContent:"center",flexDirection:"column",width:t})),u=(0,n.Ay)(r.A,{name:s})(({theme:e})=>({position:"absolute",top:0,left:0,right:0,zIndex:9999,width:"100%",display:"flex",alignItems:"center",padding:e.spacing(1.5),paddingTop:e.spacing(2),justifyContent:"space-between"})),m=(0,n.Ay)("div")(({theme:e})=>({display:"flex",alignItems:"center",maxWidth:"70%",overflow:"hidden"})),p=(0,n.Ay)(r.A)(({theme:e})=>({minHeight:64})),y=(0,n.Ay)(r.A,{shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,height:t,width:i})=>({backgroundColor:e.palette.grey["900"],borderRadius:e.shape.borderRadius,height:t,width:i}));function g({isMinHeight:e=!1,isSmallHeight:t=!1}){let i=a.useRef(),[n,s]=(0,o.Uf)(i);return a.createElement(d,null,a.createElement(c,{ref:i,width:n,height:s},a.createElement(u,null,a.createElement(m,null,a.createElement(l.A,{variant:"circular",width:e||t?36:48,height:e||t?36:48}),a.createElement(r.A,{ml:1},a.createElement(l.A,{variant:"text",sx:{fontSize:"1rem"},width:120}),a.createElement(l.A,{variant:"text",sx:{fontSize:"1rem"},width:90})))),a.createElement(y,{height:s,width:n})),a.createElement(p,null))}},43338(e,t,i){i.d(t,{A:()=>C});var o=i(91557),n=i(44562),r=i(91262),l=i(40515),a=i(67725),s=i(3556),d=i(8051),c=i(84058),u=i.n(c),m=i(96540);let p="AddItemCard",y=(0,s.Ay)(d.A,{name:p,slot:"root",shouldForwardProp:e=>"isMobile"!==e})(({theme:e,isMobile:t})=>({width:"140px",height:"250px",marginRight:e.spacing(1),borderRadius:e.shape.borderRadius,overflow:"hidden",position:"relative",background:e.palette.background.paper,cursor:"pointer",border:e.mixins.border("secondary")})),g=(0,s.Ay)(d.A,{name:p,slot:"RootAvatar"})(({theme:e})=>({marginRight:e.spacing(2),borderRadius:e.shape.borderRadius,overflow:"hidden",position:"relative",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"flex-start"})),f=(0,s.Ay)(d.A,{name:p,slot:"WrapperAvatar",shouldForwardProp:e=>"hasLiveVideo"!==e})(({theme:e,hasLiveVideo:t})=>({marginBottom:e.spacing(1),position:"relative",...t&&{marginBottom:0}})),h=(0,s.Ay)("img",{name:p,slot:"img"})(({theme:e})=>({width:"100%",height:"calc(100% - 50px)",objectFit:"cover"})),v=(0,s.Ay)("div",{name:p,slot:"background"})(({theme:e})=>({width:"100%",height:"calc(100% - 50px)",color:"#fff",fontSize:e.mixins.pxToRem(28),display:"flex",justifyContent:"center",alignItems:"center"})),A=(0,s.Ay)(d.A,{name:p,slot:"NewStory"})(({theme:e})=>({position:"absolute",bottom:0,height:"50px",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",fontWeight:e.typography.fontWeightSemiBold})),b=(0,s.Ay)(d.A,{name:p,slot:"ButtonAdd-mobile"})(({theme:e})=>({position:"absolute",bottom:0,right:0,width:"26px",height:"26px",backgroundColor:e.palette.primary.main,borderRadius:"50%",cursor:"pointer",borderStyle:"solid",borderColor:e.palette.background.paper,borderWidth:"1.5px",zIndex:99})),x=(0,s.Ay)(d.A,{name:p,slot:"ButtonAdd"})(({theme:e})=>({position:"absolute",top:0,left:"50%",transform:"translate(-50%, -50%)",width:"40px",height:"40px",backgroundColor:e.palette.primary.main,borderRadius:"50%",marginBottom:e.spacing(1.5),cursor:"pointer",borderStyle:"solid",borderColor:e.palette.background.paper,borderWidth:e.spacing(.5)})),w=(0,s.Ay)(l.s4,{shouldForwardProp:e=>"isMobile"!==e})(({theme:e,isMobile:t})=>({fontSize:e.mixins.pxToRem(16),color:"#fff",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",...t&&{fontSize:e.mixins.pxToRem(12)}})),E=(0,s.Ay)(d.A)(({theme:e})=>({fontSize:e.mixins.pxToRem(13),width:"100%",textAlign:"center",color:e.palette.primary.main})),C=function({title:e="create_story",preventShowAvatar:t=!1,canCreate:i=!0}){var s;let{useSession:c,i18n:p,navigate:C,getSetting:S}=(0,o.PCX)(),R=(0,o.alo)(!0),{user:k}=c(),{has_live_story:I}=k||{},P=S("story.home_page_style"),F=(0,a.cb)((null==k?void 0:k.full_name)||(null==k?void 0:k.title)),M=null!==(s=null==k?void 0:k.title)&&void 0!==s?s:(null==k?void 0:k.full_name)||"NaN",_=(0,a.AE)(null==k?void 0:k.avatar,"200x200"),z={};_||(z.backgroundColor=a.m6.hex(F||""));let T=null==k?void 0:k.can_view_story,j=()=>{C("/story/add")},W=()=>{if(T){C(`/story/${null==k?void 0:k.id}`);return}j()},B=e=>{e.stopPropagation(),j()};return(T||!T&&i)&&!t&&P===r.gw.Avatar?m.createElement(g,{"data-testid":u()("storyAddItemCard"),onClick:W,maxWidth:n.Zw},m.createElement(f,{hasLiveVideo:I},m.createElement(l.H8,{user:k,size:n.Zw,hoverCard:!1,noStory:!T,sx:{pointerEvents:"none"},showLiveStream:!0,showStatus:!1}),i?m.createElement(b,{"data-testid":u()("storyAddIconCard"),onClick:B},m.createElement(w,{icon:"ico-plus",isMobile:R})):null),m.createElement(E,{onClick:W},p.formatMessage({id:e}))):i?m.createElement(y,{"data-testid":u()("storyAddItemCard"),onClick:j,isMobile:R},_?m.createElement(h,{src:_,"data-testid":"storyImageAdd",alt:M,style:z}):m.createElement(v,{"data-testid":"storyImageAdd",style:z},m.createElement("span",null,F)),m.createElement(A,null,m.createElement(x,null,m.createElement(w,{icon:"ico-plus"})),m.createElement(d.A,{mt:2},p.formatMessage({id:e})))):null}},36249(e,t,i){i.d(t,{A:()=>D});var o=i(91557),n=i(85332),r=i(91262),l=i(40515),a=i(3556),s=i(8051),d=i(63461),c=i(60780),u=i(97763),m=i(96540),p=i(71149);let y=(0,a.Ay)(d.A)(({theme:e})=>({color:"#fff"})),g=m.memo(({identity:e,contextStory:t,onDeleteSuccess:i})=>{let{i18n:a,dispatch:d}=(0,o.PCX)(),{pauseStatus:c,openStoryDetail:p,openViewComment:g,openActionItem:f,fire:h}=t,{handleNext:v,handlePrev:A,hasNext:b}=(0,n.P3)(),[x]=(0,o.Vd3)(e,{}),w=(t,o,n)=>{if(/deleteItem|mute/.test(t)){d({type:t,payload:{identity:e},meta:{onSuccess:()=>i({nextStory:!!/mute/.test(t)})}});return}x(t,o,n)},[E,C]=m.useState(!1),S=e=>{C(e)};return m.useEffect(()=>{c===r.ZR.Force||f||h({type:"setForcePause",payload:E?r.ZR.Pause:r.ZR.No})},[E,f]),m.useEffect(()=>{h({type:"setForcePause",payload:r.ZR.No})},[e]),m.useEffect(()=>{if(f||E||p||g)return;let e=e=>{let{keyCode:t}=e;if(37===t){A();return}b&&39===t&&v(),32===t&&h({type:"setForcePause",payload:c===r.ZR.No?r.ZR.Pause:r.ZR.No})};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[b,A,v,c,p,g,E,f]),m.createElement(m.Fragment,null,m.createElement(s.A,{sx:E?{position:"fixed",top:0,left:0,right:0,bottom:0}:{}}),m.createElement(l.pN,{triggerOpen:S,identity:e,handleAction:w,tabIndex:1,control:m.createElement(u.A,{title:a.formatMessage({id:"more_options"}),placement:"bottom"},m.createElement(y,{size:"medium",disableRipple:!0,disableFocusRipple:!0},m.createElement(l.s4,{icon:"ico-dottedmore"})))}))},(e,t)=>{var i,o;return(null==e?void 0:e.identity)===(null==t?void 0:t.identity)&&(null==e?void 0:null===(i=e.contextStory)||void 0===i?void 0:i.pauseStatus)===(null==t?void 0:null===(o=t.contextStory)||void 0===o?void 0:o.pauseStatus)&&(null==e?void 0:e.contextStory)===(null==t?void 0:t.contextStory)});var f=i(44562),h=i(81502),v=i(62193),A=i.n(v),b=i(2404),x=i.n(b);let w="progress-story",E=(0,a.Ay)("div")(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"})),C=(0,a.Ay)(s.A,{name:w})(({theme:e})=>({width:"100%",marginRight:e.spacing(.5),"&:last-child":{marginRight:e.spacing(0)}})),S=(0,a.Ay)(h.A,{name:w})(({theme:e})=>({borderRadius:e.shape.borderRadius/4,backgroundColor:"rgba(255, 255, 255, 0.5)","& .MuiLinearProgress-bar":{borderRadius:e.shape.borderRadius/2,backgroundColor:"rgba(255, 255, 255, 0.9)",transition:"transform .3s linear",transformOrigin:"left",willChange:"transform"}})),R=function({identity:e}){let{useGetItem:t,useGetItems:i,getAcl:l,navigate:a}=(0,o.PCX)(),s=l("story.story.create"),{hasNext:d}=(0,n.P3)(),c=m.useRef(0),[u,p]=m.useState(0),y=m.useRef(),g=m.useRef(0),h=(0,n.vC)(),{identityUserStoryActive:v,identityStoryActive:b,pauseStatus:w,indexStoryActive:R,listUserStories:k,readyStateFile:I,progressVideoPlay:P,fire:F,durationVideo:M}=h||{},_=t(e||b),{duration:z,type:T,in_process:j}=_||{},W=M||z||f.oL,B=("video"!==T||!j)&&"photo"!==T&&"text"!==T,D=t(v),Z=i(null==D?void 0:D.stories),H=m.useRef(0);m.useEffect(()=>{B&&(g.current=P)},[B,P]);let L=()=>{if(!A()(_)){if(clearInterval(y.current),B){y.current=setInterval(()=>{if(!(0===g.current||x()(g.current,H.current))&&(H.current=g.current,p(e=>e+.1),parseFloat(parseFloat(g.current).toFixed(1))>=parseFloat(parseFloat(W).toFixed(1)))){var e;c.current=R+1,F({type:"setIdentityStoryActive",payload:null==Z?void 0:null===(e=Z[c.current])||void 0===e?void 0:e._identity})}},100);return}y.current=setInterval(()=>{if(g.current=g.current+.1,p(e=>e+.1),g.current>=W){var e;c.current=R+1,F({type:"setIdentityStoryActive",payload:null==Z?void 0:null===(e=Z[c.current])||void 0===e?void 0:e._identity})}},100)}},N=()=>{g.current=0,p(0),clearInterval(y.current),w!==r.ZR.Force&&(F({type:"setForcePause",payload:r.ZR.No}),L())},O=()=>{clearInterval(y.current)},V=()=>{L()},X=()=>{g.current=0,p(0),F({type:"setProgressVideoPlay",payload:0}),F({type:"setForcePause",payload:r.ZR.No}),clearInterval(y.current)};m.useEffect(()=>{if(w!==r.ZR.No){O();return}V()},[w]),m.useEffect(()=>{let e=B?parseFloat(parseFloat(g.current).toFixed(1))>=parseFloat(parseFloat(W).toFixed(1)):u>=W-.1;if(R===Z.length-1&&e){if(!d){if(s){F({type:"setLastStory",payload:!0});return}a("/");return}let t=null==k?void 0:k.findIndex(e=>(null==D?void 0:D.id)===(null==e?void 0:e.id));if(k[t+1]){var i;F({type:"setIdentityUserS_Active",payload:null===(i=k[t+1])||void 0===i?void 0:i._identity})}c.current=0;return}},[u,R,null==_?void 0:_.id,Z,k,null==D?void 0:D.id,d,B,W]),m.useEffect(()=>{(null==Z?void 0:Z.length)&&X()},[null==D?void 0:D.id]),m.useEffect(()=>{if(I&&_)return N(),()=>{X()}},[null==_?void 0:_.id,I]);let U=m.useCallback(e=>{if(e<R)return 100;if(e===R){if(u>=W)return;return Math.round(u/W*100)||0}if(e>R)return 0},[u,R]);return m.createElement(E,{"data-testid":"progressStoryBlock"},Z.map((e,t)=>m.createElement(C,{key:null==e?void 0:e.id},m.createElement(S,{variant:"determinate",value:U(t)}))))};var k=i(84058),I=i.n(k);let P="HeaderStory",F=(0,a.Ay)(s.A,{name:P})(({theme:e})=>({width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",flexDirection:"column",padding:e.spacing(1.5)})),M=(0,a.Ay)(s.A,{name:P,shouldForwardProp:e=>"isTypeLiveVideo"!==e})(({theme:e,isTypeLiveVideo:t})=>({width:"100%",height:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",padding:e.spacing(1.5,0),...t&&{paddingBottom:e.spacing(1)}})),_=(0,a.Ay)("div")(({theme:e})=>({display:"flex",alignItems:"center",maxWidth:"70%",overflow:"hidden"})),z=(0,a.Ay)("div")(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"center"})),T=(0,a.Ay)(d.A)(({theme:e})=>({color:"#fff"})),j=(0,a.Ay)("div",{name:P,slot:"PrivacyBlockStyled"})(({theme:e})=>({display:"flex",flexDirection:"row",alignItems:"center",fontSize:e.mixins.pxToRem(13),paddingTop:"0.25em"})),W=(0,a.Ay)(c.A,{name:P,slot:"ButtonStyled"})(({theme:e})=>({alignSelf:"flex-start",color:"#fff",fontWeight:e.typography.fontWeightMedium,borderColor:"#fff","&:hover":{borderColor:e.palette.border.secondary}})),B=(0,a.Ay)("div",{name:P,slot:"SeparateSpanStyled"})(({theme:e})=>({color:"rgba(255, 255, 255, 0.9)",display:"flex",alignItems:"center","& span + span:before":{content:'"\xb7"',display:"inline-block",padding:`${e.spacing(0,.5)}`}})),D=(0,m.memo)(function({identity:e,isMinHeight:t=!1,isSmallHeight:i=!1}){let{navigate:a,i18n:d,useIsMobile:c,goSmartBack:y,useGetItem:h,useGetItems:v,useTheme:A,dispatch:b}=(0,o.PCX)(),x=A(),w=c(!0),E=()=>{y()},C=(0,n.vC)(),{identityUserStoryActive:S,identityStoryActive:k,pauseStatus:P,mutedStatus:D=!0,indexStoryActive:Z,listUserStories:H,fire:L}=C||{},N=h(S),O=v(null==N?void 0:N.stories),V=h(e||k),{_identity:X,privacy:U,modification_date:q,type:$,extra_params:G,in_process:K}=V||{},{is_streaming:Q}=G||{},Y=$===f.UZ,J=()=>{if(P!==r.ZR.No){L({type:"setForcePause",payload:r.ZR.No});return}L({type:"setForcePause",payload:r.ZR.Force})},ee=()=>{L({type:"setMuted",payload:!D}),b({type:"story/updateMutedStatus",payload:!D})},et=m.useCallback(({nextStory:e})=>{var t,i;let o=(null==N?void 0:N.stories.length)-1===Z||e,n=null==H?void 0:H.findIndex(e=>(null==e?void 0:e.id)===(null==N?void 0:N.id)),r=(null==H?void 0:H.length)-1===n&&o;if(r){a("/");return}if(o){L({type:"setIdentityUserS_Active",payload:null===(i=H[n+1])||void 0===i?void 0:i._identity});return}L({type:"setIdentityStoryActive",payload:null==O?void 0:null===(t=O[Z+1])||void 0===t?void 0:t._identity})},[null==N?void 0:N.stories,null==N?void 0:N.id,Z,H,O]),ei=()=>{Y&&(null==V?void 0:V.item_id)&&a(`/live-video/${null==V?void 0:V.item_id}`)};return m.createElement(F,{"data-testid":"headerStoryBlock"},m.createElement(R,{identity:e}),m.createElement(M,{isTypeLiveVideo:Y},m.createElement(_,null,m.createElement(l.H8,{user:N,size:t||i?36:48,noStory:!0,showLiveStream:!0,showStatus:!1}),i?null:m.createElement(s.A,{ml:1,overflow:"hidden"},m.createElement(l.mE,{lines:1,style:{color:"#fff"},variant:"h5"},m.createElement(l.xE,{user:N})),Y?m.createElement(l.mE,{lines:1,variant:"body1",style:{color:"rgba(255, 255, 255, 0.9)",fontSize:x.mixins.pxToRem(13),paddingTop:"0.25em"}},d.formatMessage({id:Q?"live_now":"recorded_live"})):null,m.createElement(j,null,m.createElement(B,null,m.createElement(p.A,{value:q,shorten:!0}),m.createElement(l.g6,{value:U}))))),m.createElement(z,{"data-testid":"actionStoryBlock"},m.createElement(T,{"data-testid":I()("icon button"),size:"smaller",onClick:J},P===r.ZR.No?m.createElement(u.A,{title:d.formatMessage({id:"pause"}),placement:"bottom"},m.createElement(l.s4,{icon:"ico-pause"})):m.createElement(u.A,{title:d.formatMessage({id:"play"}),placement:"bottom"},m.createElement(l.s4,{icon:"ico-play"}))),"video"===$&&K||"photo"===$||"text"===$||K?null:m.createElement(T,{size:"medium",onClick:ee},D?m.createElement(u.A,{title:d.formatMessage({id:"unmute"}),placement:"bottom"},m.createElement(l.s4,{icon:"ico-volume-del"})):m.createElement(u.A,{title:d.formatMessage({id:"mute"}),placement:"bottom"},m.createElement(l.s4,{icon:"ico-volume-increase"}))),m.createElement(g,{identity:X,contextStory:C,onDeleteSuccess:et}),w?m.createElement(T,{onClick:E,size:"medium"},m.createElement(l.s4,{icon:"ico-close"})):null)),Y?m.createElement(W,{role:"button","data-testid":"buttonWatchVideo",variant:"outlined",size:"small",disableRipple:!0,onClick:ei},d.formatMessage({id:Q?"watch_live_video":"watch_video"})):null)},(e,t)=>e.identity===t.identity)},5605(e,t,i){i.d(t,{A:()=>d});var o=i(91557),n=i(3556),r=i(96540),l=i(91262);let a=(0,n.Ay)(o.vxq,{name:"seeMoreLinkStory",slot:"SeeMoreLink",shouldForwardProp:e=>"isPreview"!==e})(({theme:e,isPreview:t})=>({...t&&{position:"absolute",left:"50%",bottom:16,transform:"translate(-50%, 0)"},color:"#fff",borderColor:"#fff",borderRadius:e.spacing(3),zIndex:3})),s=({link:e,sx:t,variant:i="outlined",fire:n,isPreview:s=!0})=>{let{i18n:d}=(0,o.PCX)();if(!e)return;let c=()=>{n&&n({type:"setForcePause",payload:l.ZR.No})},u=()=>{n&&n({type:"setForcePause",payload:l.ZR.Pause})};return r.createElement(a,{isPreview:s,to:e,variant:i,sx:t,onClick:u,onCancel:c},d.formatMessage({id:"visit_link"}))},d=s}}]);