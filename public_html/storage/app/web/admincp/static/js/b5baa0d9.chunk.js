"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-story-blocks-StoryArchiveDetailMobile-Block"],{24774(e,t,i){i.d(t,{A:()=>h});var o=i(91557),l=i(85332),a=i(3556),n=i(8051),r=i(87773),s=i(96540);let d="PenddingView",c=(0,a.Ay)(n.A,{name:d,slot:"root",shouldForwardProp:e=>"isDetailPage"!==e})(({theme:e,isDetailPage:t})=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",userSelect:"none",backgroundColor:"#000",paddingTop:e.spacing(1.5),flexDirection:"column",cursor:"pointer","& .MuiSkeleton-root":{..."light"===e.palette.mode&&{backgroundColor:e.palette.grey.A200}},...t&&{paddingTop:0}})),p=(0,a.Ay)(n.A,{name:d,slot:"ItemWrapper",shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,width:t})=>({position:"relative",margin:"auto",height:"100%",display:"flex",justifyContent:"center",flexDirection:"column",width:t})),u=(0,a.Ay)(r.A)(({theme:e})=>({color:"#fff",fontSize:e.mixins.pxToRem(14),paddingBottom:e.spacing(1.5),textAlign:"center",width:"80%"})),y=(0,a.Ay)(n.A,{name:d,slot:"ItemInteractionStyled",shouldForwardProp:e=>"isDetailPage"!==e&&"isOwner"!==e&&"isMobile"!==e})(({theme:e,isDetailPage:t,isOwner:i,isMobile:o})=>({minHeight:t?54:64,...(i||t&&o)&&{display:"none"}})),m=(0,a.Ay)(n.A,{name:d,slot:"ContentStyled",shouldForwardProp:e=>"width"!==e&&"height"!==e})(({theme:e,height:t,width:i})=>({backgroundColor:e.palette.grey["900"],borderRadius:e.shape.borderRadius,height:t,width:i,display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",minWidth:"120px"}));function h({isDetailPage:e=!1,isOwner:t=!1}){let{i18n:i,useIsMobile:a,dispatch:n}=(0,o.PCX)(),{fire:r}=(0,l.vC)(),d=a(!0),h=s.useRef(),[g,f]=(0,l.Uf)(h),v=s.useCallback(()=>{r({type:"setReady",payload:!0}),r({type:"setMuted",payload:!1}),n({type:"story/updateMutedStatus",payload:!1})},[r]);return s.createElement(c,{isDetailPage:e},s.createElement(p,{ref:h,width:g},s.createElement(m,{height:f,width:g,onClick:v},s.createElement(u,{component:"span"},i.formatMessage({id:"click_to_view_story"})))),s.createElement(y,{isDetailPage:e,isOwner:t,isMobile:d}))}},67894(e,t,i){i.d(t,{A:()=>D,Y:()=>O});var o=i(91557),l=i(84680),a=i(96540),n=i(88316),r=i(3556),s=i(8051),d=i(63461),c=i(97763),p=i(87773),u=i(32113),y=i(85332),m=i(91262),h=i(40515),g=i(79655),f=i(10272),v=i(62193),w=i.n(v),A=i(24774);let x="StoryArchiveDetail",b=(0,r.Ay)(s.A,{name:x,slot:"RootStyled"})(({theme:e})=>({backgroundColor:e.palette.background.paper,padding:"0 !important",height:"100%",display:"flex",overflowX:"hidden",[e.breakpoints.down("md")]:{height:"auto",flexFlow:"column"}})),S=(0,r.Ay)("div",{name:x,slot:"DetailStory",shouldForwardProp:e=>"isOwner"!==e&&"isMobile"!==e})(({theme:e,isOwner:t,isMobile:i})=>({position:"relative",backgroundColor:"#000",width:"100%",overflow:"hidden",flex:1,minWidth:0,padding:e.spacing(1.5,0),"& iframe":{width:"100%",height:"100%"},[e.breakpoints.down("md")]:{width:"100%",height:"auto",borderRadius:0,overflow:"initial"},...(i||!t)&&{paddingBottom:0}})),E=(0,r.Ay)("div",{name:x,slot:"DetailStatistic"})(({theme:e})=>({height:"100%",width:"420px",[e.breakpoints.down("md")]:{width:"100%"},[e.breakpoints.down("xs")]:{width:"100%",height:"400px"}})),k=(0,r.Ay)(s.A,{name:x,slot:"WrapperStatistic"})(({theme:e})=>({display:"flex",flexDirection:"column",height:"100%",padding:e.spacing(2),paddingTop:e.spacing(2.5),paddingBottom:0})),C=(0,r.Ay)(s.A,{name:x,slot:"HeaderBlock"})(({theme:e})=>({padding:e.spacing(2),paddingTop:0,display:"flex",alignItems:"center",justifyContent:"center"})),M=(0,r.Ay)(s.A,{name:x,slot:"HeaderTitle"})(()=>({})),P=(0,r.Ay)(s.A,{name:x,slot:"ContentBlock"})(({theme:e})=>({overflow:"hidden",display:"flex",flexDirection:"column",flex:1,minHeight:0})),R=(0,r.Ay)("div",{name:x,slot:"actionBar"})(({theme:e})=>({position:"absolute",right:0,top:0,padding:e.spacing(1),display:"flex",justifyContent:"space-between",zIndex:1,alignItems:"center"})),I=(0,r.Ay)(d.A,{name:x,slot:"TagFriend"})(({theme:e})=>({color:"#fff !important",width:32,height:32,fontSize:e.mixins.pxToRem(15)})),O=e=>{var t,i,o;let{item:l,isOwner:r=!1}=e||{},s=(0,y.vC)(),{isReady:d}=s||{};return(null==l?void 0:l.in_process)||d||null===(t=window.navigator)||void 0===t||!t.userActivation||(null===(i=window.navigator)||void 0===i?void 0:null===(o=i.userActivation)||void 0===o?void 0:o.hasBeenActive)?a.createElement(n.pZ,{story:l,isModal:!1,isOwner:r}):a.createElement(A.A,{isDetailPage:!0,isOwner:r})},D=(0,g.A)(function(e){let{useGetItem:t,useSession:i,i18n:r,useIsMobile:d,dispatch:y,goSmartBack:g,usePageParams:v}=(0,o.PCX)(),A=v(),{identity:x,stories:D,story_id:F,total:W,nextDate:_,prevDate:B,shouldPreload:H,indexStoryActive:T,date:j,positionStory:V,pagingId:Z}=e||{},X=d(!0),{user:z}=i(),[L,G]=a.useReducer(f.y,{...u.x6}),N=a.useRef(!1),$=a.useRef(),{identityStoryActive:q,pauseStatus:U}=L||{},Y=t(x),J=t(q)||Y,K=t(null==J?void 0:J.user);a.useEffect(()=>{(null==D?void 0:D.length)&&G({type:"setInit",payload:{isReady:!1,stories:D,story_id:F,total:W,nextDate:_,prevDate:B,date:j,positionStory:V,pagingId:Z}})},[]),a.useEffect(()=>{w()(Y)||G({type:"setInit",payload:{indexStoryActive:T,identityStoryActive:x}})},[Y]),a.useEffect(()=>{(null==A?void 0:A.id)&&H&&y({type:"story/story_archive/LOAD",payload:{user_id:null==A?void 0:A.user_id,date:j,direction:H},meta:{onSuccess:Q}})},[]);let Q=e=>{var t;let i=null==e?void 0:e.pagingId,o=null==e?void 0:e.ids;if(!i||!(null==o?void 0:o.length))return;let l=null==e?void 0:null===(t=e.pagesOffset)||void 0===t?void 0:t.total;G({type:"setInit",payload:{stories:o,total:l,pagingId:i}})};if(!K)return null;let ee=(null==K?void 0:K.id)===(null==z?void 0:z.id),et=()=>{g()},ei=e=>{if(U!==m.ZR.Force){if(e.relatedTarget!==e.currentTarget&&!e.currentTarget.contains(e.relatedTarget)){N.current=!0,G({type:"setForcePause",payload:m.ZR.Pause}),G({type:"setOpenActionItem",payload:!0});return}G({type:"setForcePause",payload:m.ZR.No}),G({type:"setOpenActionItem",payload:!1})}},eo=e=>{U!==m.ZR.Force&&N.current&&($.current=setTimeout(()=>{G({type:"setForcePause",payload:m.ZR.No}),G({type:"setOpenActionItem",payload:!1}),N.current=!1},300))},el=e=>{clearTimeout($.current)};return J?a.createElement(l.eB,{testid:`detailview ${J.resource_name}`},a.createElement(l.tD,null,a.createElement(u.MO.Provider,{value:{...L,fire:G}},a.createElement(b,null,a.createElement(S,{isOwner:ee,isMobile:X,onBlur:ei,onMouseEnter:eo,onMouseLeave:el,tabIndex:0},X?null:a.createElement(R,null,a.createElement(s.A,null,a.createElement(c.A,{title:r.formatMessage({id:"close"})},a.createElement(I,{onClick:et},a.createElement(h.s4,{icon:"ico-close",color:"white"}))))),a.createElement(O,{item:J,isOwner:ee})),a.createElement(E,null,a.createElement(k,null,a.createElement(C,null,a.createElement(M,null,a.createElement(p.A,{variant:"h4",color:"text.primary"},r.formatMessage({id:ee?"story_details":"comments"})))),a.createElement(P,null,a.createElement(n.Dq,{item:J,isArchive:!0})))))))):null})},59034(e,t,i){i.r(t),i.d(t,{default:()=>_});var o=i(91557),l=i(84680),a=i(96540),n=i(88316),r=i(3556),s=i(8051),d=i(2491),c=i(85332),p=i(28472),u=i(44562),y=i(40515),m=i(87773);let h=(0,r.Ay)(s.A,{slot:"FooterOnwerStyled",shouldForwardProp:e=>"showView"!==e&&"width"!==e&&"isMobile"!==e&&"isMinHeight"!==e&&"isSmallWidth"!==e})(({theme:e,showView:t,width:i,isMobile:o,isMinHeight:l,isSmallWidth:a})=>({minHeight:"64px",display:"flex",alignItems:"center",justifyContent:"space-between",...t&&{cursor:"pointer"},...i&&{width:i},...o&&{padding:e.spacing(0,2),paddingRight:e.spacing(.5),...l&&{maxWidth:i},...a&&{width:"100%"},overflowX:"auto",MsOverflowStyle:"none",scrollbarWidth:"none",scrollBehavior:"smooth","&::-webkit-scrollbar":{display:"none"}}})),g=(0,r.Ay)(s.A,{slot:"FooterStyled",shouldForwardProp:e=>"showView"!==e&&"width"!==e&&"isMobile"!==e&&"isMinHeight"!==e&&"isSmallWidth"!==e})(({theme:e,showView:t,width:i,isMobile:o,isMinHeight:l,isSmallWidth:a})=>({minHeight:"64px",display:"flex",alignItems:"center",...o&&{padding:e.spacing(0,2),...a&&{width:"100%"},...l&&{maxWidth:"560px"},overflowX:"auto",MsOverflowStyle:"none",scrollbarWidth:"none",scrollBehavior:"smooth","&::-webkit-scrollbar":{display:"none"}}})),f=(0,r.Ay)(m.A)(({theme:e})=>({color:"#fff",fontSize:e.mixins.pxToRem(16)})),v=(0,r.Ay)(y.s4)(({theme:e})=>({color:"#fff",marginRight:e.spacing(1),fontSize:e.mixins.pxToRem(18),fontWeight:e.typography.fontWeightBold})),w=(0,r.Ay)(s.A,{name:"ItemInteractionMobile",slot:"ViewWrapper"})(({theme:e})=>({display:"flex",alignItems:"center"})),A=function({item:e,isMinHeight:t=!1,width:i,handleViewDetail:l,isOwner:r}){let s=(0,c.vC)(),{useIsMobile:y,i18n:m}=(0,o.PCX)(),A=(0,d.A)("(max-width:560px)"),x=y(),b=y(!0);return r?a.createElement(h,{isMobile:x,width:t?u.G9:i,isMinHeight:t,isSmallWidth:A},a.createElement(w,{onClick:l},a.createElement(v,{icon:"ico-angle-up"}),a.createElement(f,{variant:"h4",color:"text.primary"},m.formatMessage({id:"story_details"})))):a.createElement(g,{isMobile:x,width:t?u.G9:i,isMinHeight:t,isSmallWidth:A},b?a.createElement(p.A,{onClick:l,item:e}):null,a.createElement(n.WR,{item:e,contextStory:s}))};var x=i(32113),b=i(10272),S=i(62193),E=i.n(S),k=i(67894),C=i(79655),M=i(91262);let P="StoryArchiveDetailMobile",R=(0,r.Ay)(s.A,{name:P,slot:"RootStyled",shouldForwardProp:e=>"isOwner"!==e&&"isMobile"!==e})(({theme:e,isOwner:t,isMobile:i})=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",userSelect:"none",backgroundColor:"#000",flexDirection:"column",padding:e.spacing(1.5,0),...(i||!t)&&{paddingBottom:0}})),I=(0,r.Ay)(s.A,{name:P,slot:"ItemWrapper"})(({theme:e})=>({position:"relative",margin:"auto",backgroundColor:"#000",display:"flex",justifyContent:"center",borderRadius:e.shape.borderRadius,height:"100%",maxHeight:"100%",flex:1,minWidth:0})),O=(0,r.Ay)("div",{name:P,slot:"StoryImage",shouldForwardProp:e=>"width"!==e})(({theme:e,width:t})=>({height:"100%",width:t,position:"relative"})),D=(0,r.Ay)(s.A,{name:P,slot:"ContentWrapper"})(({theme:e})=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flex:1,minHeight:0})),F=(0,C.A)(function(e){let{useGetItem:t,useSession:i,useIsMobile:r,usePageParams:p,dispatch:y}=(0,o.PCX)(),m=(0,d.A)("(max-height:667px)"),h=r(!0),g=a.useRef(),{user:f}=i(),[v,w]=(0,c.Uf)(g),S=p(),{identity:C,stories:P,story_id:F,total:W,nextDate:_,prevDate:B,shouldPreload:H,indexStoryActive:T,date:j,positionStory:V,pagingId:Z}=e||{},[X,z]=a.useReducer(b.y,{...x.x6}),{identityStoryActive:L,openStoryDetail:G}=X||{},N=t(C),$=t(L)||N,q=t(null==$?void 0:$.user);a.useEffect(()=>{if(G){z({type:"setForcePause",payload:M.ZR.Force});return}z({type:"setForcePause",payload:M.ZR.No})},[G,L]),a.useEffect(()=>{(null==P?void 0:P.length)&&z({type:"setInit",payload:{isReady:!1,stories:P,story_id:F,total:W,nextDate:_,prevDate:B,date:j,positionStory:V,pagingId:Z}})},[]),a.useEffect(()=>{E()(N)||z({type:"setInit",payload:{indexStoryActive:T,identityStoryActive:C}})},[N]),a.useEffect(()=>{(null==S?void 0:S.id)&&H&&y({type:"story/story_archive/LOAD",payload:{user_id:null==S?void 0:S.user_id,date:j,direction:H},meta:{onSuccess:U}})},[]);let U=e=>{var t;let i=null==e?void 0:e.pagingId,o=null==e?void 0:e.ids;if(!i||!(null==o?void 0:o.length))return;let l=null==e?void 0:null===(t=e.pagesOffset)||void 0===t?void 0:t.total;z({type:"setInit",payload:{stories:o,total:l}})};if(!q)return null;let Y=(null==q?void 0:q.id)===(null==f?void 0:f.id);if(!$)return null;let J=()=>{z({type:"setOpenStoryDetail",payload:!G})};return a.createElement(l.eB,{testid:`detailview ${$.resource_name}`},a.createElement(l.tD,null,a.createElement(x.MO.Provider,{value:{...X,fire:z}},a.createElement(R,{isOwner:Y,isMobile:h},a.createElement(D,null,a.createElement(I,{style:{height:w||"100%",...m&&{width:u.G9,flex:"unset"}}},a.createElement(O,{ref:g,width:v},a.createElement(k.Y,{item:$,isOwner:Y})))),a.createElement(n.Dq,{isMinHeight:m,item:$,setOpen:e=>z({type:"setOpenStoryDetail",payload:e}),open:G,isArchive:!0}),G?a.createElement(s.A,{minHeight:64}):a.createElement(A,{item:$,isMinHeight:m,width:v,handleViewDetail:J,isOwner:Y})))))}),W=(0,o.$MH)(F),_=(0,o.WvA)({extendBlock:W,defaults:{placeholder:"Search",blockProps:{variant:"plained",titleComponent:"h2",titleVariant:"subtitle1",titleColor:"textPrimary",noFooter:!0,noHeader:!0,blockStyle:{height:"100%",position:"fixed !important",top:0,right:0,left:0,display:"flex"},contentStyle:{flex:1,minWidth:0,display:"flex",justifyContent:"center",alignItems:"center"},headerStyle:{},footerStyle:{}}}})},10272(e,t,i){i.d(t,{y:()=>l});var o=i(16535);let l=(0,o.Ay)((e,t)=>{switch(t.type){case"setInit":e=Object.assign(e,t.payload);break;case"setStoryActive":var i,o,l;e.identityStoryActive=null===(i=t.payload)||void 0===i?void 0:i.identity,e.indexStoryActive=null===(o=t.payload)||void 0===o?void 0:o.index,e.positionStory=null===(l=t.payload)||void 0===l?void 0:l.positionStory,e.loading=!1;break;case"setReady":e.isReady=t.payload;break;case"setStories":e.stories=t.payload;break;case"setReadyStateFile":e.readyStateFile=t.payload;break;case"setForcePause":e.pauseStatus=t.payload;break;case"setReactions":e.reactions=t.payload;break;case"setOpenActionItem":e.openActionItem=t.payload;break;case"setProgressVideoPlay":e.progressVideoPlay=t.payload;break;case"setMuted":e.mutedStatus=t.payload;break;case"setDuration":e.durationVideo=t.payload;break;case"setBuffer":e.buffer=t.payload;break;case"setLoading":e.loading=t.payload;break;case"setOpenStoryDetail":e.openStoryDetail=t.payload}})}}]);