"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-photo-components-PhotoModalView-PhotoItemModalView"],{32730(e,t,i){i.r(t),i.d(t,{default:()=>_});var o=i(91557),a=i(40515),n=i(67725),l=i(3556),r=i(63461),s=i(8051),d=i(97763),p=i(60780),c=i(96540),m=i(76471),g=i(56525),u=i(85838);let h=(0,g.A)(e=>(0,u.A)({root:{},image:{maxWidth:"100%",maxHeight:"100vh",float:"left",backgroundColor:"hsl(0, 0%, 90%)",opacity:0,[e.breakpoints.down("sm")]:{maxHeight:"350px"}},imageHeightAuto:{maxHeight:"initial",[e.breakpoints.down("sm")]:{maxHeight:"350px"}},visibleImage:{opacity:1},boxFake:{position:"absolute",top:0,right:0,left:0,objectFit:"cover",display:"flex",alignItems:"center",justifyContent:"center"},imageFake:{width:"100%",height:"auto"},actionBar:{position:"absolute",right:0,top:0,padding:e.spacing(1),display:"flex",justifyContent:"flex-end",zIndex:1,alignItems:"center"},tagFriend:{color:"#fff !important",width:32,height:32,fontSize:e.mixins.pxToRem(15)},dropDown:{color:"#fff",minWidth:"32px",height:"32px",fontSize:e.mixins.pxToRem(15)},taggedBox:{position:"absolute",left:0,top:0,width:"100px",height:"100px",border:"2px solid",borderColor:e.palette.background.paper,boxShadow:e.shadows[20],transform:"translate(-50%,-50%)"},suggestFriend:{backgroundColor:e.mixins.backgroundColor("paper"),marginTop:"10px",marginLeft:"-70px",border:e.mixins.border("secondary"),borderRadius:e.shape.borderRadius,"&  .MuiFilledInput-root":{background:"none"}},smallAvatar:{width:"24px",height:"24px",marginRight:e.spacing(1)},whoIsThis:{height:"100px",width:"100%"},popper:{zIndex:e.zIndex.snackbar,backgroundColor:e.mixins.backgroundColor("paper"),padding:e.spacing(1),boxShadow:e.shadows[20],borderRadius:e.shape.borderRadius,margin:e.spacing(1,0),width:"240px","& .MuiAutocomplete-paper":{boxShadow:"none"},"& .MuiAutocomplete-listbox":{padding:0},"& .MuiAutocomplete-option":{borderRadius:e.shape.borderRadius,padding:"6px 8px"},"& .MuiAutocomplete-root":{maxWidth:"224px"},"& .MuiFilledInput-underline:after":{display:"none"},"& .MuiAutocomplete-endAdornment":{display:"none"},"& .MuiFilledInput-underline:before":{display:"none"},"& .MuiFilledInput-root":{background:"none",border:e.mixins.border("secondary"),borderRadius:e.shape.borderRadius},"& .MuiAutocomplete-noOptions":{padding:e.spacing(1.5,1)}},tagItem:{display:"flex",alignItems:"center",width:"100%",padding:e.spacing(.5,1),"&:hover":{background:e.palette.action.selected,borderRadius:e.shape.borderRadius/2}},userName:{flexGrow:1,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"block",fontSize:e.mixins.pxToRem(14)},inputBaseBox:{"& input":{width:"100%",border:e.mixins.border("secondary"),borderRadius:e.shape.borderRadius,padding:e.spacing(1),fontSize:e.mixins.pxToRem(15),"&:focus":{border:e.mixins.border("secondary"),outline:"none"}}},message:{color:"#fff",margin:e.spacing(0,1)},iconButton:{color:"white"},clear:{clear:"both"}}),{name:"MuiPhotoItemViewModal"});var x=i(92800),f=i(20106),y=i(98023),b=i.n(y);let v="PhotoItemModalView",w=(0,l.Ay)("div",{name:v,slot:"ImageBox",shouldForwardProp:e=>"tagging"!==e})(({theme:e,tagging:t,size:i})=>({position:"relative",maxWidth:"100%",maxHeight:"100%",display:"flex",justifyContent:"center",alignItems:"center",margin:"0 auto",img:{maxWidth:"100%",maxHeight:i.height},...t&&{cursor:"pointer"}})),A=(0,l.Ay)("div",{name:v,slot:"actionBar"})(({theme:e})=>({position:"absolute",right:0,top:0,padding:e.spacing(1),display:"inline-flex",justifyContent:"flex-end",zIndex:1,alignItems:"center"})),E=(0,l.Ay)("div",{name:v,slot:"BoxFake"})(({theme:e})=>({position:"absolute",top:0,right:0,left:0,objectFit:"cover",display:"flex",alignItems:"center",justifyContent:"center"})),k=(0,l.Ay)("img",{name:v,slot:"ImageFake"})(({theme:e})=>({width:"100%",height:"auto"})),C=(0,l.Ay)(r.A,{name:v,slot:"TagFriend"})(({theme:e})=>({color:"#fff !important",width:32,height:32,fontSize:e.mixins.pxToRem(15)})),I=(0,l.Ay)(a._V,{name:v,slot:"Image",shouldForwardProp:e=>"visibleImage"!==e&&"imageHeight"!==e})(({theme:e,visibleImage:t,imageHeight:i})=>({height:"100%",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,"& img":{maxWidth:"100%",maxHeight:"100%",width:"auto",height:"auto"},[e.breakpoints.down("sm")]:{maxHeight:"350px","& img":{maxHeight:"350px"}},...t&&{opacity:1},...i&&{maxHeight:"initial"}})),R=(0,l.Ay)("div",{name:v,slot:"ImageWrapper"})(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:"100%"}));function _({item:e,identity:t,imageHeightAuto:i=!1,enablePhotoTags:l=!0,taggedFriends:r=[],onAddPhotoTag:g,onRemovePhotoTag:u,onMinimizePhoto:y}){var v,_;let M=h(),{i18n:S,assetUrl:F}=(0,o.PCX)(),P=(0,o.tgz)(),B=c.useRef(),[z,H]=c.useState(!1),[T,N]=c.useState({px:0,py:0}),[W,j]=c.useState(!1),[L,O]=c.useState(!1),[$,V]=c.useState(!0),X=c.useRef(),[D,G]=c.useState({});if(c.useEffect(()=>{if(z&&(null==X?void 0:X.current)){let e=X.current.getBoundingClientRect();e.height>0&&G({height:`${e.height}px`})}},[z]),!e)return null;let q=(0,n.AE)(e.image,"origin",F("photo.no_image")),U=(0,n.AE)(e.image,"240",F("photo.no_image")),Y=(e,t)=>{e.stopPropagation(),u(t)},J=e=>{H(!0)},K=()=>{j(e=>!e),W||O(!1)},Q=e=>{let t=e.currentTarget.getBoundingClientRect(),i=Math.max(Math.min(e.clientX-t.left,t.width-50),50)/t.width*100,o=Math.max(Math.min(e.clientY-t.top,t.height-50),50)/t.height*100;N({px:i,py:o}),W&&O(!0)},Z=e=>{let{px:t,py:i}=T;g({content:e,px:t,py:i}),O(!1)},ee=()=>{O(!1),j(!1)},et=()=>{V(!$),y&&y($)},ei=b()(null==e?void 0:e.mature)&&(null==e?void 0:e.mature)>0;return c.createElement(a.qB,{onClickAway:ee},c.createElement(R,{ref:X},c.createElement(w,{tagging:W,onClick:Q,size:D},c.createElement(I,{onLoad:J,visibleImage:!0,imageHeight:i,alt:e.title,src:q,key:t,imageFit:"contain",aspectRatio:"auto",identity:t,matureProps:{color:"white",sx:{width:"100%",height:"100%"}}}),ei?null:c.createElement(c.Fragment,null,z?null:c.createElement(E,null,c.createElement(k,{alt:e.title,src:U})),c.createElement(f.A,{open:W&&L,px:T.px,py:T.py,classes:M,ref:B}),W&&L?c.createElement(x.A,{onItemClick:Z,classes:M,anchorRef:B,identity:t,open:!0}):null,(null===(v=e.tagged_friends)||void 0===v?void 0:v.length)?e.tagged_friends.map(t=>c.createElement(m.A,{extra:e.extra,tagging:W,identity:t,key:t.toString(),onRemove:Y,classes:M})):null)),c.createElement(A,null,P&&l&&!W&&!ei?c.createElement(s.A,null,z&&(null===(_=e.extra)||void 0===_?void 0:_.can_tag_friend)&&g?c.createElement(d.A,{title:S.formatMessage({id:"start_tagging"})},c.createElement(C,{onClick:K},c.createElement(a.s4,{icon:"ico-price-tag",color:"white"}))):null,y&&c.createElement(d.A,{title:S.formatMessage({id:$?"switch_to_full_screen":"exit_full_screen"})},c.createElement(C,{onClick:et},c.createElement(a.s4,{icon:$?"ico-arrow-expand":"ico-arrow-collapse",color:"white"})))):null,l&&W&&!ei?c.createElement(d.A,{title:S.formatMessage({id:"done_tagging"})},c.createElement(p.A,{variant:"contained",color:"primary",size:"small",onClick:K},S.formatMessage({id:"done"}))):null)))}},92800(e,t,i){i.d(t,{A:()=>y});var o=i(91557),a=i(3556),n=i(83445),l=i(96540),r=i(58156),s=i.n(r),d=i(67725),p=i(89481),c=i(12789);let m="SuggestionList",g=(0,a.Ay)("div",{name:m,slot:"RootNoFound"})(({theme:e})=>({minHeight:"100px",textAlign:"center"})),u=(0,a.Ay)("div",{name:m,slot:"Root"})(({theme:e})=>({minHeight:"100px",margin:e.spacing(1,-1,0)})),h=(e,{text:t,identity:i})=>{let o=s()(e,i);return{...e.friend.suggestions[`:${t}`],item_id:null==o?void 0:o.id}},x=(0,o.NgA)(h)(function(e){let{dispatch:t,i18n:i}=(0,o.PCX)(),{text:a,item_id:n,data:r,loaded:s,onItemClick:m,classes:h,excludeIds:x,isFullFriend:f,postAsParent:y,parentUser:b}=e,v=l.useMemo(()=>f?{excludeIds:x}:{item_type:"photo",item_id:n},[x,n,f]);return(l.useEffect(()=>{t({type:"friend/suggestions/LOAD",payload:{text:a,...v,user_id:y&&(null==b?void 0:b.id),owner_id:null==b?void 0:b.id}})},[t,a,v]),s)?(null==r?void 0:r.length)?l.createElement(u,null,r.map(e=>l.createElement("div",{onClick(t){t.preventDefault(),t.stopPropagation(),m(e)},className:h.tagItem,key:e.id.toString()},l.createElement(c.A,{src:(0,d.AE)(e.image,"240"),children:(0,d.cb)(e.label),alt:e.label,className:h.smallAvatar,style:{backgroundColor:d.m6.hex((0,d.cb)(e.label))}}),l.createElement("span",{className:h.userName},e.label)))):l.createElement(g,{onClick:e=>e.stopPropagation()},l.createElement("div",{style:{padding:16}},i.formatMessage({id:"no_people_found"}))):l.createElement(g,{sx:{display:"flex",alignItems:"center",justifyContent:"center",cursor:"default"},onClick:e=>e.stopPropagation()},l.createElement(p.A,{color:"secondary",size:32}))}),f=(0,a.Ay)("input",{name:"Text"})(({theme:e})=>({"&::placeholder":{color:e.palette.text.hint}}));function y({classes:e,onItemClick:t,anchorRef:i,identity:a,isFullFriend:r,excludeIds:s,postAsParent:d,parentUser:p}){let{i18n:c}=(0,o.PCX)(),[m,g]=l.useState(""),u=e=>{g(e)};return l.createElement(n.A,{id:"suggest-friends",open:Boolean(i.current),disablePortal:!0,anchorEl:i.current,placement:"bottom",className:e.popper,onClick:e=>e.stopPropagation()},l.createElement("div",{className:e.inputBaseBox},l.createElement(f,{type:"text",placeholder:c.formatMessage({id:"type_any_name"}),onChange:e=>u(e.target.value),autoFocus:!0,onBlur:e=>e.target.focus()})),l.createElement(x,{onItemClick:t,text:m,classes:e,identity:a,isFullFriend:r,excludeIds:s,postAsParent:d,parentUser:p}))}},20106(e,t,i){i.d(t,{A:()=>n});var o=i(20053),a=i(96540);let n=a.forwardRef(function({classes:e,px:t,py:i,open:n},l){let r=a.useMemo(()=>({left:`${t}%`,top:`${i}%`}),[t,i]);return a.createElement("div",{onClick:e=>e.stopPropagation(),className:(0,o.default)(e.taggedBox,n?"":"srOnly"),style:r,ref:l},a.createElement("div",{className:e.whoIsThis}))})},76471(e,t,i){i.d(t,{A:()=>f});var o=i(91557),a=i(58156),n=i.n(a),l=i(40515),r=i(3556),s=i(60780),d=i(96540);let p="PhotoTag",c=(0,r.Ay)("div",{name:p,slot:"root",shouldForwardProp:e=>"tagging"!==e&&"px"!==e&&"py"!==e&&"hovering"!==e&&"forceShow"!==e})(({theme:e,tagging:t,px:i,py:o,hovering:a,forceShow:n})=>({position:"absolute",width:t?10:100,height:t?10:100,transform:"translate(-50%,-50%)","&:hover > div:first-of-type":{visibility:"visible"},...(t||n)&&{"& > div:first-of-type":{visibility:"visible"}},zIndex:a?10:"auto",...i&&o&&{left:`${i}%`,top:`${o}%`}})),m=(0,r.Ay)("div",{name:p,slot:"Item"})(({theme:e})=>({position:"absolute",backgroundColor:"dark"===e.palette.mode?"rgba(0,0,0,.6)":"rgba(255,255,255,.8)",borderRadius:e.shape.borderRadius,overflow:"hidden",textOverflow:"ellipsis",maxWidth:"200px",textAlign:"center",display:"flex",alignItems:"center",padding:e.spacing(.5),transform:"translate(-50%,-50%)",left:"50%",top:"50%",visibility:"hidden"})),g=(0,r.Ay)(l.xE,{name:p,slot:"LinkStyled"})(({theme:e})=>({color:"light"===e.palette.mode?e.palette.grey.A700:e.palette.common.white,fontSize:e.mixins.pxToRem(13),fontWeight:e.typography.fontWeightBold,maxWidth:"180px",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",flexGrow:1,padding:e.spacing(0,.5)})),u=(0,r.Ay)(s.A,{name:p,slot:"ButtonStyled"})(({theme:e})=>({color:"light"===e.palette.mode?e.palette.grey.A700:e.palette.common.white,minWidth:"11px",padding:e.spacing(.5,1),margin:e.spacing(-.5),fontSize:e.mixins.pxToRem(11)})),h=(0,r.Ay)("span",{name:p,slot:"LabelStyled"})(({theme:e})=>({margin:"0 4px"})),x=(e,{identity:t})=>{let i=n()(e,t);return i?{item:i,user:i.user?n()(e,i.user):void 0}:{}},f=(0,o.NgA)(x)(function({item:e,user:t,tagging:i,extra:o,onRemove:a,isTypePreview:n,forceShow:r}){var s;let p=i&&(null==e?void 0:null===(s=e.extra)||void 0===s?void 0:s.can_remove_tag_friend),[x,f]=d.useState(!1);return d.createElement(c,{px:e.px,py:e.py,tagging:i,hovering:x,forceShow:r},d.createElement(m,{onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1)},t&&!n?d.createElement(g,{user:t,hoverCard:!1,rootProps:{display:"inherit"}}):d.createElement(h,null,(null==t?void 0:t.full_name)||(null==e?void 0:e.content)),p?d.createElement(u,{disableRipple:!0,disableFocusRipple:!0,onClick(t){a(t,e.id)}},d.createElement(l.s4,{icon:"ico-close"})):null))})}}]);