"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-livestreaming-components-WatchingUsers"],{43498(e,t,i){let r;i.d(t,{LL:()=>g,Ui:()=>m,ET:()=>v});var s=i(96602),n=i(96540),a=i(91557),l=i(70223),o=i(11497),u=i(656),c=i(78292);let f=new class{bootstrap(e,t){this.manager=e,this.settingApp=this.manager.getSetting("firebase"),this.settingApp&&this.init(this.settingApp,t)}checkActive(){return this.isActive}init(e,t){if(this.mounted)return this.firebaseApp;this.mounted=!0;let i={apiKey:a.z0J,authDomain:a.wRL,projectId:a.wWR,storageBucket:a.npo,messagingSenderId:a.AfL,appId:a.Kou};this.config=e;try{let r=(0,l.Wp)(i),s=(0,u.xI)(r),{user_firebase_email:n,user_firebase_password:o,requiredSignin:c}=this.settingApp||{};return c&&(0,u.x9)(s,n,o).then(e=>{}).catch(e=>{console.log("Live Video - Firebase signInWithEmailAndPassword error",e),"auth/user-not-found"===e.code&&(0,u.eJ)(s,n,o)}),t(!0),this.firebaseApp=r,this.isActive=!0,r}catch(f){this.isActive=!1}}getFirebaseApp(){return this.firebaseApp}getFirestore(){if(!this.firebaseApp)return null;if(!this.firestore){let e=(0,o.aU)(this.firebaseApp);e&&(this.firestore=e)}return this.firestore}getMessaging(){if(!this.firebaseApp)return null;if(!this.cloudMessage){let e=(0,c.dG)(this.firebaseApp);e&&(this.cloudMessage=e)}return this.cloudMessage}},h=!1,p=!1;function d(){let e=(0,a.PCX)(),[t,i]=n.useState(!1);return t||h||(h=!0,f.bootstrap(e,()=>{p=!0,i(!0)})),[t||p,f]}function g(){let[e,t]=n.useState(),[i,a]=n.useState(!1),[l,o]=d(),u=n.useRef(0);if(!l)return["",()=>{},!0];if(!r&&!i&&l)try{r=o.getMessaging()}catch(c){a(!0)}let f=e=>{(0,s.gf)(r).then(i=>{e(i),t(i)}).catch(()=>{u.current>5||(u.current=u.current+1,f(e))})};return[e,f,i]}function m(){let[e,t]=d();if(!e)return!1;let i=t.getFirestore();return i}let A=(e,t)=>{let[i,r]=(0,n.useState)();return(0,n.useEffect)(()=>{let i;if(e&&(null==t?void 0:t.collection)&&(null==t?void 0:t.docID)){try{let s=(0,o.H9)(e,t.collection,t.docID);i=(0,o.aQ)(s,async e=>{r(e.data())})}catch(n){}return()=>{null==i||i()}}},[]),i},v=A},82318(e,t,i){i.r(t),i.d(t,{default:()=>g});var r=i(96540),s=i(3556),n=i(8051),a=i(87773),l=i(91557),o=i(40515),u=i(88980),c=i(43498);let f=(0,u.i7)`
    0% {transform: translateY(100%);}
    100% {transform: translateY(0);}
`,h="WatchingViewer",p=(0,s.Ay)(n.A,{name:h,slot:"animationWrapper",shouldForwardProp:e=>"isOwner"!==e})(({theme:e,spinner:t})=>({display:"inline-flex",animation:`${f} 1s forwards`})),d=(0,s.Ay)(n.A,{name:h,slot:"Wrapper"})(({theme:e})=>({display:"block",overflow:"hidden"})),g=(0,l.G5k)(function({streamKey:e,identity:t}){let{i18n:i,usePrevious:s}=(0,l.PCX)(),[u,f]=r.useState(0),[h,g]=r.useState(!1),m=(0,c.Ui)(),A=r.useRef(),v=(0,c.ET)(m,{collection:"live_video_view",docID:e}),b=(null==v?void 0:v.view)||[],w=s(b.length),y=b.length;if(r.useEffect(()=>{if(y&&u+1>=y){A.current=setTimeout(()=>{g(!0)},2e3);return}g(!1),clearTimeout(A.current),A.current=setTimeout(()=>{f(e=>e+1)},2e3)},[u]),r.useEffect(()=>{h&&y!==w&&(y>w&&g(!1),f(b.length-1))},[null==b?void 0:b.length]),h||!e||!(null==b?void 0:b.length))return null;let E=b[u];return E?r.createElement(d,{pt:1},r.createElement(p,{key:`${null==E?void 0:E.id}`,sx:{display:"flex"}},r.createElement(n.A,{mr:1},r.createElement(o.H8,{user:E,size:24})),r.createElement(n.A,null,r.createElement(a.A,{component:"span",variant:"body1"},i.formatMessage({id:"user_joined"},{user_name:null==E?void 0:E.full_name}))))):null})}}]);