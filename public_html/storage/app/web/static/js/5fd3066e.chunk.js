"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-chatplus-components-ChatPopover-BuddyList","metafox-chatplus-components-Avatar"],{72761(e,t,n){n.d(t,{A:()=>M});var r=n(98587),i=n(58168),l=n(96540),a=n(20053),o=n(5004),s=n(75659),d=n(38413),c=n(31609);function u(e){return(0,c.A)("MuiBadge",e)}(0,d.A)("MuiBadge",["root","badge","invisible"]);var m=n(99977),p=n(74848);let g=["badgeContent","component","children","invisible","max","slotProps","slots","showZero"],h=e=>{let{invisible:t}=e;return(0,s.A)({root:["root"],badge:["badge",t&&"invisible"]},u,void 0)},v=l.forwardRef(function(e,t){let{component:n,children:l,max:a=99,slotProps:s={},slots:d={},showZero:c=!1}=e,u=(0,r.A)(e,g),{badgeContent:v,max:f,displayValue:y,invisible:b}=function(e){let{badgeContent:t,invisible:n=!1,max:r=99,showZero:i=!1}=e,l=(0,o.A)({badgeContent:t,max:r}),a=n;!1!==n||0!==t||i||(a=!0);let{badgeContent:s,max:d=r}=a?l:e,c=s&&Number(s)>d?`${d}+`:s;return{badgeContent:s,invisible:a,max:d,displayValue:c}}((0,i.A)({},e,{max:a})),A=(0,i.A)({},e,{badgeContent:v,invisible:b,max:f,showZero:c}),x=h(A),w=n||d.root||"span",E=(0,m.A)({elementType:w,externalSlotProps:s.root,externalForwardedProps:u,additionalProps:{ref:t},ownerState:A,className:x.root}),k=d.badge||"span",O=(0,m.A)({elementType:k,externalSlotProps:s.badge,ownerState:A,className:x.badge});return(0,p.jsxs)(w,(0,i.A)({},E,{children:[l,(0,p.jsx)(k,(0,i.A)({},O,{children:y}))]}))});var f=n(3556),y=n(92353),b=n(87447),A=n(75630);function x(e){return(0,c.A)("MuiBadge",e)}let w=(0,d.A)("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),E=["anchorOrigin","className","component","components","componentsProps","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],k=e=>{let{color:t,anchorOrigin:n,invisible:r,overlap:i,variant:l,classes:a={}}=e,o={root:["root"],badge:["badge",l,r&&"invisible",`anchorOrigin${(0,A.A)(n.vertical)}${(0,A.A)(n.horizontal)}`,`anchorOrigin${(0,A.A)(n.vertical)}${(0,A.A)(n.horizontal)}${(0,A.A)(i)}`,`overlap${(0,A.A)(i)}`,"default"!==t&&`color${(0,A.A)(t)}`]};return(0,s.A)(o,x,a)},O=(0,f.Ay)("span",{name:"MuiBadge",slot:"Root",overridesResolver:(e,t)=>t.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),_=(0,f.Ay)("span",{name:"MuiBadge",slot:"Badge",overridesResolver(e,t){let{ownerState:n}=e;return[t.badge,t[n.variant],t[`anchorOrigin${(0,A.A)(n.anchorOrigin.vertical)}${(0,A.A)(n.anchorOrigin.horizontal)}${(0,A.A)(n.overlap)}`],"default"!==n.color&&t[`color${(0,A.A)(n.color)}`],n.invisible&&t.invisible]}})(({theme:e,ownerState:t})=>(0,i.A)({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(12),minWidth:20,lineHeight:1,padding:"0 6px",height:20,borderRadius:10,zIndex:1,transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.enteringScreen})},"default"!==t.color&&{backgroundColor:(e.vars||e).palette[t.color].main,color:(e.vars||e).palette[t.color].contrastText},"dot"===t.variant&&{borderRadius:4,height:8,minWidth:8,padding:0},"top"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap&&{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${w.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}},"bottom"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap&&{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${w.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}},"top"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap&&{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${w.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}},"bottom"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap&&{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${w.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}},"top"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"circular"===t.overlap&&{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${w.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}},"bottom"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"circular"===t.overlap&&{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${w.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}},"top"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"circular"===t.overlap&&{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${w.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}},"bottom"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"circular"===t.overlap&&{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${w.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}},t.invisible&&{transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.leavingScreen})})),C=l.forwardRef(function(e,t){var n,l,s,d,c,u;let m;let g=(0,y.A)({props:e,name:"MuiBadge"}),{anchorOrigin:h={vertical:"top",horizontal:"right"},className:f,component:A="span",components:x={},componentsProps:w={},overlap:C="rectangular",color:M="default",invisible:P=!1,max:I,badgeContent:R,slots:T,slotProps:S,showZero:z=!1,variant:F="standard"}=g,$=(0,r.A)(g,E),B=(0,o.A)({anchorOrigin:h,color:M,overlap:C,variant:F}),W=P;!1!==P||(0!==R||z)&&(null!=R||"dot"===F)||(W=!0);let{color:j=M,overlap:L=C,anchorOrigin:D=h,variant:U=F}=W?B:g,N=(0,i.A)({},g,{anchorOrigin:D,invisible:W,color:j,overlap:L,variant:U}),H=k(N);"dot"!==U&&(m=R&&Number(R)>I?`${I}+`:R);let V=null!=(n=null!=(l=null==T?void 0:T.root)?l:x.Root)?n:O,X=null!=(s=null!=(d=null==T?void 0:T.badge)?d:x.Badge)?s:_,Q=null!=(c=null==S?void 0:S.root)?c:w.root,q=null!=(u=null==S?void 0:S.badge)?u:w.badge;return(0,p.jsx)(v,(0,i.A)({invisible:P,badgeContent:m,showZero:z,max:I},$,{slots:{root:V,badge:X},className:(0,a.default)(null==Q?void 0:Q.className,H.root,f),slotProps:{root:(0,i.A)({},Q,(0,b.A)(V)&&{as:A,ownerState:(0,i.A)({},null==Q?void 0:Q.ownerState,{anchorOrigin:D,color:j,overlap:L,variant:U})}),badge:(0,i.A)({},q,{className:(0,a.default)(H.badge,null==q?void 0:q.className)},(0,b.A)(X)&&{ownerState:(0,i.A)({},null==q?void 0:q.ownerState,{anchorOrigin:D,color:j,overlap:L,variant:U})})},ref:t}))}),M=C},13586(e,t,n){n.r(t),n.d(t,{default:()=>E});var r=n(91557),i=n(67725),l=n(3556),a=n(12789),o=n(72761),s=n(8051),d=n(30719),c=n(96540),u=n(97837),m=n(65121),p=n(86663),g=n(84058),h=n.n(g);let v=(0,l.Ay)(a.A,{name:"AvatarWrapper"})(({theme:e})=>({borderWidth:"thin",borderStyle:"solid",borderColor:e.palette.border.secondary})),f=(0,l.Ay)(r.N_E,{name:"Link"})(({theme:e})=>({"&:hover":{textDecoration:"none"}})),y=(0,l.Ay)(o.A,{shouldForwardProp:e=>"status"!==e})(({theme:e,status:t})=>({"& .MuiBadge-badge":{...t===u.O2.Offline&&{display:"none"},...t===u.O2.Online&&{color:e.palette.success.main,backgroundColor:e.palette.success.main},...t===u.O2.Away&&{color:e.palette.warning.main,backgroundColor:e.palette.warning.main},...t===u.O2.Busy&&{color:e.palette.error.main,backgroundColor:e.palette.error.main},boxShadow:"dark"===e.palette.mode?"none":`0 0 0 2px ${e.palette.background.paper}`,"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}}})),b=(0,l.Ay)("div",{shouldForwardProp:e=>"sizeProps"!==e})(({theme:e,sizeProps:t})=>({position:"relative",width:"32px",height:"32px",...t&&{width:t,height:t}})),A=(0,l.Ay)(a.A,{shouldForwardProp:e=>"sizeProps"!==e})(({theme:e,sizeProps:t})=>({position:"absolute",bottom:0,left:0,width:"26px",height:"26px",backgroundColor:"dark"===e.palette.mode?e.palette.grey["600"]:e.palette.grey["300"],borderWidth:1,borderStyle:"solid",borderColor:"light"===e.palette.mode?e.palette.grey["50"]:e.palette.grey["800"],zIndex:2,...t&&{width:.7*t,height:.7*t}})),x=(0,l.Ay)(s.A,{shouldForwardProp:e=>"sizeProps"!==e})(({theme:e,sizeProps:t})=>({position:"relative",width:"100%",height:"100%"})),w=(0,l.Ay)(a.A,{shouldForwardProp:e=>"sizeProps"!==e})(({theme:e,sizeProps:t})=>({position:"absolute",top:"50%",right:0,transform:"translate(0%, -50%)",width:"26px",height:"26px",...t&&{width:`${.7*t}px !important`,height:`${.7*t}px !important`}})),E=(0,c.memo)(function({username:e="Name",name:t="Name",src:n,size:l,to:o,onClick:s,status:g=0,room:E,uploadLocal:k=!1,roomType:O=null,avatarETag:_,component:C="span",target:M="_self",noLink:P}){var I,R;let{getSetting:T}=(0,r.PCX)(),S=(0,d.A)(),z=P,F=o,$=O||(null==E?void 0:E.t),B=(0,i.cb)(t),W={width:l,height:l,color:S.palette.grey["50"],fontSize:l/3},j=T("chatplus"),L=null==j?void 0:null===(I=j.server)||void 0===I?void 0:I.replace(/\/$/,""),D=n;if(D||(D=_?`${L}/avatar/${e}?${p.stringify({etag:_})}`:""),B&&(W.backgroundColor=i.m6.hex(B)),(null==E?void 0:E.isBotRoom)&&(F=null,z=!0),F)return c.createElement(f,{target:M,to:F||`/${e}`},c.createElement(v,{"data-testid":h()("chatplus avatar"),src:D,alt:t,style:W,component:C,children:B}));if([u.CJ.Private,u.CJ.Public].includes($)){if(k)return c.createElement(v,{"data-testid":h()("chatplus avatar"),src:D,alt:t,style:W,component:C,children:B});if(null==E?void 0:E.avatarETag)return D=`${L}/avatar/room/${null==E?void 0:E.id}?${p.stringify({etag:null==E?void 0:E.avatarETag})}`,c.createElement(v,{"data-testid":h()("chatplus avatar"),src:D,alt:t,style:W,component:C,children:B});{let U=`${L}/avatar/${null==E?void 0:null===(R=E.u)||void 0===R?void 0:R.username}`;return c.createElement(b,{"data-testid":h()("chatplus avatar"),sizeProps:l},c.createElement(A,{sizeProps:l,src:U,alt:t,component:C,children:B}),c.createElement(x,null,c.createElement(w,{sizeProps:l,src:D,alt:t,style:W,component:C,children:B})))}}if($===u.CJ.Direct&&g){let N=(0,m.cR)(g);return c.createElement(y,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot",status:N},c.createElement(a.A,{"data-testid":h()("chatplus avatar"),src:D,alt:t,style:W,component:C,children:B}))}return c.createElement(v,{"data-testid":h()("chatplus avatar"),src:D,alt:t,style:W,component:C,children:B,onClick:s,to:z?null:e})})},80962(e,t,n){n.d(t,{A:()=>g});var r=n(40515),i=n(3556),l=n(8051),a=n(63461),o=n(52705),s=n(96540);let d="loading-skeleton",c=(0,i.Ay)(l.A)(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"space-between",height:72,padding:e.spacing(.5,1)})),u=(0,i.Ay)(l.A,{name:d,slot:"BlockCollapse",shouldForwardProp:e=>"title"!==e})(({theme:e,title:t})=>({...t&&{borderTop:e.mixins.border("secondary")}})),m=(0,i.Ay)("div",{name:d,slot:"BlockCollapseHeader"})(({theme:e})=>({padding:e.spacing(2.5,2,2.5,3),display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",cursor:"pointer"})),p=(0,i.Ay)("div",{name:d,slot:"BlockTitle"})(({theme:e})=>({...e.typography.body1,color:e.palette.text.primary,fontWeight:"600"}));function g({title:e}){return s.createElement(u,{title:e},e?s.createElement(m,null,s.createElement(p,null,e),s.createElement(a.A,{size:"small",color:"default"},s.createElement(r.s4,{icon:"ico-angle-up"}))):null,[,,,,].fill(0).map((e,t)=>s.createElement(c,{key:t},s.createElement(r.Qm,null,s.createElement(o.A,{variant:"avatar",width:40,height:40,sx:{mr:1}})),s.createElement(r.p4,null,s.createElement(r.Et,null,s.createElement(o.A,{variant:"text",width:"100%"})),s.createElement(r.Et,null,s.createElement(o.A,{width:120}))))))}},73559(e,t,n){n.r(t),n.d(t,{default:()=>N});var r=n(61341),i=n(22220),l=n(16677),a=n(91557),o=n(3556),s=n(8051),d=n(62193),c=n.n(d),u=n(2404),m=n.n(u),p=n(96540),g=n(71468),h=n(80962),v=n(88485),f=n(97837),y=n(40515),b=n(67725),A=n(63461),x=n(97763),w=n(56449),E=n.n(w),k=n(78106),O=n(13586),_=n(10895),C=n(89509);function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let P=(0,o.Ay)("div",{shouldForwardProp:e=>"unread"!==e&&"isActive"!==e})(({theme:e,unread:t,isActive:n})=>({position:"relative",margin:e.spacing(0,1),padding:e.spacing(.5,2),cursor:"pointer",transition:"background-color 300ms ease","&:hover":{background:e.palette.action.hover,borderRadius:e.shape.borderRadius},"&:hover .uiChatItemBtn":{visibility:"visible"},...n&&{".uiChatItemBtn":{visibility:"visible"}}})),I=(0,o.Ay)("div")(({theme:e})=>({flex:1,display:"flex",alignItems:"center",padding:e.spacing(1.5,0),color:e.palette.grey["700"],fontSize:e.spacing(1.75),cursor:"pointer",overflow:"hidden"})),R=(0,o.Ay)("div")(({theme:e})=>({marginRight:e.spacing(1)})),T=(0,o.Ay)("div")(({theme:e})=>({flex:1,minWidth:"0"})),S=(0,o.Ay)("div")(({theme:e})=>({display:"flex",justifyContent:"space-between"})),z=(0,o.Ay)("div")(({theme:e})=>({fontWeight:"bold",fontSize:e.spacing(1.875),lineHeight:e.spacing(2.25),color:e.palette.text.primary,flex:1,minWidth:0,maxWidth:"100%",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"})),F=(0,o.Ay)("div")(({theme:e})=>({color:e.palette.text.secondary,display:"inline-flex",alignItems:"center",fontSize:e.spacing(1.625),lineHeight:e.spacing(2.35)})),$=(0,o.Ay)("div",{slot:"root",shouldForwardProp:e=>"isSelfChat"!==e})(({theme:e,isSelfChat:t})=>({...t&&{minWidth:"24px",minHeight:"40px"},right:e.spacing(1),top:"50%",transform:"translateY(-50%)",position:"absolute",visibility:"hidden"})),B=(0,o.Ay)(A.A,{slot:"UIChatItemBtn",shouldForwardProp:e=>"isActive"!==e})(({theme:e,isActive:t})=>({position:"relative",padding:e.spacing(1,.5),cursor:"pointer",minWidth:e.spacing(3),lineHeight:e.spacing(2.5),width:"35px",height:"35px",borderRadius:40,background:"dark"===e.palette.mode?e.palette.grey["600"]:e.palette.grey["50"],"&:hover":{background:"dark"===e.palette.mode?e.palette.grey["600"]:e.palette.grey["50"]},...t&&{boxShadow:e.shadows[2]}})),W=(0,o.Ay)(({className:e,...t})=>p.createElement(x.A,M({},t,{classes:{popper:e}})))(({theme:e})=>({"& .MuiTooltip-tooltip":{..."dark"===e.palette.mode&&{border:e.mixins.border("secondary")}},"& .MuiTooltip-arrow":{"&::before":{..."dark"===e.palette.mode&&{border:e.mixins.border("secondary")}}}}));function j({item:e,closePopover:t,handleResetSearch:n,setActive:i,active:o}){var d,u;let{usePageParams:m,dispatch:h,i18n:A,ItemActionMenu:x,useActionControl:w}=(0,a.PCX)(),M=m(),j=(0,k.zy)(),L=(0,k.Zp)(),{rid:D}=M,U=(0,v.Iv)(e.id),N=(0,v.f3)(),H=(0,g.d4)(t=>(0,l.a7)(t,e.id)),V=(0,v.GV)(e.id),X=(0,v.Fz)(null==e?void 0:e.userId),Q=(0,v.nb)(null==e?void 0:e.id),q=(0,v.iW)(null==e?void 0:e.id),J=(0,v.sz)(),G=(0,v.y8)(null==e?void 0:e.id),Z=(0,v.hB)(),K=!!((null==q?void 0:q.t)===f.CJ.Direct&&((null==V?void 0:V.blocked)||(null==V?void 0:V.blocker))),Y=!!((null==q?void 0:q.t)===f.CJ.Direct&&((null==V?void 0:V.metafoxBlocked)||(null==V?void 0:V.metafoxBlocker))),ee=!!(K||Y),et=!((null==V?void 0:V.allowMessageFrom)!=="noone"),en=Z&&q&&q.muted&&E()(q.muted)&&!!q.muted.find(e=>e===Z.username),[er]=w(null==e?void 0:e.id,{}),ei=p.useMemo(()=>(0,b.Ue)(N,{room:e,subscription:V,groups:null==Q?void 0:Q.groups,favorite:null==V?void 0:V.f,settings:J,perms:G,isBlocked:ee,isMetaFoxBlocked:Y,isMuted:en,allowMsgNoOne:et,isSelfChat:U}),[Q,V,q,J,G,N,ee,Y,en,et,U]),el=p.useCallback(r=>{if(t&&t(),(null==e?void 0:e.no_join)||!V){(null==e?void 0:e.spotlight_user)?h({type:"chatplus/chatRoom/newConversation",payload:{users:[{value:null==e?void 0:e.username,label:null==e?void 0:e.name}]}}):h({type:"chatplus/room/openChatRoomFromBuddy",payload:{rid:e.id||e._id}}),n&&n();return}"/messages"===j.pathname||D?L({pathname:`/messages/${e.id}`}):h({type:"chatplus/room/openBuddy",payload:{rid:e.id}}),n&&n()},[e,t]),ea=U?1:(null==X?void 0:X.status)||0,eo=!(null==e?void 0:e.no_join)&&!c()(null==e?void 0:e.lastMessage)&&((null==V?void 0:V.alert)||!!(null==V?void 0:V.unread)),es=()=>{if(o===e.id){i(null);return}i(e.id)};return p.createElement(P,{unread:eo,isActive:o===e.id},p.createElement(I,{onClick:el},p.createElement(R,null,p.createElement(O.default,{name:(null==H?void 0:H.name)||e.name,username:(null==H?void 0:H.username)||e.fname||e.username,avatarETag:(null==H?void 0:H.avatarETag)||(null==e?void 0:e.avatarETag),size:40,src:null==H?void 0:H.avatar,status:ea,room:e})),p.createElement(T,null,p.createElement(S,null,p.createElement(z,null,(null==H?void 0:H.name)||e.fname||e.name),(null==e?void 0:e.no_join)?null:p.createElement(F,null,p.createElement(_.A,{value:null==e?void 0:null===(d=e.lastMessage)||void 0===d?void 0:null===(u=d._updatedAt)||void 0===u?void 0:u.$date,format:"ll"}))),p.createElement(C.A,{room:e,unread:eo,subscription:V}))),(null==e?void 0:e.no_join)||!V?null:p.createElement($,{isSelfChat:U,className:"uiChatItemBtn",onClick:es},p.createElement(x,{items:ei,placement:"bottom-end",handleAction:er,scrollClose:!0,popperOptions:{strategy:"fixed"},menuStyles:r.E1,variantPopper:"hidden-outview",control:p.createElement(s.A,null,p.createElement(W,{title:A.formatMessage({id:"more"}),placement:"top"},p.createElement(B,{disableFocusRipple:!0,disableRipple:!0,disableTouchRipple:!0,isActive:o===e.id},p.createElement(y.s4,{icon:"ico-dottedmore-vertical-o"}))))})))}let L="BuddyList-ChatRoom",D=(0,o.Ay)("div",{name:L,slot:"NoResult"})(({theme:e})=>({padding:e.spacing(1.5,0),fontSize:e.spacing(1.75),color:e.palette.text.primary,textAlign:"center"})),U=(0,o.Ay)("div",{name:L,slot:"NoMessages"})(({theme:e})=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",padding:e.spacing(2,0),fontSize:e.spacing(1.875),color:e.palette.grey["600"],textAlign:"center"})),N=function({searchValue:e,closePopover:t,handleResetSearch:n}){var o;let{i18n:d,dispatch:u}=(0,a.PCX)(),[v,f]=p.useState(null),{loading:y}=(0,i.A)(),{directChats:b,publicGroups:A,isFetchDone:x,chatBot:w}=(0,g.d4)(e=>(0,l.U$)(e,null,!1)),E=p.useRef({directChats:b,publicGroups:A,isFetchDone:x,chatBot:w}),k=p.useRef(!0);p.useEffect(()=>{if(k.current){k.current=!1;return}u({type:"chatplus/spotlight",payload:{query:e,users:!0,rooms:!0,checkSortFavorite:!1},meta:{onSuccess(e){E.current=e}}})},[e]),p.useEffect(()=>{e||m()(E.current,{directChats:b,publicGroups:A,isFetchDone:x,chatBot:w})||(E.current={directChats:b,publicGroups:A,isFetchDone:x,chatBot:w})},[b,A,x,w,E,e]);let O=p.useMemo(()=>{var t,n;let r=w&&(null===(t=E.current)||void 0===t?void 0:t.chatBot)?[null===(n=E.current)||void 0===n?void 0:n.chatBot]:[];if(!c()(e))return[...r,...E.current.directChats,...E.current.publicGroups];{let i=[...E.current.directChats,...E.current.publicGroups].sort((e,t)=>{var n,r;return(null==t?void 0:null===(n=t._updatedAt)||void 0===n?void 0:n.$date)-(null==e?void 0:null===(r=e._updatedAt)||void 0===r?void 0:r.$date)});return[...r,...i]}},[w,E.current.directChats,E.current.publicGroups,null===(o=E.current)||void 0===o?void 0:o.chatBot,e]);return x&&!O.length?p.createElement(U,null,d.formatMessage({id:"no_messages"})):e&&!O.length?p.createElement(D,null,d.formatMessage({id:"no_results_found"})):y?p.createElement(s.A,{sx:{px:1}},p.createElement(h.A,null)):p.createElement("div",null,O.slice(0,r.BJ).map(e=>p.createElement(j,{setActive:f,active:v,key:null==e?void 0:e.id,item:e,closePopover:t,handleResetSearch:n})))}},10895(e,t,n){n.d(t,{A:()=>o});var r=n(65121),i=n(91557),l=n(97763),a=n(96540);function o({className:e,value:t,component:n="span",format:o="lll"}){let{moment:s}=(0,i.PCX)();if(!t)return null;let d=s(t),c=d.format("llll"),u=(0,r.rb)(d,o);return a.createElement(l.A,{title:c},a.createElement(n,{role:"link",className:e,"aria-label":c},u))}},89509(e,t,n){n.d(t,{A:()=>v});var r=n(91557),i=n(3556),l=n(96540),a=n(84058),o=n.n(a),s=n(62193),d=n.n(s),c=n(36338),u=n(88485),m=n(35319);let p=(0,i.Ay)("div")(({theme:e})=>({display:"flex",justifyContent:"space-between",marginTop:e.spacing(.25)})),g=(0,i.Ay)("span",{slot:"UnReadDot"})(({theme:e})=>({display:"inline-block",width:12,height:12,backgroundColor:e.palette.primary.main,borderRadius:20,marginTop:e.spacing(.25)})),h=(0,i.Ay)("div",{shouldForwardProp:e=>"unread"!==e})(({theme:e,unread:t})=>({display:"block",color:e.palette.text.secondary,padding:0,minWidth:0,maxWidth:"calc(100% - 12px)",overflow:"hidden",textOverflow:"ellipsis",fontSize:e.spacing(1.625),lineHeight:e.spacing(2.35),whiteSpace:"nowrap",...t&&{fontWeight:e.typography.fontWeightBold},a:{color:e.palette.text.secondary,pointerEvents:"none"},br:{display:"none"}}));function v({room:e,unread:t,subscription:n}){var i,a,s,v,f,y,b,A,x,w,E,k,O,_,C;let M;let{i18n:P}=(0,r.PCX)(),I=(0,u.hB)(),R=null==e?void 0:e.lastMessage;if(!e||(null==e?void 0:e.no_join)||d()(R))return null;let T="",S=(null==R?void 0:R.t)||(null==R?void 0:R.type),z=!1,F=((null==R?void 0:R.owners)||[]).map(e=>e._id).includes(I._id),$=(null==I?void 0:I._id)===(null==R?void 0:null===(i=R.u)||void 0===i?void 0:i._id)?1:0;if(S){let B=R.msg,W=`user_${S}${(null==R?void 0:R.role)?`_${R.role}`:""}`;switch(W=W.replace(/-/g,"_"),"room_changed_privacy"===S&&(B="public"===B?"Public":"Private"),!0){case"deleted"===S||"rm"===S:W="message_was_deleted";break;case(0,c.A5)(S):/(invite)_/.test(S)||/(start)_/.test(S)?(W="started_a_call",$||(W="user_started_call")):W=/(miss)_/.test(S)&&!$?"missed_a_call":"call_ended"}T=W?P.formatMessage({id:W},{msg:B,type:S,name:null==R?void 0:null===(a=R.u)||void 0===a?void 0:a.name,role:null==R?void 0:R.role,user:l.createElement("b",null,null==R?void 0:null===(s=R.u)||void 0===s?void 0:s.name),bold:e=>l.createElement("b",null,e),owner:(null==R?void 0:null===(v=R.owners)||void 0===v?void 0:v.length)?l.createElement("b",null,null==R?void 0:R.owners[0].name):"",username:null==R?void 0:null===(f=R.u)||void 0===f?void 0:f.name,isUserToMe:$,isOwnerToMe:F?1:0,remaining:((null==R?void 0:R.total)||1)-1}):""}else if((null==R?void 0:null===(y=R.attachments)||void 0===y?void 0:y.length)>0){if("file"===R.attachments[0].type){let j=R.attachments.filter(e=>e.image_url).length;T=(null===(b=R.attachments[0])||void 0===b?void 0:b.image_url)?P.formatMessage({id:"user_sent_photos"},{isUserToMe:$?1:0,total:j,username:null==R?void 0:null===(w=R.u)||void 0===w?void 0:w.name}):(null===(A=R.attachments[0])||void 0===A?void 0:A.audio_url)?P.formatMessage({id:"user_sent_an_audio_clip"},{isUserToMe:$?1:0,username:null==R?void 0:null===(E=R.u)||void 0===E?void 0:E.name}):(null===(x=R.attachments[0])||void 0===x?void 0:x.video_url)?P.formatMessage({id:"user_sent_a_video"},{isUserToMe:$?1:0,username:null==R?void 0:null===(k=R.u)||void 0===k?void 0:k.name}):P.formatMessage({id:"user_sent_an_attachment"},{isUserToMe:$?1:0,username:null==R?void 0:null===(O=R.u)||void 0===O?void 0:O.name})}else{let{isQuote:L}=(0,m.checkIsQuote)(null==R?void 0:R.attachments);if(L){let D=(0,c.XC)(R);T=D?l.createElement("span",{dangerouslySetInnerHTML:{__html:D}}):""}}}else{let U=(0,c.XC)(R);T=U?l.createElement("span",{dangerouslySetInnerHTML:{__html:U}}):"",z=!0}return d()(T)?null:l.createElement(p,{"data-testid":o()("last message")},l.createElement(h,{unread:t},z?(M=P.formatMessage({id:"user_sent_a_message"},{isUserToMe:$?1:0,username:null==R?void 0:null===(_=R.u)||void 0===_?void 0:_.name,msg:z?T:""}),(S||(null==R?void 0:null===(C=R.attachments)||void 0===C?void 0:C.length)>0)&&(M=""),M):T),(null==n?void 0:n.alert)||(null==n?void 0:n.unread)?l.createElement(g,null):null)}},67912(e,t,n){n.d(t,{A:()=>c});var r=n(97837),i=n(3556),l=n(97763),a=n(96540),o=n(13586);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let d=(0,i.Ay)(({className:e,...t})=>a.createElement(l.A,s({},t,{classes:{popper:e}})))(({theme:e})=>({"& .MuiTooltip-tooltip":{"&.MuiTooltip-tooltipPlacementLeft":{marginRight:`${e.spacing(1)} !important`}}})),c=(0,a.memo)(function({username:e,name:t,size:n="sm",status:i=null,room:l=null,avatarETag:s,hoverCard:c,showTooltip:u=!1}){return a.createElement(d,{title:u&&(t||e),placement:"left",arrow:!1,PopperProps:{popperOptions:{strategy:"fixed"}}},a.createElement("div",null,a.createElement(o.default,{username:e,size:n,name:t,roomType:r.CJ.Direct,status:i,room:l,avatarETag:s,hoverCard:c})))})},17510(e,t,n){n.d(t,{A:()=>k});var r=n(91557),i=n(96540),l=n(3556);let a=(0,l.Ay)("div",{name:"MsgAttachmentAudio",slot:"uiChatAudioCustom",shouldForwardProp:e=>"isPageAllMessages"!==e&&"msgType"!==e&&"isOwner"!==e&&"isOther"!==e})(({theme:e,isPageAllMessages:t,msgType:n,isOwner:r,isOther:i})=>({width:"300px",maxWidth:"100%",...("message_pinned"===n||"message_unpinned"===n||i)&&{width:r?"177px":"137px"},...("message_pinned"===n||"message_unpinned"===n||i)&&t&&{width:"200px"}})),o=i.memo(function({audio_url:e,msgType:t,isOwner:n,isOther:l,audio_duration:o}){let{usePageParams:s,jsxBackend:d}=(0,r.PCX)(),c=s(),u=(null==c?void 0:c.rid)||!1;return i.createElement(a,{isPageAllMessages:u,msgType:t,isOwner:n,isOther:l},d.render({component:"chatplus.ui.messageWaveForm",props:{autoPlay:!1,url:e,isOwner:n,audioDuration:o,isPageAllMessages:u}}))},(e,t)=>(null==e?void 0:e.audio_url)===(null==t?void 0:t.audio_url)),s="MsgAttachmentImage",d=(0,l.Ay)("div",{name:s})(({theme:e})=>({position:"relative",width:"100%"})),c=(0,l.Ay)("figure",{name:s})(({theme:e})=>({margin:0,display:"block"})),u=(0,l.Ay)("div",{name:s,shouldForwardProp:e=>"isOwner"!==e&&"isPageAllMessages"!==e})(({theme:e,isOwner:t,isPageAllMessages:n})=>({width:"100%",minWidth:t?"200px":"180px",maxWidth:"100%",cursor:"pointer",...n&&{width:"300px",[e.breakpoints.down("sm")]:{width:t?"200px":"180px"}}})),m=(0,l.Ay)("img",{name:s})(({theme:e})=>({position:"absolute",left:0,top:0,width:"100%",borderRadius:e.spacing(1),border:e.mixins.border("secondary")}));function p({isOwner:e,title:t,image_url:n,image_dimensions:l,allowOpenPreview:a=!0}){let{chatplus:o,usePageParams:s}=(0,r.PCX)(),p=s(),g=(null==p?void 0:p.rid)||!1,h=!!l&&l.height/l.width,v=i.useCallback(e=>{a&&o.presentImageView(e,{id:"img0",src:o.sanitizeRemoteFileUrl(n)})},[o,n,a]);return i.createElement(d,null,i.createElement(c,null,i.createElement(u,{isOwner:!!e,isPageAllMessages:g,style:{paddingBottom:`${h?100*h:100}%`}},i.createElement(m,{src:`${o.sanitizeRemoteFileUrl(n)}&width=300`,onClick:v,alt:t}))))}let g="MsgAttachmentImage",h=(0,l.Ay)("div",{name:g,slot:"UIMsgAttachmentImgWrapper"})(({theme:e})=>({position:"relative",width:"100%"})),v=(0,l.Ay)("figure",{name:g})(({theme:e})=>({margin:0,display:"block"})),f=(0,l.Ay)("div",{name:g,shouldForwardProp:e=>"isPageAllMessages"!==e})(({theme:e,isPageAllMessages:t})=>({maxWidth:"100%",cursor:"pointer",marginBottom:"1px",width:"100%",height:"100%",...t&&{width:"100%",height:"100%"}})),y=(0,l.Ay)("img",{name:g})(({theme:e})=>({position:"absolute",left:0,top:0,width:"100%",objectFit:"cover",borderRadius:e.spacing(1),border:e.mixins.border("secondary"),height:"100%"}));function b({image_url:e,images:t,keyIndex:n}){let{chatplus:l,usePageParams:a}=(0,r.PCX)(),o=a(),s=(null==o?void 0:o.rid)||!1,d=t&&t.length?t.map((e,t)=>({id:t,src:l.sanitizeRemoteFileUrl(e.image_url)})):[];return i.createElement(h,null,i.createElement(v,null,i.createElement(f,{isPageAllMessages:s,style:{paddingBottom:"100%"}},i.createElement(y,{src:`${l.sanitizeRemoteFileUrl(e)}&width=150`,onClick(t){l.presentImageView(t,{id:parseInt(n),src:l.sanitizeRemoteFileUrl(e)},d)},alt:"MsgAttachmentMultiImage"}))))}var A=n(85376);let x=(0,l.Ay)("figure",{name:"MsgAttachmentVideo"})(({theme:e})=>({margin:0,display:"block"})),w=i.memo(function({video_url:e,video_width:t,video_height:n,thumb_url:l,isOwner:a,allowOpenPreview:o=!0}){let{chatplus:s,usePageParams:d,useIsMobile:c}=(0,r.PCX)(),u=c(),m=`msg-video-${e}`,p=d(),g=(null==p?void 0:p.rid)||!1,h=!u&&g?300:186;return i.createElement(x,null,i.createElement(A.A,{width:h,height:t<=h?"auto":n/(t<=h?h:t/h),src:s.sanitizeRemoteFileUrl(e),idPlaying:m,thumb_url:l,allowOpenPreview:o}))},(e,t)=>(null==e?void 0:e.video_url)===(null==t?void 0:t.video_url)&&(null==e?void 0:e.allowOpenPreview)===(null==t?void 0:t.allowOpenPreview));function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function k({image_url:e,image_dimensions:t,video_url:n,title:l,video_type:a,video_thumb_url:s,audio_url:d,layout:c,totalImages:u,isOwner:m,msgType:g,isOther:h,keyIndex:v,allowOpenPreview:f=!0,audio_duration:y,...A}){let{chatplus:x}=(0,r.PCX)();return d?i.createElement(o,{audio_url:x.sanitizeRemoteFileUrl(d),audio_duration:y,msgType:g,isOwner:m,isOther:h}):n?i.createElement(w,E({isOwner:m,video_url:n,video_type:x.sanitizeRemoteFileUrl(a),thumb_url:x.sanitizeRemoteFileUrl(s),allowOpenPreview:f},A)):e&&"multi-image"===c?i.createElement(b,{title:l,images:u,image_url:e,isOwner:m,msgType:g,isOther:h,keyIndex:v}):e?i.createElement(p,{isOwner:m,title:l,image_dimensions:t,image_url:e,allowOpenPreview:f}):null}},78976(e,t,n){n.d(t,{A:()=>R});var r=n(96540),i=n(88485),l=n(36338),a=n(65121),o=n(91557),s=n(40515),d=n(3556),c=n(8051),u=n(67912),m=n(17510);function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let g="MsgAttachmentMultiMedia",h=(0,d.Ay)("div",{name:g,slot:"uiMsgImageAttachmentWrapper",shouldForwardProp:e=>"isOwner"!==e})(({theme:e,isOwner:t})=>({display:"flex",alignItems:"center",flexWrap:"wrap",justifyContent:t?"flex-end":"flex-start",marginTop:e.spacing(.25),width:"100%",gap:e.spacing(.5)})),v=(0,d.Ay)("div",{name:g,slot:"uiMsgImageAttachmentItem",shouldForwardProp:e=>"isPageAllMessages"!==e&&"isLastItem"!==e&&"isAudio"!==e&&"totalImages"!==e})(({theme:e,isPageAllMessages:t,isLastItem:n,isAudio:r,totalImages:i})=>({flexBasis:`calc(100% / 3 - ${e.spacing(.5)})`,...r&&{width:"185px"},...2===i&&{flexBasis:`calc(100% / 2 - ${e.spacing(.5)})`}}));function f({mediaItems:e,isOwner:t,msgType:n,isOther:i}){let{usePageParams:l}=(0,o.PCX)(),a=l(),s=(null==a?void 0:a.rid)||!1;return r.createElement(h,{isOwner:t},e.map((l,a)=>r.createElement(v,{isPageAllMessages:s,isLastItem:a===e.length-1,isAudio:!!(null==l?void 0:l.audio_url),key:`k${a}`,totalImages:e.length},r.createElement(m.A,p({},l,{layout:"multi-image",keyIndex:a,totalImages:e,isOwner:t,msgType:n,isOther:i})))))}function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let b="MsgAttachment",A=(0,d.Ay)("div",{name:b,slot:"UIMsgAttachment",shouldForwardProp:e=>"isOwner"!==e&&"isAudio"!==e&&"isTypeFile"!==e&&"isOther"!==e&&"totalImage"!==e&&"msgType"!==e})(({theme:e,isOwner:t,isAudio:n,isTypeFile:r,isOther:i,msgType:l,totalImage:a})=>({zIndex:2,maxWidth:"100%",display:"flex",flexDirection:"column",alignItems:"flex-start",paddingBottom:e.spacing(.5),marginTop:e.spacing(.25),overflow:"hidden",...(r||a)&&{width:"100%"},...(n||"message_pinned"===l||"message_unpinned"===l||i)&&{backgroundColor:e.palette.grey["100"],..."dark"===e.palette.mode&&{backgroundColor:e.palette.grey["600"]},padding:e.spacing(.5,.75),borderRadius:e.spacing(1.25),"& a":{color:t?"#fff":e.palette.text.primary,textDecoration:"underline",cursor:"pointer"},...t&&{backgroundColor:e.palette.primary.main,color:"#fff !important"}},...t&&{alignItems:"flex-end"},...n&&{width:"185px",paddingTop:e.spacing(1.5)}})),x=(0,d.Ay)("div",{name:b,slot:"TitleLinkStyled",shouldForwardProp:e=>"isOwner"!==e&&"isVideo"!==e&&"isImage"!==e&&"isAudio"!==e&&"isTypeFile"!==e})(({theme:e,isOwner:t,isVideo:n,isImage:r,isAudio:i,isTypeFile:l})=>({borderRadius:e.spacing(1),fontSize:e.spacing(1.75),padding:e.spacing(1),overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",display:"inline-block",maxWidth:"100%",wordBreak:"break-word",wordWrap:"break-word",backgroundColor:e.palette.grey["100"],..."dark"===e.palette.mode&&{backgroundColor:e.palette.grey["600"]},...t&&{backgroundColor:e.palette.primary.main,color:"#fff"},...(n||r)&&{display:"none"},...i&&{width:"300px"},cursor:"pointer","& .ico":{marginRight:e.spacing(1)}})),w=(0,d.Ay)("div",{name:b,slot:"DescriptionStyled",shouldForwardProp:e=>"isOwner"!==e&&"isVideo"!==e})(({theme:e,isOwner:t,isVideo:n})=>({backgroundColor:e.palette.grey["100"],..."dark"===e.palette.mode&&{backgroundColor:e.palette.grey["600"]},borderRadius:e.spacing(1),fontSize:e.spacing(1.75),padding:e.spacing(1),display:"inline-block",...t&&{backgroundColor:e.palette.primary.main,color:"#fff"}})),E=(0,d.Ay)("div",{name:b,slot:"uiMsgAttachmentAuthor"})(({theme:e})=>({display:"flex",justifyContent:"flex-start",alignItems:"center","& .MuiAvatar-root":{fontSize:`${e.spacing(1)} !important`},strong:{padding:e.spacing(0,.5,0,.25)}})),k=(0,d.Ay)("div",{name:b,slot:"uiMsgAttachmentFlex"})(({theme:e})=>({textAlign:"start"})),O=(0,d.Ay)("div",{name:b,slot:"uiMsgAttachmentText"})(({theme:e})=>({margin:e.spacing(.5,0)})),_=(0,d.Ay)("div",{name:b,slot:"UIMsgAttachmentTextDelete"})(({theme:e})=>({margin:e.spacing(.5),marginLeft:0,fontStyle:"italic"})),C=(0,d.Ay)("div",{name:b,slot:"uiMsgAttachmentInfoWrapper",shouldForwardProp:e=>"msgType"!==e&&"isOther"!==e})(({theme:e,msgType:t,isOther:n})=>({...("message_pinned"===t||"message_unpinned"===t||n)&&{borderLeft:"2px solid #a2a2a2",paddingLeft:e.spacing(1),width:"100%"}})),M=(0,d.Ay)(s.mE,{name:b,slot:"uiMsgAttachmentLink"})(({theme:e})=>({cursor:"pointer","& .ico":{marginRight:e.spacing(1)}}));function P({mentions:e=[],title:t,author_real_name:n,author_name:d,author_id:p,text:g,image_url:h,image_dimensions:v,audio_url:b,audio_duration:P,video_url:I,video_type:R,title_link:T,description:S,video_thumb_url:z,attachments:F,type:$,layout:B,isOwner:W,msgType:j,t:L,video_width:D,video_height:U}){let{chatplus:N,i18n:H}=(0,o.PCX)(),V="file"===$,{count:X,data:Q}=(0,a.Ry)(F),q=(0,i.Fz)(p);return r.createElement(A,{isOwner:W,isAudio:!!b,isTypeFile:!!V,isOther:!b&&!V,msgType:j,totalImage:X},r.createElement(C,{msgType:j,isOther:!b&&!V},d?r.createElement(E,null,r.createElement(u.A,{size:16,name:(null==q?void 0:q.name)||d,username:(null==q?void 0:q.username)||d,avatarETag:null==q?void 0:q.avatarETag}),r.createElement("strong",null,n||d)):null,r.createElement(k,null,"rm"===L?r.createElement(_,null,H.formatMessage({id:"message_was_deleted"})):null,g&&"rm"!==L?r.createElement(O,{dangerouslySetInnerHTML:{__html:(0,l.Ay)(g,{mentions:e})}}):null,F&&F.length?r.createElement(c.A,{mt:1},X>1?r.createElement(f,{mediaItems:Q,isOwner:W,msgType:j,isOther:!b&&!V}):r.createElement(r.Fragment,null,F.map((e,t)=>r.createElement(r.Fragment,{key:`k${t}`},e.video_url||e.image_url||e.audio_url?r.createElement(m.A,y({},e,{key:`k${t}`,msgType:j,isOther:!b&&!V})):r.createElement(r.Fragment,null,e.title_link?r.createElement(M,{lines:1},r.createElement("div",{style:{display:"inline"},onClick:()=>(0,a.NK)(N.sanitizeRemoteFileUrl(e.title_link),!1,!0)},r.createElement(s.s4,{icon:"ico-arrow-down-circle"}),e.title)):null))))):null)),r.createElement(m.A,{image_url:h,video_url:I,audio_url:b,audio_duration:P,title:t,video_type:R,video_thumb_url:z,layout:B,image_dimensions:v,isOwner:W,video_width:D,video_height:U}),T?r.createElement(x,{isOwner:W,isVideo:!!I,isImage:!!h,isAudio:!!b,isTypeFile:!!V},r.createElement(s.mE,{lines:1,onClick:()=>(0,a.NK)(N.sanitizeRemoteFileUrl(T),!1,!0)},r.createElement(s.s4,{icon:"ico-arrow-down-circle"}),t)):null,S?r.createElement(w,{isOwner:W,isVideo:!!I,isImage:!!h,isAudio:!!b,isTypeFile:!!V},S):null)}function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function R({message:e,isOwner:t,msgType:n,dataQuote:i,isQuote:l}){var a;if(!(null===(a=e.attachments)||void 0===a?void 0:a.length))return null;let o=e.attachments;if(l&&i&&(o=o.filter(e=>!e.message_id)),!o&&!o.length)return null;let s=o.filter(e=>e.image_url);return s.length>1?r.createElement(f,{mediaItems:s,isOwner:t}):o.map((e,i)=>r.createElement(P,I({},e,{key:`k${i}`,isOwner:t,msgType:n})))}},35319(e,t,n){n.r(t),n.d(t,{checkIsQuote:()=>$,default:()=>B});var r=n(36338),i=n(3556),l=n(97763),a=n(62193),o=n.n(a),s=n(96540),d=n(78976),c=n(33440),u=n(65121),m=n(91557),p=n(40515),g=n(87773),h=n(8051),v=n(17510),f=n(61341);function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let b="MsgQuote",A=(0,i.Ay)("div",{name:b,slot:"UIMsgAttachment",shouldForwardProp:e=>"isOwner"!==e&&"isAudio"!==e&&"isTypeFile"!==e&&"isOther"!==e&&"msgType"!==e})(({theme:e,isOwner:t,isAudio:n,isTypeFile:r,isOther:i,msgType:l})=>({opacity:"0.8",marginBottom:e.spacing(-2),marginLeft:e.spacing(1),marginRight:0,marginTop:e.spacing(.25),paddingBottom:e.spacing(3),maxWidth:"calc(100% - 8px)",display:"flex",flexDirection:"row",overflow:"hidden",border:e.mixins.border("secondary"),borderRadius:e.spacing(1),minHeight:"70px",cursor:"pointer",...(n||"message_pinned"===l||"message_unpinned"===l||i)&&{"& a":{color:e.palette.text.primary,textDecoration:"underline",cursor:"pointer"},...t&&{color:e.palette.text.secondary,marginRight:e.spacing(1),marginLeft:0}}})),x=(0,i.Ay)("div",{name:b,slot:"uiMsgAttachmentAuthor"})(({theme:e})=>({display:"flex",justifyContent:"flex-start",alignItems:"center","& .MuiAvatar-root":{fontSize:`${e.spacing(1)} !important`}})),w=(0,i.Ay)(g.A)(({theme:e})=>({color:"light"===e.palette.mode?e.palette.grey.A200:e.palette.text.primary})),E=(0,i.Ay)("div",{name:b,slot:"MsgAttachmentFlex",shouldForwardProp:e=>"isAttachment"!==e})(({theme:e,isAttachment:t})=>({textAlign:"start",...t&&{maxWidth:"300px"}})),k=(0,i.Ay)(p.mE,{name:b,slot:"uiMsgAttachmentText"})(({theme:e})=>({color:e.palette.text.secondary})),O=(0,i.Ay)("div",{name:b,slot:"UIMsgAttachmentTextDelete"})(({theme:e})=>({margin:e.spacing(.5),marginLeft:0,fontStyle:"italic"})),_=(0,i.Ay)("div",{name:b,slot:"uiMsgAttachmentInfoWrapper",shouldForwardProp:e=>"msgType"!==e&&"isOther"!==e})(({theme:e,msgType:t,isOther:n})=>({...("message_pinned"===t||"message_unpinned"===t||n)&&{overflow:"hidden",margin:e.spacing(1,1,0,0)}})),C=(0,i.Ay)(p.mE,{name:b,slot:"uiMsgAttachmentLink"})(({theme:e})=>({cursor:"pointer","& .ico":{fontSize:e.mixins.pxToRem(12),marginRight:e.spacing(.5)}})),M=(0,i.Ay)("div")(({theme:e})=>({width:e.spacing(.5),height:"100%",backgroundColor:e.palette.grey["100"]})),P=(0,i.Ay)("div")(({theme:e})=>({width:e.spacing(3),minWidth:e.spacing(3),marginTop:e.spacing(1.5),display:"flex",justifyContent:"center",alignItems:"center"})),I=(0,i.Ay)(p.s4)(({theme:e})=>({marginRight:e.spacing(.5),display:"flex",alignItems:"center"}));function R({dataQuote:e,isOwner:t,rid:n,scrollMessage:i}){let{i18n:l,dispatch:a}=(0,m.PCX)();if(!e)return null;let{mentions:d=[],author_real_name:c,author_name:g,text:b,textRaw:R,audio_url:T,attachments:S,type:z,msgType:F,t:$}=e,B="file"===z,W=R||b,j=W?(0,r.Nj)(W,{mentions:d,onlyShowText:!0}):"",{count:L}=(0,u.Ry)(S),D=()=>{"rm"!==$&&a({type:f.ci,payload:{roomId:n,mid:null==e?void 0:e.message_id,mode:"quote"},meta:{onSuccess:i}})};return s.createElement(A,{isOwner:t,isAudio:!!T,isTypeFile:!!B,isOther:!T&&!B,msgType:F,onClick:D},s.createElement(P,null,s.createElement(M,null)),s.createElement(_,{msgType:F,isOther:!T&&!B},g?s.createElement(x,null,s.createElement(w,{component:"h2",variant:"h5"},c||g)):null,s.createElement(E,{isAttachment:null==S?void 0:S.length},"rm"===$?s.createElement(O,null,l.formatMessage({id:"message_was_deleted"})):null,o()(j)||"rm"===$?null:s.createElement(k,{lines:1,dangerouslySetInnerHTML:{__html:j}}),"rm"!==$&&S&&S.length?s.createElement(h.A,{mt:.5},L>1?s.createElement(k,{lines:1},s.createElement(h.A,{sx:{display:"flex",alignItems:"center"}},s.createElement(I,{icon:"ico-photos-alt-o"}),l.formatMessage({id:"total_photo"},{value:L}))):s.createElement(s.Fragment,null,S.map((e,t)=>s.createElement(s.Fragment,{key:`k${t}`},e.video_url||e.image_url?s.createElement(v.A,y({},e,{key:`k${t}`,msgType:F,isOther:!T&&!B,allowOpenPreview:!1})):e.audio_url?s.createElement(k,{lines:1},(null==e?void 0:e.title)||l.formatMessage({id:"file_attachment"})):s.createElement("div",null,e.title_link?s.createElement(C,{lines:1},s.createElement("div",{style:{display:"inline"}},s.createElement(p.s4,{icon:"ico-paperclip-alt"}),e.title)):null))))):null)))}var T=n(88485);let S="MessageText",z=(0,i.Ay)("div",{name:S,slot:"uiChatMsgItemMsg",shouldForwardProp:e=>"isOwner"!==e&&"isQuote"!==e&&"isMention"!==e&&"activeSearch"!==e&&"isMessageFilter"!==e})(({theme:e,isOwner:t,isQuote:n,isMention:r,activeSearch:i,isMessageFilter:l})=>({zIndex:2,borderRadius:e.spacing(1),fontSize:e.mixins.pxToRem(15),padding:e.spacing(1.25),display:"flex",alignItems:"center","& .mention":{fontWeight:"bold",textDecoration:"none","&:hover":{cursor:"pointer",textDecoration:"underline"}},backgroundColor:e.palette.grey["100"],..."dark"===e.palette.mode&&{backgroundColor:e.palette.grey["600"]},overflowWrap:"break-word",...!r&&{maxWidth:"100%"},"& div:first-of-type":{width:"100%"},"& a":{...!r&&{maxWidth:"100%"},overflowWrap:"break-word",color:e.palette.text.primary,textDecoration:"underline",cursor:"pointer",...r&&{textDecoration:"none","&:hover":{textDecoration:"underline"}}},...t&&!l&&{backgroundColor:e.palette.primary.main,color:"#fff !important","& a":{color:"#fff",textDecoration:"underline"}},...i&&{"& div":{background:"#000",color:"#fff","& a":{color:"#fff"}}}})),F=(0,i.Ay)("div",{name:S,slot:"uiChatMsgItemBodyInnerWrapper",shouldForwardProp:e=>"isOwner"!==e&&"isSearch"!==e&&"isMessageFilter"!==e})(({theme:e,isOwner:t,isSearch:n,isMessageFilter:r})=>({width:"100%",display:"flex",flexDirection:"column",alignItems:"flex-start",...!(n||r)&&t&&{alignItems:"flex-end"}})),$=e=>{var t;let n=e&&e.length&&(null===(t=e[e.length-1])||void 0===t?void 0:t.type)!=="file";if(!n)return{isQuote:n,dataQuote:null};{let r=e.filter(e=>e.message_id);return{isQuote:n,dataQuote:r?r[0]:null}}};function B({message:e,isOwner:t,createdDate:n,tooltipPosition:i,showActiveSearch:a=!0,isMessageFilter:u=!1,scrollMessage:m,isSearch:p=!1}){let[g,h]=s.useState(!1),v=e.msg?(0,r.Ay)(e.msg,{mentions:e.mentions}):null,{isQuote:y,dataQuote:b}=$(null==e?void 0:e.attachments),A=(0,T.nb)(null==e?void 0:e.rid),{msgSearch:x}=A||{},w=s.useMemo(()=>{if(!a||o()(x)||(null==x?void 0:x.mode)===f.Dn)return!1;let t=(null==x?void 0:x.id)===(null==e?void 0:e.id);return(null==x?void 0:x.mQuoteId)===(null==e?void 0:e.id)&&(t=g),t},[a,null==x?void 0:x.mQuoteId,null==x?void 0:x.id,null==x?void 0:x.mode,null==e?void 0:e.id,g]);return s.useEffect(()=>((null==x?void 0:x.mQuoteId)===(null==e?void 0:e.id)&&(h(!0),setTimeout(()=>{h(!1)},f.Uk)),()=>{h(!1)}),[null==e?void 0:e.id,null==x?void 0:x.mQuoteId]),s.createElement(l.A,{title:n,placement:i,PopperProps:{variant:"hidden-partview"}},s.createElement(F,{isOwner:t,isSearch:p,isMessageFilter:u},y?s.createElement(R,{dataQuote:b,isOwner:t,rid:null==e?void 0:e.rid,scrollMessage:m}):null,v?s.createElement(z,{activeSearch:w,isMention:!o()(e.mentions),isQuote:y,isOwner:t,isMessageFilter:u},s.createElement("div",{dangerouslySetInnerHTML:{__html:v}})):null,s.createElement(d.A,{message:e,isOwner:t,isQuote:y,dataQuote:b}),s.createElement(c.A,{message:e})))}},33440(e,t,n){n.d(t,{A:()=>A});var r=n(96540),i=n(65121),l=n(40515),a=n(3556),o=n(62193),s=n.n(o);let d="MsgEmbed",c=(0,a.Ay)("div",{name:d,slot:"uiMsgEmbed"})(({theme:e})=>({marginTop:"4px",marginBottom:"8px",width:"400px",maxWidth:"100%",cursor:"pointer"})),u=(0,a.Ay)("div",{name:d,slot:"uiMsgEmbedOuter"})(({theme:e})=>({display:"flex",flexDirection:"column",borderRadius:"8px",border:e.mixins.border("secondary"),color:"#555555"})),m=(0,a.Ay)("div",{name:d,slot:"ItemMedia"})(({theme:e})=>({width:"100%"})),p=(0,a.Ay)("div",{name:d,slot:"ItemMediaSrc"})(({theme:e})=>({width:"100%",display:"block",position:"relative",backgroundSize:"cover",backgroundPosition:"center center",backgroundRepeat:"no-repeat",backgroundOrigin:"border-box",border:"1px solid rgba(0, 0, 0, 0.1)",borderRadius:"8px 8px 0 0",backgroundColor:"transparent",borderBottom:"1px solid rgba(0, 0, 0, 0.1)","&:before":{content:"''",display:"block",paddingBottom:"56%"}})),g=(0,a.Ay)("div",{name:d,slot:"ItemInner"})(({theme:e})=>({flex:1,minWidth:0,padding:"8px"})),h=(0,a.Ay)(l.mE,{name:d,slot:"ItemTitle"})(({theme:e})=>({marginBottom:"2px",color:"light"===e.palette.mode?e.palette.grey["900"]:e.palette.text.primary})),v=(0,a.Ay)(l.mE,{name:d,slot:"ItemUrl"})(({theme:e})=>({marginBottom:"2px",color:e.palette.text.secondary})),f=(0,a.Ay)(l.mE,{name:d,slot:"ItemDescription"})(({theme:e})=>({color:"light"===e.palette.mode?e.palette.grey["900"]:e.palette.text.primary}));function y({url:e,meta:t,parsedUrl:n,ignoreParse:l}){let a=!l&&(t&&!s()(t)||n&&!s()(n));if(!a)return null;let{ogTitle:o,ogDescription:d,ogImage:y,oembedThumbnailUrl:b,oembedTitle:A,oembedDescription:x}=t,w=n.host,E=o||A,k=d||x;return r.createElement(c,null,r.createElement(u,{onClick:()=>(0,i.NK)(e,!0)},y||b?r.createElement(m,null,r.createElement(p,{style:{backgroundImage:`url(${y||b})`}})):r.createElement(m,null,r.createElement("span",{className:"item-media-src media-default"})),r.createElement(g,null,E?r.createElement(h,{lines:2,variant:"h6"},E):null,r.createElement(v,{lines:2,variant:"body2"},w),k?r.createElement(f,{lines:2,variant:"h6"},k):null)))}function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function A({message:e}){var t;return(null===(t=e.urls)||void 0===t?void 0:t.length)?e.urls.filter(e=>!(null==e?void 0:e.ignoreParse)&&e.meta&&e.parsedUrl).map((e,t)=>r.createElement(y,b({},e,{key:`k${t}`}))):null}},67999(e,t,n){n.d(t,{A:()=>F});var r=n(96540),i=n(3556),l=n(14931),a=n(8051),o=n(97763),s=n(40244),d=n(96327),c=n(8586),u=n(58654),m=n(90590),p=n(64992),g=n(99520),h=n(4634),v=n(91557),f=n(1882),y=n.n(f),b=n(84149);let A="control-video",x=(0,i.Ay)("div",{name:A,slot:"root"})(({theme:e})=>({position:"absolute",bottom:0,right:0,left:0,transition:"all 150ms ease",width:"100%",userSelect:"none"})),w=(0,i.Ay)("div",{name:A,slot:"bottom",shouldForwardProp:e=>"isMinimize"!==e})(({theme:e,isMinimize:t})=>({width:"100%",padding:e.spacing(0,t?1:2),maxHeight:"65%",backgroundImage:"linear-gradient(0deg, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.35) 40%, transparent)",borderRadius:e.shape.borderRadius})),E=(0,s.A)({root:{color:"#fff",width:"10px !important"},thumb:{width:"16px !important",height:"16px !important",boxShadow:"none !important",color:"#fff"},track:{width:"10px !important"},rail:{color:"#fff"}})(l.Ay),k=(0,i.Ay)(a.A,{name:A,slot:"VolumeSliderWrapper",shouldForwardProp:e=>"isHover"!==e&&"isMinimize"!==e})(({theme:e,isHover:t,isMinimize:n})=>({height:70,visibility:"hidden",opacity:0,transition:"all 300ms ease",position:"absolute",bottom:"100%",paddingBottom:e.spacing(2),left:0,...n&&{height:50,paddingBottom:0},...t&&{visibility:"visible",opacity:1}})),O=(0,i.Ay)(a.A,{name:A,slot:"ButtonVolume"})(({theme:e})=>({display:"flex",flexDirection:"column",alignItems:"center",position:"relative",padding:e.spacing(1)})),_=(0,s.A)({root:{padding:0,height:"3px !important",color:"#fff !important",display:"flex",justifyContent:"center",alignItems:"center",flex:1,"& .MuiSlider-thumb:is(:focus, :hover, $active, .Mui-active)":{display:"inline-block !important"}},thumb:{height:"14px !important",width:"14px !important",backgroundColor:"#fff !important",border:"2px solid currentColor",marginTop:0,marginLeft:0,display:"none !important","&:focus, &:hover, &$active":{boxShadow:"inherit !important"}},active:{},valueLabel:{left:"calc(-50% + 4px)"},track:{border:"0 !important",height:"4px !important",borderRadius:4,width:"100%"},rail:{height:"4px !important",borderRadius:4}})(l.Ay),C=(0,i.Ay)("div",{name:A,slot:"slider",shouldForwardProp:e=>"isMinimize"!==e})(({theme:e,isMinimize:t})=>({display:"flex",alignItems:"center",padding:e.spacing(0,2),flex:1,paddingLeft:0,...t&&{paddingRight:e.spacing(.75),paddingLeft:e.spacing(.75)}})),M=(0,i.Ay)("div",{name:A,slot:"ControlBox"})(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"space-between"})),P=(0,i.Ay)("div",{name:A,slot:"InnerControls",shouldForwardProp:e=>!/visible|isMinimize/i.test(e)})(({theme:e,visible:t,isMinimize:n})=>({display:"flex",...!n&&{padding:e.spacing(1.25,0)},alignItems:"center",width:"100%",...!t&&{"& > *":{opacity:0}}})),I=(0,i.Ay)("div",{name:A,slot:"icon-button"})(({theme:e})=>({display:"flex",alignItems:"center",color:"#fff !important",fontSize:e.mixins.pxToRem(15),zIndex:1,"&:hover":{cursor:"pointer"}})),R=(0,i.Ay)(a.A,{name:A,slot:"icon-button"})(({theme:e})=>({padding:e.spacing(1)})),T=(0,i.Ay)("span",{name:A,slot:"TimeSpan"})(({theme:e})=>({color:"#fff",fontSize:e.mixins.pxToRem(12),"& > span":{minWidth:"40px",display:"inline-block","&:nth-of-type(1)":{textAlign:"end"},"&:nth-of-type(2)":{textAlign:"start"}}})),S=(0,i.Ay)(a.A,{name:A,slot:"ProgressWrapper"})(({theme:e})=>({position:"relative",width:"100%",height:"100%",display:"flex",alignItems:"center",flex:1})),z=e=>{var t;let{onPlayPause:n,playing:i,played:l,onSeek:a,onSeekMouseUp:s,onVolumeChangeHandler:f,volume:A,mute:z,onMute:F,formatDuration:$,duration:B,currentTime:W,onMouseSeekDown:j,controlRef:L,loaded:D,onFullScreen:U,showFullScreen:N=!1,isMinimize:H}=e||{},{i18n:V,useIsMobile:X}=(0,v.PCX)(),Q=X(!0),[q,J]=r.useState(!1),[G,Z]=r.useState(!0),[K,Y]=r.useState(""),ee=r.useRef({x:0}),et=r.useRef(null),en=r.useRef(null),er=()=>{y()(U)&&U()};r.useImperativeHandle(L,()=>({setVisible(e){Z(e)},visible:G}));let ei=r.useCallback(e=>{try{let t=e.currentTarget.getBoundingClientRect(),n=e.clientX-e.currentTarget.getBoundingClientRect().left,r=(0,b.f)(Math.max(0,n/t.width*B));Y(r),ee.current={x:e.clientX},null!=et.current&&et.current.update()}catch(i){}},[Y,B]);return r.createElement(x,{ref:L},r.createElement(w,{isMinimize:H},r.createElement(M,null,r.createElement(P,{visible:G,isMinimize:H},r.createElement(I,{onClick:n},1===l?r.createElement(h.A,{fontSize:"medium"}):i?r.createElement(d.A,{fontSize:"medium"}):r.createElement(c.A,{fontSize:"medium"})),r.createElement(C,{isMinimize:H},H?null:r.createElement(T,null,r.createElement("span",null,W)," / ",r.createElement("span",null,$)),r.createElement(S,null,r.createElement(o.A,{title:K,placement:"top",arrow:!0,PopperProps:{container:null!==(t=document.fullscreenElement)&&void 0!==t?t:document.body,popperRef:et,sx:{pointerEvents:"none",display:G?void 0:"none !important"},anchorEl:{getBoundingClientRect:()=>new DOMRect(ee.current.x,en.current.getBoundingClientRect().y+10,0,0)}}},r.createElement(_,{min:0,max:100,value:100*l,onChange:a,onChangeCommitted:s,onMouseDown:j,onMouseMove:ei,ref:en})),r.createElement(_,{disabled:!0,min:0,max:100,value:100*D,sx:{position:"absolute",top:0,left:0,opacity:.3}}))),H?null:r.createElement(R,null,r.createElement(o.A,{title:V.formatMessage({id:N?"exit_full_screen":"switch_to_full_screen"})},r.createElement(I,{onClick:er},N?r.createElement(p.A,null):r.createElement(g.A,null)))),r.createElement(O,{sx:{opacity:"1 !important"},onMouseEnter:()=>J(!0),onMouseLeave:()=>J(!1)},Q?null:r.createElement(k,{isHover:q,isMinimize:H},r.createElement(E,{min:0,max:1,step:.1,orientation:"vertical",onChange:f,value:A})),r.createElement(I,{onClick:F},z?r.createElement(u.A,{fontSize:"medium"}):r.createElement(m.A,{fontSize:"medium"})))))))},F=z},27571(e,t,n){n.d(t,{A:()=>c});var r=n(8051),i=n(89481),l=n(3556),a=n(96540);let o="loading-video",s=(0,l.Ay)(r.A,{name:o,slot:"backdrop"})(({theme:e})=>({position:"absolute",left:0,top:0,bottom:0,right:0,zIndex:10})),d=(0,l.Ay)(r.A,{name:o,slot:"conent"})(({theme:e})=>({position:"absolute",left:"50%",top:"50%",marginLeft:-20,marginTop:-20}));function c({size:e=40}){return a.createElement(s,{"data-testid":"loadingIndicator"},a.createElement(d,null,a.createElement(i.A,{color:"primary",size:e})))}},84149(e,t,n){n.d(t,{f:()=>r,h:()=>i});let r=e=>{if(isNaN(e)||0===e)return"00:00";let t=new Date(1e3*e),n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds().toString().padStart(2,"0");return n?`${n}:${r.toString().padStart(2,"0")} `:`${r}:${i}`},i=(e,t)=>{let n=e/t;return isNaN(n)||0===n?"56.25%":`${e/t*100}%`}},85376(e,t,n){n.d(t,{A:()=>R});var r=n(91557),i=n(40515),l=n(3556),a=n(8051),o=n(96540),s=n(26287),d=n(47695),c=n(97200),u=n.n(c),m=n(67999),p=n(84149),g=n(27571),h=n(67725);function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let f=(0,s.Ay)({resolved:{},chunkName:()=>"VideoPlayer",isReady(e){let t=this.resolve(e);return!0===this.resolved[t]&&!!n.m[t]},importAsync:()=>n.e("VideoPlayer").then(n.bind(n,13554)),requireAsync(e){let t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then(e=>(this.resolved[t]=!0,e))},requireSync(e){let t=this.resolve(e);return n(t)},resolve:()=>13554}),y="VideoPlayer",b=(0,l.Ay)(a.A,{name:y,slot:"root"})(({theme:e})=>({width:"100%",height:"100%",display:"flex",alignItems:"center",overflow:"hidden",position:"relative","& .react-player__preview":{position:"relative","&:before":{content:'""',position:"absolute",top:0,bottom:0,left:0,right:0,backgroundColor:"#000",opacity:.4}},"& .ico-play-circle-o":{fontSize:e.mixins.pxToRem(48),color:"#fff",position:"relative"}})),A=(0,l.Ay)("div",{name:y,slot:"playerContainer",shouldForwardProp:e=>!/ratioPercent/i.test(e)})(({theme:e,ratioPercent:t})=>({width:"100%",height:"100%",...t&&{"&:before":{content:'""',paddingTop:null!=t?t:"56.25%",backgroundColor:e.palette.grey.A700,display:"block",width:"100%",borderRadius:e.shape.borderRadius}}})),x=(0,l.Ay)(a.A,{name:y,slot:"playerWrapper"})(({theme:e})=>({width:"100%",height:"100%"})),w=(0,l.Ay)(f,{name:y,slot:"reactPlayer"})(({theme:e})=>({display:"flex",minHeight:"104px",".controls":{width:"10px"},"& video":{maxWidth:"100%",display:"inline-block",borderRadius:e.shape.borderRadius}})),E=(0,l.Ay)("div",{name:y,slot:"ThumbImageWrapper"})(({theme:e})=>({width:"100%",height:"100%",position:"absolute",top:0,zIndex:1,filter:"brightness(0.7)"})),k=(0,l.Ay)(i.s4,{name:y,slot:"CustomPlayButton"})({position:"absolute !important",top:0,bottom:0,left:0,right:0,margin:"auto",width:"fit-content",height:"fit-content",zIndex:2,pointerEvents:"none"}),O=(0,l.Ay)(i._V,{name:y,slot:"imageThumbnail"})(({theme:e})=>({width:"100%",height:"100%","& img":{borderRadius:e.shape.borderRadius}})),_=0,C=e=>Math.min(e/100,.99),M=o.forwardRef((e,t)=>o.createElement(w,v({},e,{ref:t}))),P={},I={};function R(e){var t,n,l,s,c;let{src:v,autoPlay:f=!1,autoplayIntersection:y=!1,idPlaying:w,width:R,height:T,isMinimize:S=!0,currentTime:z,thumb_url:F,allowOpenPreview:$,isDialog:B=!1}=e||{},{dialogBackend:W,useMediaPlaying:j,useSession:L,useIsMobile:D,assetUrl:U,useDialog:N}=(0,r.PCX)(),{dialogProps:H}=N(),V=D(),X=o.useRef(!1),{user:Q}=L(),q=o.useMemo(()=>w||u()("video"),[w]),J=(0,p.h)(T,R),G=(0,h.AE)(F,"500",U("video.no_image")),[Z,K]=j(q),[Y,ee]=o.useState(!1),[et,en]=o.useState(!1),[er,ei]=(0,d.Wx)({threshold:.5}),[el,ea]=o.useState(!0),eo=o.useRef(null),es=o.useRef(null),ed=o.useRef(null),[ec,eu]=o.useState({muted:null===(s=null==I?void 0:I.muted)||void 0===s||s,volume:null!==(c=null==I?void 0:I.volume)&&void 0!==c?c:1,played:0,seeking:!1,buffer:!0,loadedSeconds:0}),em=o.useRef(!1),ep=(0,r.zy2)();o.useLayoutEffect(()=>{f&&ea(!0)},[f]),o.useEffect(()=>{eu(e=>({...e,...I}))},[Z]),o.useEffect(()=>{if(P[v]||z){var e;null===(e=eo.current)||void 0===e||e.seekTo(P[v]||z,"fraction")}},[null==ep?void 0:ep.pathname,z]),o.useEffect(()=>()=>{P[v]=void 0,K(!1)},[]);let{muted:eg,volume:eh,played:ev,buffer:ef,loadedSeconds:ey,seeking:eb}=ec||{};o.useEffect(()=>{P[v]=ev},[ev]);let eA=null===(t=eo.current)||void 0===t?void 0:t.getDuration(),ex=eo.current?null===(n=eo.current)||void 0===n?void 0:n.getCurrentTime():0,ew=eo.current?eA:0,eE=null==Q?void 0:null===(l=Q.video_settings)||void 0===l?void 0:l.user_auto_play_videos,ek=eE&&y,eO=e=>{!Y&&(ee(!0),ek||!f||Z||K(!0))},e_=o.useCallback(e=>{K(!0)},[K]),eC=o.useCallback(e=>{K(!1)},[K]);(0,o.useEffect)(()=>{ek&&K(ei)},[ei]);let eM=(0,p.f)(ex),eP=(0,p.f)(ew),eI=e=>{$&&(e.stopPropagation(),ea(!1),K(!0))};(0,o.useEffect)(()=>{B&&(ea(!1),K(!0))},[B]);let eR=(e,t=!1)=>{if(e.stopPropagation(),1===ev){var n,r,i,l;null===(n=eo.current)||void 0===n||n.seekTo(0),(null===(r=eo.current)||void 0===r?void 0:r.getInternalPlayer())&&(null===(l=null===(i=eo.current)||void 0===i?void 0:i.getInternalPlayer())||void 0===l||l.play());return}if(Z&&!H.open&&!t){W.present({component:"chatplus.dialog.VideoPlayer",props:{src:v,currentTime:ev,thumbUrl:G}});return}K(!Z)},eT=e=>{var t;_>3e3?eU():(null===(t=es.current)||void 0===t?void 0:t.visible)&&(_+=200),eb||eu({...ec,...e})},eS=(e,t)=>{var n;let r=C(t);eu({...ec,played:r}),null===(n=eo.current)||void 0===n||n.seekTo(r,"fraction")},ez=(e,t)=>{var n;em.current&&(K(!0),em.current=!1);let r=C(t);eu({...ec,seeking:!1}),null===(n=eo.current)||void 0===n||n.seekTo(r,"fraction")},eF=e=>{Z&&(em.current=!0),eu({...ec,seeking:!0})},e$=(e,t)=>{e.stopPropagation();let n={muted:0===Number(t),volume:t};I=n,eu(e=>({...e,...n}))},eB=e=>{e.stopPropagation();let t={muted:!ec.muted,volume:0===ec.volume&&ec.muted?1:ec.volume};I=t,eu(e=>({...e,...t}))},eW=()=>{eD(),X.current=!1},ej=e=>{eu({...ec,buffer:!0})},eL=e=>{eu({...ec,buffer:!1})},eD=o.useCallback(()=>{es.current&&(es.current.setVisible(!0),_=0)},[]),eU=()=>{1!==ec.played&&Z&&!et&&es.current&&es.current.setVisible(!1)},eN=()=>{var e,t,n,r,i;if(es.current&&ed.current){if(V){let l=null===(e=ed.current)||void 0===e?void 0:e.querySelector("video");if(!l)return;if(l.webkitSupportsFullscreen){l.webkitEnterFullscreen();return}l.requestFullscreen();return}document.fullscreenElement?document.exitFullscreen():(null===(t=ed.current)||void 0===t?void 0:t.requestFullscreen)?null===(r=ed.current)||void 0===r||r.requestFullscreen():(null===(n=ed.current)||void 0===n?void 0:n.webkitRequestFullscreen)&&(null===(i=ed.current)||void 0===i||i.webkitRequestFullscreen())}},[eH,eV]=o.useState(!1);return o.useEffect(()=>{let e=()=>{document.fullscreenElement?eV(!0):eV(!1)};return document.addEventListener("fullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e)}},[]),o.createElement(o.Fragment,null,o.createElement(a.A,{display:el&&F?"inherit":"none !important"},o.createElement(b,{width:`${R}px !important`},o.createElement(A,{ratioPercent:J},o.createElement(E,{onClick:eI},o.createElement(O,{src:G,aspectRatio:"fixed"})),o.createElement(k,{icon:"ico-play-circle-o"})))),o.createElement(b,{display:el&&F?"none !important":"inherit",ref:er,onMouseLeave:eU,onMouseMove:eD},o.createElement(A,{ref:ed},o.createElement(x,{onClick:eR},ef&&Z?o.createElement(g.A,{size:S?26:50}):null,o.createElement(M,{ref:eo,onEnded:eW,onPause:eC,onPlay:e_,onClickPreview:e_,progressInterval:200,url:v,controls:!1,config:{...V&&{file:{attributes:{controlsList:"nofullscreen",disablePictureInPicture:"",playsInline:!0}}}},onReady:eO,className:"player",width:R,height:T,playing:Z&&!em.current,volume:eh,muted:eg,playIcon:o.createElement(i.s4,{icon:"ico-play-circle-o"}),onProgress:eT,onBuffer:ej,onBufferEnd:eL})),Y?o.createElement(m.A,{controlRef:es,onPlayPause:e=>eR(e,!0),playing:Z,played:ev,loaded:ey/eA,buffer:ef,onSeek:eS,onSeekMouseUp:ez,onMouseSeekDown:eF,volume:eg?0:eh,onVolumeChangeHandler:e$,mute:eg,onMute:eB,duration:ew,formatDuration:eP,currentTime:eM,onFullScreen:eN,showFullScreen:eH,setIsEditControl:en,isMinimize:S}):null)))}},22220(e,t,n){n.d(t,{A:()=>l,h:()=>a});var r=n(71468),i=n(16677);function l(){return(0,r.d4)(e=>(0,i.F6)(e))}function a(){var e;let t=(0,r.d4)(e=>(0,i.M7)(e));return Object.values(t)?null===(e=Object.values(t))||void 0===e?void 0:e.slice(0,4):[]}}}]);