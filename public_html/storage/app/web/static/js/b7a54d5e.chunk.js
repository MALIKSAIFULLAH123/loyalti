"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-photo-components-UploadMultiPhoto-UploadMultiAlbumPhotoField"],{59262(e,t,r){r.d(t,{A:()=>l});var i=r(96540),n=r(23805),o=r.n(n);let a=e=>e?o()(e)?a(Object.values(e)[0]):e.toString():null;function l({error:e,className:t="invalid-feedback order-last"}){return e?i.createElement("div",{"data-testid":"error",className:t},a(e)):null}},21505(e,t,r){r.d(t,{A:()=>R});var i=r(91557),n=r(40515),o=r(67725),a=r(3556),l=r(8051),s=r(20053),d=r(96540),u=r(85838),c=r(56525);let g=e=>(0,u.A)({isDragging:{},itemRoot:{width:"100%",backgroundColor:e.mixins.backgroundColor("paper"),borderRadius:e.shape.borderRadius,boxShadow:e.shadows[2],"&$isDragging":{width:"100%",border:"dashed 2px",borderColor:e.palette.primary.main}},itemMediaBackdrop:{backgroundColor:e.mixins.backgroundColor("paper"),textAlign:"center",overflow:"hidden",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",paddingBottom:"56%",borderRadius:e.shape.borderRadius},ratioauto:{},ratio169:{paddingBottom:"56.25%"},ratio916:{paddingBottom:"177.77%"},ratio32:{paddingBottom:"66.66%"},ratio23:{paddingBottom:"150%"},ratio43:{paddingBottom:"75%"},ratio34:{paddingBottom:"133.33%"},ratio13:{paddingBottom:"31%"},ratio11:{paddingBottom:"100%"},itemMedia:{position:"absolute",left:0,top:0,width:"100%",height:"100%",borderRadius:e.shape.borderRadius}}),h=(0,c.A)(g);var p=r(58935),m=r(5079),v=r(58410);let f={PHOTO:"photo"};function b({id:e,index:t,item:r,movePhoto:i,allowDnD:n=!1,children:o}){let a=h(),l=d.useRef(null);if(!r)return;if(!n||!i)return o;let[,u]=(0,m.H)({accept:f.PHOTO,drop(e,r){if(!l.current)return;let n=e.index;n!==t&&(i(n,t),e.index=t)}}),[c,g]=(0,v.i)({type:f.PHOTO,item:{type:f.PHOTO,id:e,index:t},collect:e=>({isDragging:e.isDragging()})}),p=c.isDragging?.5:.9999,b=c.isDragging?"isDragging":"";return g(u(l)),d.createElement("div",{"data-uid":r.uid,style:{cursor:"move",opacity:p},ref:l,className:(0,s.default)(a.itemRoot,b?a.isDragging:"")},o)}var S=r(62193),w=r.n(S),D=r(44383),C=r.n(D),P=r(76096);function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}let I=(0,a.Ay)(l.A,{name:"MultipleUploadField",slot:"ActionsWrapper"})(({theme:e})=>({position:"absolute",top:e.spacing(1),right:e.spacing(1)})),O=(0,a.Ay)(l.A,{name:"MultipleUploadField",slot:"OtherActionsWrapper"})(({theme:e})=>({position:"absolute",top:e.spacing(1),left:e.spacing(1)})),M=(0,a.Ay)(n.Bj,{name:"MultipleUploadField",slot:"ActionButton"})(({theme:e})=>({fontSize:"14px",background:"rgba(0,0,0,0.4) !important",color:e.palette.common.white,"&:hover":{background:"rgba(0,0,0,0.4) !important",color:e.palette.common.white}})),E=(0,a.Ay)("div",{name:"MultipleUploadField",slot:"PreviewVideoWrapper"})(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"center",height:"100%"})),x=(0,a.Ay)("div",{name:"MultipleUploadField",slot:"MaskPlay"})(({theme:e})=>({position:"absolute",width:e.spacing(5),height:e.spacing(5),color:"#fff",backgroundColor:"rgba(0,0,0,0.4)",borderRadius:"50%",left:"50%",top:"50%",marginLeft:e.spacing(-2.5),marginTop:e.spacing(-2.5),display:"flex",alignItems:"center",justifyContent:"center",fontSize:e.mixins.pxToRem(24)})),A=(0,a.Ay)("video",{name:"MultipleUploadField",slot:"PreviewVideo"})({position:"absolute",left:0,top:0,right:0,bottom:0,backgroundRepeat:"no-repeat",backgroundPosition:"center",maxWidth:"100%"}),k=(0,a.Ay)(l.A,{name:"MultipleUploadField",slot:"ItemMediaContainer"})({position:"relative",textAlign:"center"});function R(e){var t;let r=h(),{i18n:a,dialogBackend:u}=(0,i.PCX)(),{item:c,removeItem:g,aspectRatio:m,editItem:v,id:f,allowRemove:S=!0,allowEdit:D=!1,mappingEditPhotoFields:R=[],editPhotoAction:_}=e,T=(0,o.EL)(null==c?void 0:null===(t=c.file)||void 0===t?void 0:t.type)||(null==c?void 0:c.module_name)==="video",z=!o.un&&T&&!(null==c?void 0:c.image),U=(0,i.EkY)(T?"video":P.Zt,T?"video":P.i3,T?"edit_selecting_video":"edit_selecting_photo"),F=(0,i.IgF)(null==_?void 0:_.module_name,null==_?void 0:_.resource_name,null==_?void 0:_.action_name)||{};if(!c)return;let{extra:B}=c,{can_delete:H,can_edit:j}=B||{can_edit:!0,can_delete:!0},N=null!=c&&!!c.uid||H&&S,V=(null==c?void 0:c.uid)?D:j&&D,W=async()=>{if(!V||!F&&!U)return;let e=C()(c,R),t=await u.present({component:"photo.dialog.quickEditPhotoFieldItem",props:{formSchema:w()(F)?U:void 0,dataSource:{...F,apiUrl:(0,o.vi)(F.apiUrl,c)},initialValues:{...e,...null==c?void 0:c.extra_info}}});t&&v(f,{extra_info:t})};return d.createElement(b,y({},e),d.createElement(k,null,d.createElement(l.A,{sx:{position:"relative"},className:(0,s.default)(r.itemMediaBackdrop,r[`ratio${m}`])},T?d.createElement(E,null,z?d.createElement(A,{src:(null==c?void 0:c.source)||(null==c?void 0:c.destination),controls:!1}):d.createElement(p.A,{item:c}),d.createElement(x,null,d.createElement(n.s4,{icon:"ico-play"}))):d.createElement(p.A,{item:c}),d.createElement(O,null,V&&(U||F)?d.createElement(M,{size:"small",onClick:W,color:"primary",icon:"ico-pencil",title:a.formatMessage({id:"edit"})}):null),d.createElement(I,null,N?d.createElement(M,{size:"small",onClick:g,color:"primary",icon:"ico-close",title:a.formatMessage({id:"remove"})}):null))))}},58935(e,t,r){r.d(t,{A:()=>s});var i=r(67725),n=r(3556),o=r(96540);let a=(0,n.Ay)("div",{name:"MultipleUploadField",slot:"PreviewImg",shouldForwardProp:e=>"radio"!==e})(({theme:e,radio:t})=>({position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:e.palette.grey.A700,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"auto 100%",maxWidth:"100%",...t&&"horizontal"===t&&{backgroundSize:"cover"}})),l=({item:e})=>{let[t,r]=o.useState({}),n=(e,t)=>{try{let r=new Image;r.src=t,r.onload=()=>{e({height:r.height,width:r.width})},r.onerror=e=>{}}catch(i){}},l=(null==e?void 0:e.source)||e.image_url||(0,i.AE)(null==e?void 0:e.image,"1024");o.useEffect(()=>{n(r,l)},[]);let s="horizontal";return s=t&&t.width/t.height<=1?"vertical":"horizontal",o.createElement(a,{radio:s,style:{backgroundImage:`url(${l})`}})},s=l},80395(e,t,r){r.r(t),r.d(t,{default:()=>M});var i=r(59262),n=r(91557),o=r(40515),a=r(60780),l=r(20687),s=r(87773),d=r(77299),u=r(8051),c=r(3556),g=r(30261),h=r(84058),p=r.n(h),m=r(62193),v=r.n(m),f=r(2404),b=r.n(f),S=r(96540),w=r(65639),D=r(21505),C=r(16535);let P=(0,c.Ay)("div",{name:"MultipleUploadField",slot:"Control",shouldForwardProp:e=>"haveError"!==e})(({theme:e,haveError:t})=>({height:120,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",border:e.mixins.border("secondary"),borderColor:"light"===e.palette.mode?"#0000003b":"rgba(255, 255, 255, 0.23)","& .ico-photos-plus-o":{fontSize:`${e.mixins.pxToRem(15)} !important`},"&:hover":{borderColor:"light"===e.palette.mode?"#000":"#fff"},"& button":{[e.breakpoints.down("sm")]:{flexDirection:"column",height:"auto",maxWidth:"calc(100% - 40px)",padding:"10px"}},...t&&{borderColor:`${e.palette.error.main} !important`}})),y=(0,c.Ay)(a.A,{name:"DropButton",slot:"DropButton"})(({theme:e,isOver:t})=>({...t&&{backgroundColor:e.palette.action.hover}})),I=(0,c.Ay)("div",{name:"MultipleUploadField",slot:"AddMoreBtnWrapper"})(({theme:e,disabled:t})=>({display:"flex",alignItems:"center",justifyContent:"center",borderColor:t?e.palette.text.disabled:e.palette.primary.main,borderStyle:"solid",borderWidth:1,borderRadius:e.shape.borderRadius,height:"100%"})),O=(0,c.Ay)("span",{name:"LabelButton",slot:"LabelButton"})(({theme:e})=>({fontSize:e.mixins.pxToRem(15)}));function M({name:e,formik:t,config:r,disabled:a}){var c,h;let{upload_url:m,max_upload_filesize:f,description:M,allowRemoveItems:E=!0,allowAddItems:x=!0,aspectRatio:A="169",allowDrop:k=!1,allowEditPhoto:R=!1,mappingEditPhotoFields:_=[]}=r,{i18n:T,dialogBackend:z,jsxBackend:U,usePageParams:F}=(0,n.PCX)(),[,,{setValue:B}]=(0,g.Mt)("fileItemType"),[H,j,{setValue:N,setTouched:V}]=(0,g.Mt)(null!=e?e:"ItemPhotoField"),W=(0,n.alo)(),[L,$]=S.useState({}),{add_photo:X}=F(),Y=(e,t)=>{let r=Math.round(100*e.loaded/e.total);$(e=>({...e,[t]:r}))},[q,Z,G]=(0,w.A)({initialValues:H.value||[],upload_url:m,maxSizeLimit:f}),J=r.placeholder||"add_photo",K=e=>Z(t=>t.filter(t=>t.uid!==e)),Q=e=>{Z(t=>t.map(t=>(null==t?void 0:t.id)===e?{...t,status:"remove"}:t))},ee=e=>{if(!t.isSubmitting)return(null==e?void 0:e.uid)?K(null==e?void 0:e.uid):Q(null==e?void 0:e.id)};S.useEffect(()=>{X&&er()},[]),S.useEffect(()=>{if(b()(q,H.value))return;v()(q)&&B(void 0),j.touched||V(!0);let e=q.map((e,t)=>({...e,onUploadProgress:t=>Y(t,(null==e?void 0:e.id)||(null==e?void 0:e.uid))}));N(e)},[q]);let et=e=>{e.length&&G(e,H.value)},er=(0,S.useCallback)(()=>{z.present({component:"photo.dialog.ChooseAlbumItemDialog",props:{config:r,fileItems:q,setFileItems:Z,formik:t}})},[q]),ei=S.useCallback((e,t)=>{Z(r=>{let i=[...r];return i.splice(t,0,i.splice(e,1)[0]),[...i=null==i?void 0:i.map((e,t)=>({status:"update",...e,ordering:t+1}))]})},[Z]),en=S.useCallback((e,t)=>{Z(r=>{let i=(0,C.jM)(r,r=>{let i=r.find(t=>(null==t?void 0:t.uid)===e||(null==t?void 0:t.id)===e);i&&((null==i?void 0:i.status)||(i.status="update"),Object.assign(i,t))});return i})},[Z]),eo=Boolean(j.error&&(j.touched||t.submitCount)),ea=null==H?void 0:null===(c=H.value)||void 0===c?void 0:c.filter(e=>(null==e?void 0:e.status)!=="remove");return x||(null===(h=H.value)||void 0===h?void 0:h.length)?S.createElement(S.Fragment,null,S.createElement(l.A,{error:eo,fullWidth:!0,margin:"normal"},S.createElement(s.A,{sx:{fontSize:"13px"},color:"text.hint",mb:1},r.label),(null==ea?void 0:ea.length)?null:S.createElement(o.dl,{onDrop:e=>et(e),render:({canDrop:t,isOver:r})=>S.createElement(P,{haveError:eo,role:"button",onClick:er},S.createElement(y,{size:"small",color:"primary",isOver:r,variant:"outlined","data-testid":p()(`field ${e}`),startIcon:S.createElement(o.s4,{icon:"ico-photos-plus-o"})},T.formatMessage({id:J})))})),S.createElement(d.Ay,{container:!0,columnSpacing:1,rowSpacing:1},ea.length&&x?S.createElement(d.Ay,{item:!0,sm:6,md:4,xs:6},S.createElement(o.dl,{style:{height:"100%"},onDrop:e=>et(e),render:({canDrop:e,isOver:i})=>S.createElement(I,{disabled:t.isSubmitting},S.createElement(y,{size:"large",color:"primary",isOver:i,startIcon:S.createElement(o.s4,{icon:"ico-photos-plus-o"}),sx:{fontWeight:"bold",pl:{xs:2.5,md:0},pr:0},onClick:er,disabled:t.isSubmitting},W?null:S.createElement(S.Fragment,null," ",S.createElement(O,null,null==r?void 0:r.label)," ")))})):null,null==ea?void 0:ea.map((e,r)=>{let i=(null==e?void 0:e.uid)||(null==e?void 0:e.id);return S.createElement(d.Ay,{item:!0,key:r,sm:6,md:4,xs:6},S.createElement(u.A,{sx:{position:"relative"}},S.createElement(D.A,{aspectRatio:A,index:r,id:i,movePhoto:ei,item:e,allowDnD:k,allowRemove:E,allowEdit:R,removeItem:()=>ee(e),editItem:en,mappingEditPhotoFields:_}),U.render({component:"photo.progress.loading",props:{value:L[i]||0,uploading:t.isSubmitting}})))})),M?S.createElement(s.A,{sx:{fontSize:"13px"},color:"text.hint",mt:1},M):null,eo?S.createElement(i.A,{error:j.error}):null):null}},65639(e,t,r){r.d(t,{A:()=>u});var i=r(91557),n=r(96540),o=r(62193),a=r.n(o),l=r(97200),s=r.n(l),d=r(67725);function u({initialValues:e,upload_url:t="",maxSizeLimit:r,isAcceptVideo:o=!0,messageAcceptFail:l,accept:u,inputRef:c,storage_id:g}){var h,p,m,v;let{dialogBackend:f,i18n:b}=(0,i.PCX)(),[S,w]=n.useState(e||[]),D=null!==(p=null!==(h=null==r?void 0:r.photo)&&void 0!==h?h:null==r?void 0:r.other)&&void 0!==p?p:0,C=null!==(v=null!==(m=null==r?void 0:r.video)&&void 0!==m?m:null==r?void 0:r.other)&&void 0!==v?v:0,P=(e,r)=>{let i=[];if(a()(e))return;let n=[];for(let h=0;h<e.length;++h){let p=e[h],m=p.size,v=(0,d.EL)(null==p?void 0:p.type)?C:D,S=(0,d.ti)(p),P={id:0,uid:s()(),source:URL.createObjectURL(p),file_name:p.name,file_size:p.size,file_type:p.type,file:p,upload_url:t,storage_id:g,type:S.match("image/*")?"photo":"video",status:"new"};if("video"===P.type&&!o||!(0,d.HH)((0,d.ti)(p),u)){f.alert({message:l||b.formatMessage({id:"file_accept_type_fail"})}),(null==c?void 0:c.current)&&(c.current.value=null);break}m>v&&0!==v?(P.max_size=v,n.push(P)):i.push(P)}if(i.length&&w(e=>[...r||e,...i]),n.length>0){var y;f.alert({message:1===n.length?b.formatMessage({id:"warning_upload_limit_one_file"},{fileName:(0,d.Tu)(n[0].file_name,30),fileSize:(0,d.lT)(n[0].file_size),maxSize:(0,d.lT)(null===(y=n[0])||void 0===y?void 0:y.max_size)}):b.formatMessage({id:"warning_upload_limit_multi_file"},{numberFile:n.length,photoMaxSize:(0,d.lT)(D),videoMaxSize:(0,d.lT)(C)})})}};return[S,w,P]}},58410(e,t,r){r.d(t,{i:()=>b});var i=r(79396),n=r(8576),o=r(27739),a=r(96540),l=r(31670),s=r(58853),d=r(71643);class u{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){let e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){let e=this.dragSource,t=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return(t&&this.disconnectDragSource(),this.handlerId)?e?(t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)),t):(this.lastConnectedDragSource=e,t):t}reconnectDragPreview(e=!1){let t=this.dragPreview,r=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(r&&this.disconnectDragPreview(),this.handlerId){if(!t){this.lastConnectedDragPreview=t;return}r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=t,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,t,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!(0,l.b)(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!(0,l.b)(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=(0,d.i)({dragSource:(e,t)=>{this.clearDragSource(),this.dragSourceOptions=t||null,(0,s.i)(e)?this.dragSourceRef=e:this.dragSourceNode=e,this.reconnectDragSource()},dragPreview:(e,t)=>{this.clearDragPreview(),this.dragPreviewOptions=t||null,(0,s.i)(e)?this.dragPreviewRef=e:this.dragPreviewNode=e,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}var c=r(56143),g=r(27727);let h=!1,p=!1;class m{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){(0,i.V)(!h,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return h=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{h=!1}}isDragging(){if(!this.sourceId)return!1;(0,i.V)(!p,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return p=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{p=!1}}subscribeToStateChange(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,t){return this.internalMonitor.isOverTarget(e,t)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}}var v=r(85711);class f{beginDrag(){let e=this.spec,t=this.monitor,r=null;return null!=(r="object"==typeof e.item?e.item:"function"==typeof e.item?e.item(t):{})?r:null}canDrag(){let e=this.spec,t=this.monitor;return"boolean"==typeof e.canDrag?e.canDrag:"function"!=typeof e.canDrag||e.canDrag(t)}isDragging(e,t){let r=this.spec,i=this.monitor,{isDragging:n}=r;return n?n(i):t===e.getSourceId()}endDrag(){let e=this.spec,t=this.monitor,r=this.connector,{end:i}=e;i&&i(t.getItem(),t),r.reconnect()}constructor(e,t,r){this.spec=e,this.monitor=t,this.connector=r}}function b(e,t){let r=(0,o.I)(e,t);(0,i.V)(!r.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");let l=function(){let e=(0,c.u)();return(0,a.useMemo)(()=>new m(e),[e])}(),s=function(e,t){let r=(0,c.u)(),i=(0,a.useMemo)(()=>new u(r.getBackend()),[r]);return(0,g.E)(()=>(i.dragSourceOptions=e||null,i.reconnect(),()=>i.disconnectDragSource()),[i,e]),(0,g.E)(()=>(i.dragPreviewOptions=t||null,i.reconnect(),()=>i.disconnectDragPreview()),[i,t]),i}(r.options,r.previewOptions);return!function(e,t,r){let n=(0,c.u)(),o=function(e,t,r){let i=(0,a.useMemo)(()=>new f(e,t,r),[t,r]);return(0,a.useEffect)(()=>{i.spec=e},[e]),i}(e,t,r),l=(0,a.useMemo)(()=>{let t=e.type;return(0,i.V)(null!=t,"spec.type must be defined"),t},[e]);(0,g.E)(function(){if(null!=l){let[e,i]=(0,v.V)(l,o,n);return t.receiveHandlerId(e),r.receiveHandlerId(e),i}},[n,t,r,o,l])}(r,l,s),[(0,n.j)(r.collect,l,s),(0,a.useMemo)(()=>s.hooks.dragSource(),[s]),(0,a.useMemo)(()=>s.hooks.dragPreview(),[s])]}}}]);