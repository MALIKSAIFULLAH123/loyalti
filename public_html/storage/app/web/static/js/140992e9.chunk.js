(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-photo-components-PhotoViewDetail-index"],{24713(e,t,o){var i=o(2523),l=o(15389),n=o(61489),a=Math.max;e.exports=function(e,t,o){var r=null==e?0:e.length;if(!r)return -1;var d=null==o?0:n(o);return d<0&&(d=a(r+d,0)),i(e,l(t,3),d)}},28079(e,t,o){"use strict";o.r(t),o.d(t,{default:()=>v});var i=o(91557),l=o(76096),n=o(3556),a=o(8051),r=o(96540);let d="PhotoViewContainer",s=(0,n.Ay)(a.A,{name:d,slot:"root"})(({theme:e})=>({width:"100%",height:"100%",padding:"0 !important",paddingTop:"0 !important",display:"flex",overflowY:"visible",background:e.palette.background.paper,outline:"none !important",[e.breakpoints.down("md")]:{height:"auto",flexFlow:"column",flexDirection:"column","& > div":{overflow:"inherit"}}})),p=(0,n.Ay)("div",{name:d,slot:"dialogStatistic",shouldForwardProp:e=>"isExpand"!==e})(({theme:e,isExpand:t})=>({display:t?"none":"block",height:"100%",width:"480px",[e.breakpoints.down("md")]:{width:"35%"},[e.breakpoints.down("sm")]:{width:"45%"},[e.breakpoints.down("xs")]:{width:"100%",height:"420px"}}));var u=o(78770);let v=(0,u.A)(function({item:e,identity:t,nextUrl:o,prevUrl:n,mediaType:a,loading:d,sx:u,shouldPreload:v,fromResource:h,fromResourceId:m}){var c;let{jsxBackend:f,dispatch:w,navigate:x}=(0,i.PCX)(),g=(0,i.zy2)(),[k,y]=r.useState(!1),$=f.get("photo.view.sideBlock"),b=f.get("media.ui.viewSet");r.useEffect(()=>{v&&w({type:`photo/${h}/LOAD`,payload:{identity:t,direction:v,[h]:m}})},[v]);let E=e=>{w({type:l.kx,payload:{identity:t,data:e}})},A=e=>{w({type:l.R9,payload:{identity:t,id:e}})},C=e=>{y(e)},P=r.useCallback(e=>{var t;x({pathname:e},{replace:!0,state:{asModal:null==g?void 0:null===(t=g.state)||void 0===t?void 0:t.asModal}})},[x,null==g?void 0:null===(c=g.state)||void 0===c?void 0:c.asModal]);return(r.useEffect(()=>{let e=e=>{39===e.keyCode&&o?P(o):37===e.keyCode&&n&&P(n)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[o,n]),e)?r.createElement(s,{sx:u},r.createElement(b,{mediaType:a,identity:t,onAddPhotoTag:E,onRemovePhotoTag:A,onMinimizePhoto:C,onArrowClick:P,nextUrl:o,prevUrl:n,sx:{flex:1,minWidth:0}}),r.createElement(p,{isExpand:k},$?r.createElement($,{loading:d,identity:t}):null)):null})},78770(e,t,o){"use strict";o.d(t,{A:()=>v});var i=o(91557),l=o(24713),n=o.n(l),a=o(58156),r=o.n(a),d=o(76096);let s=(e,t)=>e?[d.hO,e]:t?[d.HN,t]:[],p=(e,t,o=3)=>t<o?"prev":t>e-o-1?"next":"",u=(e,{photo_set:t,photo_album:o,identity:i,photo_id:l,media_type:a})=>{let d=r()(e,i);if(!d)return{};let[u,v]=s(o,t),h=r()(e,`photo.entities.${u}.${v}.photos`)||[],m=h.filter(t=>{let o=r()(e,t);if(!o.error)return t}),c=(null==d?void 0:d.user)?r()(e,d.user):void 0,f=null==m?void 0:m.length,w=1<f?n()(m,e=>e===i):-1,x=d.user_tags?d.user_tags.map(t=>r()(e,t)).filter(Boolean):[],g={item:d,photos:m,user:c,photo_id:l,user_tags:x,mediaType:a,nextUrl:void 0,prevUrl:void 0,shouldPreload:p(f,w),fromResource:u,fromResourceId:v};if(-1<w){var k,y;let $="/photo";if(t&&($=`/media/${t}`),o&&($=`/media/album/${o}`),w<f-1){let b=m[w+1],E=b.split(".")[2],A=null===(k=r()(e,b))||void 0===k?void 0:k.slug;g.nextUrl=`${$}/${E}/${b.replace(`${E}.entities.${E}.`,"")}${A?`/${A}`:""}`}if(0<w){let C=m[w-1],P=null===(y=r()(e,C))||void 0===y?void 0:y.slug,U=C.split(".")[2];g.prevUrl=`${$}/${U}/${C.replace(`${U}.entities.${U}.`,"")}${P?`/${P}`:""}`}}return g},v=(0,i.NgA)(u)}}]);